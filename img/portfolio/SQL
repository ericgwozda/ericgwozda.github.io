--Inserting data into a table
INSERT INTO database.table  (column1, column2, column3….)
VALUES (325025, 'Jack Foster', '123 Any St', 'New York', 'NY', 10001, 'US')


--Adding columns into table
ALTER TABLE database.table  
Add newcolumnname Nvarchar(255); 	  -- add new column name, and specify data type


--Updating blank column/Changing column with data
UPDATE database.table  
SET columnname = SUBSTRING(PropertyAddress, 1, CHARINDEX(',', PropertyAddress) -1 )


-- Standardize Date Format

ALTER TABLE [Portfolio Project]..NashvilleHousing
Add SaleDateConverted Date;

Update [Portfolio Project]..NashvilleHousing
SET SaleDateConverted = CONVERT(Date,SaleDate)


-- To split up the property address into 2 fields (address, city)

SELECT SUBSTRING(PropertyAddress, 1, CHARINDEX(',', PropertyAddress) -1 ) as Address,              -- substring starting at position 1, up to the position just before the comma 
SUBSTRING(PropertyAddress, CHARINDEX(',', PropertyAddress) + 2, LEN(PropertyAddress)) as City      -- substring starting at the position comma +2 (to exclude comma and space) until the whole length of city 
FROM [Portfolio Project].dbo.NashvilleHousing

-- Create 2 new fields/columns to store split address

ALTER TABLE [Portfolio Project]..NashvilleHousing
Add PropertySplitAddress Nvarchar(255);

ALTER TABLE [Portfolio Project]..NashvilleHousing
Add PropertySplitCity Nvarchar(255);


-- Update the new fields with the new split addresses

Update [Portfolio Project]..NashvilleHousing
SET PropertySplitAddress = SUBSTRING(PropertyAddress, 1, CHARINDEX(',', PropertyAddress) -1 )

Update [Portfolio Project]..NashvilleHousing
SET PropertySplitCity = SUBSTRING(PropertyAddress, CHARINDEX(',', PropertyAddress) + 2 , LEN(PropertyAddress))


-- Another way to split the address field

Select												-- this parses the field (must be separated by periods), so replace commas with periods inside the parse
PARSENAME(REPLACE(OwnerAddress, ',', '.') , 3)
,PARSENAME(REPLACE(OwnerAddress, ',', '.') , 2)
,PARSENAME(REPLACE(OwnerAddress, ',', '.') , 1)
From [Portfolio Project]..NashvilleHousing


ALTER TABLE [Portfolio Project]..NashvilleHousing			-- adds 3 new fields to add the split owner address
Add OwnerSplitAddress Nvarchar(255);

ALTER TABLE [Portfolio Project]..NashvilleHousing
Add OwnerSplitCity Nvarchar(255);

ALTER TABLE [Portfolio Project]..NashvilleHousing
Add OwnerSplitState Nvarchar(255);



Update [Portfolio Project]..NashvilleHousing								-- this updates the new added fields with the split address
SET OwnerSplitAddress = PARSENAME(REPLACE(OwnerAddress, ',', '.') , 3)

Update [Portfolio Project]..NashvilleHousing
SET OwnerSplitCity = PARSENAME(REPLACE(OwnerAddress, ',', '.') , 2)

Update [Portfolio Project]..NashvilleHousing
SET OwnerSplitState = PARSENAME(REPLACE(OwnerAddress, ',', '.') , 1)



-- Change Y and N to Yes and No in "Sold as Vacant" field


Select Distinct(SoldAsVacant), Count(SoldAsVacant)			-- counts the unique values in this field 
From [Portfolio Project]..NashvilleHousing
Group by SoldAsVacant
order by 2


Select SoldAsVacant									-- shows what would happen if i change the "Y" to "Yes" and "N" to "No"
, CASE When SoldAsVacant = 'Y' THEN 'Yes'
	   When SoldAsVacant = 'N' THEN 'No'
	   ELSE SoldAsVacant
	   END
From [Portfolio Project]..NashvilleHousing


Update [Portfolio Project]..NashvilleHousing		-- changes the "Y" to "Yes" and "N" to "No"
SET SoldAsVacant = CASE When SoldAsVacant = 'Y' THEN 'Yes'
	   When SoldAsVacant = 'N' THEN 'No'
	   ELSE SoldAsVacant
	   END


-- Remove Duplicates (***probably better to create a temp table to store deleted values in case you delete by mistake***)

WITH RowNumCTE AS(
Select *,
	ROW_NUMBER() OVER (
	PARTITION BY ParcelID,				-- all fields that are the same to make it a duplicate, the row_num column shows the number of the duplicate (i.e. 2=1st duplicate, 3=2nd duplicate...)
				 PropertyAddress,
				 SalePrice,
				 SaleDate,
				 LegalReference
				 ORDER BY
					UniqueID
					) row_num
From [Portfolio Project]..NashvilleHousing
)
Select *					-- verify there are dups
From RowNumCTE
Where row_num > 1
Order by PropertyAddress




WITH RowNumCTE AS(
Select *,
	ROW_NUMBER() OVER (
	PARTITION BY ParcelID,				-- all fields that are the same to make it a duplicate, the row_num column shows the number of the duplicate (i.e. 2=1st duplicate, 3=2nd duplicate...)
				 PropertyAddress,
				 SalePrice,
				 SaleDate,
				 LegalReference
				 ORDER BY
					UniqueID
					) row_num
From [Portfolio Project]..NashvilleHousing
)
DELETE					-- BE CAREFUL DELETING RAW DATAA FROM DB, MIGHT BE BETTER TO SAVE DATA IN TEMP TABLE
From RowNumCTE
Where row_num > 1
--Order by PropertyAddress



WITH RowNumCTE AS(
Select *,
	ROW_NUMBER() OVER (
	PARTITION BY ParcelID,				-- all fields that are the same to make it a duplicate, the row_num column shows the number of the duplicate (i.e. 2=1st duplicate, 3=2nd duplicate...)
				 PropertyAddress,
				 SalePrice,
				 SaleDate,
				 LegalReference
				 ORDER BY
					UniqueID
					) row_num
From [Portfolio Project]..NashvilleHousing
)
Select *					-- verify there are no more dups
From RowNumCTE
Where row_num > 1
Order by PropertyAddress



-- delete not needed columns

ALTER TABLE [Portfolio Project]..NashvilleHousing
DROP COLUMN OwnerAddress, TaxDistrict, PropertyAddress, SaleDate

Select *
From [Portfolio Project]..NashvilleHousing

TO FIND COLUMN IN ALL TABLES, EITHER KBS OR PRD SCHEMA
SELECT DISTINCT OWNER, table_name, column_name 
from sys.all_tab_cols 
where owner IN ('KBS','PRD') 
and (column_name like '%CALL_DATA%'
or table_name like '%CALL_DATA%')
ORDER BY 1,2,3 ASC 


FRN-SPECIFIC DATE
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, D.INST_TYPE_C, G.DATED_D, F.FORMULA_TEXT, B.ADJ_DT, TO_CHAR(A.COUPON_ORGL_P,'0.000') AS MB_ISSUE_CPN, TO_CHAR(B.ADJ_RATE,'0.000') AS FRN_SCHED_CPN, C.INDEX_TYPE, C.INDEX_SUB_TYPE, C.PERCENT_OF_INDEX, C.SPREAD_PLUSMINUS_I, TO_CHAR(C.SPREAD_INT_RATE,'0.000') AS SPREAD_PCT, C.SPREAD_BASIS_PTS, C.CUTOFF_FREQ_CD, C.CUTOFF_TIMEZONE_CD, E.FREQ_PERIOD_C AS FREQ, B.BEGIN_DT, B.END_DT, B.CALC_COUPON_I, B.UPDATED_COUPON_I, B.MODIFIED_BY_C, B.MODIFIED_Z
FROM KBS.TISSUE_REF A, KBS.TVARIABLE_SCHEDULE B, KBS.TINDEX_GROUPING C, KBS.TINST_REF D, KBS.TVARIABLE_FEATURE E, KBS.TINDEX_FORMULA F, KBS.TISSUING_REF G
WHERE (A.ISSUER_ID_C=B.ISSUER_ID_C AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C)
AND (A.ISSUER_ID_C=C.ISSUER_ID_C AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C)
AND D.INST_ID_C=A.INST_ID_C
AND (A.ISSUER_ID_C=E.ISSUER_ID_C AND A.ISSUE_ALPHA_C=E.ISSUE_ALPHA_C)
AND E.FORMULA_ID_C=F.FORMULA_ID_C
AND A.ISSUING_ID_C=G.ISSUING_ID_C
AND D.INST_TYPE_C = 'MUNI'
AND B.ADJ_DT =  TO_DATE('11/03/2017','MM/DD/YYYY')
AND C.INDEX_TYPE IN ('LIBR', 'SMSW')
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND A.CUSIP_DERVN_I = 'C'
AND NOT EXISTS (
SELECT DISTINCT ISSUER_ID_C, ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE 
WHERE ISSUER_ID_C=A.ISSUER_ID_C
AND ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND FULL_PART_CALL_C = 'FULL')
ORDER BY 5,1 ASC


ALL TABLES
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, A.OFFERING_ID_C, A.ISSUING_ID_C, F.*, G.*, J.*, K.*, L.*, M.*, P.*, Q.*, S.*, T.*, V.*, X.*, Y.*, Z.*, ZZ.*, 
FROM KBS.TISSUE_REF A, KBS.TISSUING_OTL B, KBS.TISSUING_REF C, KBS.TOFFERING_REF D, KBS.TINST_REF E, KBS.TCALLED_ISSUE F, KBS.TCALLED_BOND G, KBS.TFEATURE_XREF H, KBS.TDEFAULTS J, KBS.TDISTRIBUTIONS K, KBS.TINT_PAY_CYCLE L, KBS.TPREREFUNDED_REF M, KBS.TFEATURE_XREF N, KBS.TSPEC_REDEM P, KBS.TSPEC_SCHEDULE Q, KBS.TFEATURE_XREF R, KBS.TSINKING_FUND_REF S, KBS.TSINK_FUND_SCHED T, KBS.TCOMMENTS V, KBS.TFEATURE_XREF W, KBS.TCONVERTIBLE_REF X, KBS.TINDEX_GROUPING Y, CVN.TCALL_DETAIL Z, CVN.TCALL_SCHEDULE ZZ 
WHERE A.ISSUING_ID_C=C.ISSUING_ID_C
AND A.ISSUING_ID_C=B.ISSUING_ID_C (+)
AND A.OFFERING_ID_C=D.OFFERING_ID_C
AND A.INST_ID_C=E.INST_ID_C (+)
AND (A.ISSUER_ID_C=F.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=F.ISSUE_ALPHA_C (+))
AND F.FEATURE_ID_C=G.FEATURE_ID_C (+)
AND (A.ISSUER_ID_C=H.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=H.ISSUE_ALPHA_C (+))
AND H.FEATURE_ID_C=J.FEATURE_ID_C (+)
AND H.FEATURE_ID_C=K.DEFAU_FEATURE_ID_C (+)
AND A.ISSUING_ID_C=L.ISSUING_ID_C (+)
AND A.ISSUING_ID_C=M.ISSUING_ID_C (+)
AND (A.ISSUER_ID_C=N.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=N.ISSUE_ALPHA_C (+))
AND N.FEATURE_ID_C=P.FEATURE_ID_C (+)
AND P.FEATURE_ID_C=Q.FEATURE_ID_C (+)
AND (A.ISSUER_ID_C=R.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=R.ISSUE_ALPHA_C (+))
AND R.FEATURE_ID_C=S.FEATURE_ID_C (+)
AND S.FEATURE_ID_C=T.FEATURE_ID_C (+)
AND A.OFFERING_ID_C=V.OFFERING_ID_C (+)
AND (A.ISSUER_ID_C=W.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=W.ISSUE_ALPHA_C (+))
AND W.FEATURE_ID_C=X.FEATURE_ID_C (+)
AND (A.ISSUER_ID_C=Y.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=Y.ISSUE_ALPHA_C (+))
AND A.ISSUING_ID_C=Z.ISSUING_ID_C (+)
AND Z.ISSUING_ID_C=ZZ.ISSUING_ID_C (+)

AND ((A.issuer_id_c = '78010U' and A.issue_alpha_c = 'CT')
OR (A.issuer_id_c = '48126N' and A.issue_alpha_c = '5V')
OR (A.issuer_id_c = '003103' and A.issue_alpha_c = 'AB')
OR (A.issuer_id_c = '006302' and A.issue_alpha_c = 'EZ')
OR (A.issuer_id_c = '006302' and A.issue_alpha_c = 'FA')
OR (A.issuer_id_c = '009806' and A.issue_alpha_c = 'BW')
OR (A.issuer_id_c = '009806' and A.issue_alpha_c = 'BX')
OR (A.issuer_id_c = '009806' and A.issue_alpha_c = 'BY')
OR (A.issuer_id_c = '009806' and A.issue_alpha_c = 'BZ')





SPECIFIC TIMESTAMP DATE
TRUNC(ADDED_Z) = TO_DATE('01/01/2017','MM/DD/YYYY')

SPECIFIC INFO SOURCE
AND EXISTS (
SELECT DISTINCT OFFERING_ID_C 
FROM KBS.TINFO_SOURCE C 
WHERE C.OFFERING_ID_C=A.OFFERING_ID_C 
AND C.INFO_SOURCE_C= 'NIIDS'
)

CREDIT ENHANCEMENT
AND EXISTS (SELECT DISTINCT ISSUING_ID_C
FROM KBS.TCRDT_ENHMT_REF 
WHERE ISSUING_ID_C=A.ISSUING_ID_C
AND CRDT_ENHMT_TYPE_C = 'LOC')

DEFAULT
AND EXISTS (SELECT DISTINCT A.ISSUER_ID_C, A.ISSUE_ALPHA_C 
FROM KBS.TFEATURE_XREF X, KBS.TDEFAULTS Y
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND (X.ISSUER_ID_C=A.ISSUER_ID_C AND X.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C)
AND Y.DEFAULT_TYPE_C = 'DFLT'
AND Y.CURRENT_D IS NULL)

MB-ACTIVE (NON-MATURED & NO FULL CALL)
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND NOT EXISTS (SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X, KBS.TCALLED_BOND Y 
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND X.ISSUER_ID_C=A.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND Y.CALL_D < (SYSDATE))
AND NOT EXISTS
(SELECT 'PREF'
FROM KBS.TPREREFUNDED_REF
WHERE ISSUING_ID_C = A.ISSUING_ID_C
AND TRIM(PREF_TYPE_C) IN ('PREF', 'ETM')
AND PREF_D<SYSDATE
)

SDM-ACTIVE
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND NOT EXISTS (SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X 
WHERE X.ISSUER_ID_C=A.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND X.CALL_D < (SYSDATE))

OTL EXISTS
AND EXISTS (SELECT DISTINCT 'CALL' 
FROM KBS.TISSUING_OTL 
WHERE ISSUING_ID_C=A.ISSUING_ID_C 
AND OTL_ID_C='48')

PUT
AND EXISTS (SELECT DISTINCT 'PUT' 
FROM KBS.TISSUING_OTL 
WHERE ISSUING_ID_C=A.ISSUING_ID_C 
AND OTL_ID_C='43')

SINKING FUND
AND EXISTS (SELECT DISTINCT 'SF'
FROM KBS.TFEATURE_XREF X, KBS.TSINKING_FUND_REF Y
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND (X.ISSUER_ID_C=A.ISSUER_ID_C AND X.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C)) 

SPECIAL
AND EXISTS (SELECT DISTINCT 'SPECIAL'
FROM KBS.TFEATURE_XREF X, KBS.TSPEC_REDEM Y
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND (X.ISSUER_ID_C=A.ISSUER_ID_C AND X.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C))


VAR
AND EXISTS (SELECT DISTINCT 'VAR' 
FROM KBS.TISSUING_OTL 
WHERE ISSUING_ID_C=A.ISSUING_ID_C 
AND OTL_ID_C='44')




JOIN EDI-MB
AND ((SUBSTR(A.CRF_CINS,1,6) = F.ISSUER_ID_C)
AND (SUBSTR(A.CRF_CINS,7,2) = F.ISSUE_ALPHA_C))
AND E.OFFERING_ID_C=F.OFFERING_ID_C

ALL EQUITY CUSIPS IN MB (NUMERIC 1ST CHARACTER AND NUMERIC 7TH AND 8TH)
SELECT DISTINCT ISSUER_ID_C,ISSUE_ALPHA_C 
FROM KBS.TISSUE_REF 
WHERE
NVL(RTRIM(SUBSTR(ISSUER_ID_C,1,1),'0123456789'),'TRUE')='TRUE'
AND NVL(RTRIM(SUBSTR(ISSUE_ALPHA_C,1,1),'023456789'),'TRUE')='TRUE'
AND NVL(RTRIM(SUBSTR(ISSUE_ALPHA_C,2,1),'023456789'),'TRUE')='TRUE'


CROSS REFERENCING FEATURES AND CUSIPS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, B.*
FROM KBS.TFEATURE_XREF A, KBS.TSPEC_REDEM B
WHERE A.FEATURE_ID_C=B.FEATURE_ID_C 
AND (A.ISSUER_ID_C = '60636A' AND A.ISSUE_ALPHA_C = 'LD')

FRN'S ADJ ON SPECIFIC DATE
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, D.INST_TYPE_C, A.OFFERING_ID_C, C.INDEX_TYPE, C.INDEX_SUB_TYPE, C.CUTOFF_FREQ_CD, C.CUTOFF_TIMEZONE_CD, E.FREQ_PERIOD_C AS FREQ, A.COUPON_ORGL_P AS ISSUE_CPN, B.ADJ_RATE, B.ADJ_DT, B.BEGIN_DT, B.END_DT, B.CALC_COUPON_I, B.UPDATED_COUPON_I, B.ADDED_BY_C, B.ADDED_Z, B.MODIFIED_BY_C, B.MODIFIED_Z
FROM KBS.TISSUE_REF A, KBS.TVARIABLE_SCHEDULE B, KBS.TINDEX_GROUPING C, KBS.TINST_REF D, KBS.TVARIABLE_FEATURE E
WHERE (A.ISSUER_ID_C=B.ISSUER_ID_C AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C)
AND (A.ISSUER_ID_C=C.ISSUER_ID_C AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C)
AND D.INST_ID_C=A.INST_ID_C
AND (A.ISSUER_ID_C=E.ISSUER_ID_C AND A.ISSUE_ALPHA_C=E.ISSUE_ALPHA_C)
AND B.ADJ_DT BETWEEN TO_DATE('2/14/2015','MM/DD/YYYY') AND TO_DATE('2/17/2015','MM/DD/YYYY')
AND C.INDEX_TYPE IN ('LIBR', 'SMSW')
AND B.ADJ_RATE IS NOT NULL
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND NOT EXISTS (
SELECT DISTINCT ISSUER_ID_C, ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE 
WHERE ISSUER_ID_C=A.ISSUER_ID_C
AND ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND FULL_PART_CALL_C = 'FULL')
ORDER BY 1 ASC

MOST RECENT FEED ID (MAX)
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, A.UNIT_DENOM_1_M, A. MIN_TRDE_DENOM_2_M, A. INT_MULT_DENOM_3_M , A.ADL_UNIT_DENOM_4_M, B.MIN_DNMTN, B.MLTPL_DNMTN, C.NIIDS_DNP_ADDED_BY_C, B.SENT_DATE
FROM KBS.TISSUE_REF A, KBS.TNIIDS_FEED B, KBS.TOFFERING_REF C
WHERE A.ISSUER_ID_C=B.ISSUER_ID_C 
AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C
AND C.OFFERING_ID_C = A.OFFERING_ID_C
AND B.MIN_DNMTN<> A.ISSUE_DENOM_2_M
AND B.MLTPL_DNMTN <> A.ISSUE_DENOM_3_M
AND A.MIN_TRDE_DENOM_2_M IS NULL
AND A.INT_MULT_DENOM_3_M IS NULL
AND B.FEED_ID_C IN (SELECT DISTINCT MAX(FEED_ID_C) FROM KBS.TNIIDS_FEED FEED WHERE FEED.ISSUER_ID_C=A.ISSUER_ID_C AND FEED.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C)
ORDER BY 1 ASC


CUSIPS FOR INSTITUTION TYPE CHANGE
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, B.*
FROM KBS.TISSUE_REF A, KBS.TINST_REF B
WHERE A.INST_ID_C=B.INST_ID_C
AND B.INST_ID_C=725352


LOCKED OFFERINGS IN MB: 
SELECT DISTINCT OFFERING_ID_C, USER_ID_C, MODIFIED_Z FROM KBS.TOFFERING_LOCK ORDER BY MODIFIED_Z


DOMICILE CODE FROM EDI
SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, A.ISSUERNAME, B.CNTRYOFINCORP
FROM EDI.IDENTIFIER_XREF A, EDI.ISSUR B
WHERE A.ISSID=B.ISSID
AND A.ENDDATE IS NULL


SOURCE CODES BY MAX (TIMSTAMP) FOR EACH
SELECT DISTINCT INFO_SOURCE_C,MAX(ADDED_Z) 
FROM KBS.TINFO_SOURCE 
GROUP BY INFO_SOURCE_C

NO FULL CALL
AND NOT EXISTS (
SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X, KBS.TCALLED_BOND Y 
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND X.ISSUER_ID_C=A.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND Y.CALL_D < (SYSDATE) )

SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.*, C.*, D.*
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B, EDI.IRCHG C, EDI.CPOPT D
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID (+)
AND A.SECID=D.SECID (+)
AND A.CRF_CINS = 'N77608AA0'

AND A.CRF_CINS NOT LIKE '0%'
AND A.CRF_CINS NOT LIKE '1%'
AND A.CRF_CINS NOT LIKE '2%'
AND A.CRF_CINS NOT LIKE '3%'
AND A.CRF_CINS NOT LIKE '4%'
AND A.CRF_CINS NOT LIKE '5%'
AND A.CRF_CINS NOT LIKE '6%'
AND A.CRF_CINS NOT LIKE '7%'
AND A.CRF_CINS NOT LIKE '8%'
AND A.CRF_CINS NOT LIKE '9%'

ALL PHANTOM ISSUINGS
SELECT DISTINCT A.ISSUING_ID_C, A.OFFERING_ID_C 
FROM KBS.TISSUING_REF A
WHERE NOT EXISTS (
SELECT DISTINCT ISSUING_ID_C FROM KBS.TISSUE_REF WHERE ISSUING_ID_C=A.ISSUING_ID_C
)

ALL PHANTOM OFFERINGS—not in mb
SELECT DISTINCT A.OFFERING_ID_C 
FROM KBS.TOFFERING_REF A
WHERE NOT EXISTS (
SELECT DISTINCT OFFERING_ID_C FROM KBS.TISSUE_REF WHERE OFFERING_ID_C=A.OFFERING_ID_C
)


TO CHECK FRN STATUS
SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, A.ENDDATE, B.ISSUEDATE, B.MATURITYDATE, B.INTERESTBASIS, C.EFFECTIVEDATE AS INTBC_EFF_DATE, B.FRNTYPE, B.FRNINDEXBENCHMARK, B.MARKUP, B.FRNINTADJFREQ, B.FIRSTCOUPONDATE, B.INTERESTPAYMENTFREQUENCY, D.EFFECTIVEDATE AS IRCHG_EFF_DATE, D.OLDINTERESTRATE, D.NEWINTERESTRATE
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B, EDI.INTBC C, EDI.IRCHG D
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID (+)
AND A.SECID=D.SECID (+)
AND A.ENDDATE IS NULL
AND A.ISIN = 'IT0005008849'

EDI-FRN STATUS
SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.ISSUEDATE, B.MATURITYDATE, B.INTERESTBASIS, C.EFFECTIVEDATE, B.FRNTYPE, B.FRNINDEXBENCHMARK, B.MARKUP, B.FRNINTADJFREQ, B.FIRSTCOUPONDATE, B.INTERESTPAYMENTFREQUENCY
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B, EDI.INTBC C
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID (+)
AND A.ENDDATE IS NULL
AND B.INTERESTBASIS IN ('ZCSU','ZCSD','ZCSUSD','ZCFXDFR','ZCFXD','ZCFR')

EDI-DNP REPORT (QC1017)
SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.ISSUEDATE, B.MATURITYDATE, B.INTERESTRATE, B.FIRSTCOUPONDATE AS FC_DATE, B.INTERESTPAYMENTFREQUENCY AS INT_PAY_FREQ, B.INTERESTACCRUALCONVENTION AS DAY_COUNT, B.ISSUEAMOUNT, B.OUTSTANDINGAMOUNT, B.CURENCD
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B
WHERE A.SECID=B.SECID
AND B.MATURITYDATE > (SYSDATE)
AND B.ISSUEDATE IS NOT NULL
AND B.MATURITYDATE IS NOT NULL
AND B.INTERESTRATE IS NOT NULL
AND B.FIRSTCOUPONDATE IS NOT NULL 
AND B.INTERESTPAYMENTFREQUENCY IS NOT NULL
AND B.INTERESTACCRUALCONVENTION IS NOT NULL
AND B.ISSUEAMOUNT IS NOT NULL
AND B.OUTSTANDINGAMOUNT IS NOT NULL
AND B.CURENCD IS NOT NULL
AND A.CRF_CINS NOT LIKE '0%'
AND A.CRF_CINS NOT LIKE '1%'
AND A.CRF_CINS NOT LIKE '2%'
AND A.CRF_CINS NOT LIKE '3%'
AND A.CRF_CINS NOT LIKE '4%'
AND A.CRF_CINS NOT LIKE '5%'
AND A.CRF_CINS NOT LIKE '6%'
AND A.CRF_CINS NOT LIKE '7%'
AND A.CRF_CINS NOT LIKE '8%'
AND A.CRF_CINS NOT LIKE '9%'


MB-MULTIPLE ISSR (SAME OR DIFFERENT NAMES)
SELECT DISTINCT B.ISSUER_ID_C, B.ISSUE_ALPHA_C, 
    A.ISSUING_ID_C, A.CRDT_ENHMT_TYPE_C,
    COUNT(*) DUPCOUNT 
FROM KBS.TCRDT_ENHMT_REF A
  ,KBS.TISSUE_REF B
WHERE A.CRDT_ENHMT_TYPE_C = 'ISSR'
AND  A.ISSUING_ID_C = B.ISSUING_ID_C
GROUP BY B.ISSUER_ID_C, B.ISSUE_ALPHA_C, A.ISSUING_ID_C, A.CRDT_ENHMT_TYPE_C
HAVING COUNT(*) > 1 


MB-DUPLICATE CREDIT ENHANCEMENTS (SAME NAME)
SELECT DISTINCT CONCAT(B.ISSUER_ID_C,
    B.ISSUE_ALPHA_C) AS CUSIP, I.INST_TYPE_C AS INST_TYPE,
    A.ISSUING_ID_C AS ISSUING, 
    A.CRDT_ENHMT_TYPE_C AS TYPE,
    A.CRDT_ENHMT_EXP_C, I.INST_N AS INSTITUTION,
    COUNT(*) DUPCOUNT 
FROM KBS.TCRDT_ENHMT_REF A,
   KBS.TISSUE_REF B,
   KBS.TCRDT_ENHMT_INST C,
   KBS.TISSUER_REF D,
   KBS.TINST_REF I
WHERE A.CRDT_ENHMT_TYPE_C IN ('OBLI', 'GTD', 'GUAR', 'SCH', 'LOC', 'CLC', 'LIC', 'BPA', 'GIC', 'LIQF', 'SLC') 
AND A.ISSUING_ID_C = B.ISSUING_ID_C 
AND A.CRDT_ENHMT_ID_C = C.CRDT_ENHMT_ID_C 
AND C.INST_ID_C = I.INST_ID_C
AND B.ISSUER_ID_C=D.ISSUER_ID_C 
AND B.MATURITY_D > (SYSDATE)
AND B.MATURITY_TYPE_C <> '*' 
AND A.CRDT_ENHMT_EXP_C <> 'EXPIRE'
AND D.ISSUER_DESC_T NOT LIKE 'ADAMSVILLE%'
GROUP BY B.ISSUER_ID_C, B.ISSUE_ALPHA_C, I.INST_TYPE_C, A.ISSUING_ID_C, A.CRDT_ENHMT_TYPE_C, A.CRDT_ENHMT_EXP_C, I.INST_N
HAVING COUNT(*) > 1
ORDER BY 4,1


AO--TO DQ WORK
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.MATURITY_TYPE_C, A.OFFERING_ID_C, A.ISSUING_ID_C, B.DATED_D, A.MATURITY_D, B.PURP_TYPE_C AS PURP, B.PURP_CLASS_C AS CLASS, B.PURP_SUB_CLASS_C AS SUBCL, D.ISSUER_DESC_T AS ISSUER, B.ISSUING_CUSIP_T AS ISSUING_DESC, E.CRDT_ENHMT_TYPE_C AS ROLE_CODE, E.CRDT_ENHMT_ID_C, G.INST_N AS OBLIGOR , G.INST_CC6 AS CC6, D1.ISSUER_DESC_T AS CC6_INST, E.CRDT_ENHMT_EFF_D AS EFF_DATE, E.CRDT_ENHMT_END_D AS EXPIR_DATE, E. CRDT_ENHMT_EXP_C AS EXPIR_CODE, F.COVERAGE_P AS PCT,F.PRINCIPAL_L AS AMT, G.INST_ID_C AS INSTITUTION
FROM KBS.TISSUING_REF B, KBS.TISSUE_REF A, KBS.TISSUER_REF D, KBS.TINST_REF G,
KBS.TCRDT_ENHMT_REF E, KBS.TCRDT_ENHMT_INST F, KBS.TISSUER_REF D1
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUER_ID_C=D.ISSUER_ID_C (+)
AND B.ISSUING_ID_C=E.ISSUING_ID_C (+)
AND E.CRDT_ENHMT_ID_C=F.CRDT_ENHMT_ID_C (+)
AND F.INST_ID_C=G.INST_ID_C (+)
AND G.INST_CC6 = D1.ISSUER_ID_C (+)
AND 'BPA' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'CLC' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'CLL' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'GIC' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'INSN' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'LIQF' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'LOC' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'SLC' <> E.CRDT_ENHMT_TYPE_C (+) 
AND 'SYB' <> E.CRDT_ENHMT_TYPE_C (+)
AND ((A.ISSUER_ID_C IN ('520628') AND A.ISSUE_ALPHA_C IN ('AK')) OR
(A.ISSUER_ID_C IN ('000416') AND A.ISSUE_ALPHA_C IN ('J7'))
)
ORDER BY 1,2 ASC NULLS LAST


SPREADSHEET CREATION
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, B.OFFERING_ID_C, A.DATED_D, B.MATURITY_D, A.PURP_TYPE_C AS PURP, A.PURP_CLASS_C AS CLASS, A.PURP_SUB_CLASS_C AS SUBCL, D.ISSUER_DESC_T AS ISSUER, A.ISSUING_CUSIP_T
FROM KBS.TISSUING_REF A, KBS.TISSUE_REF B, KBS.TISSUER_REF D
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND B.ISSUER_ID_C=D.ISSUER_ID_C 
AND ((B.ISSUER_ID_C = '' AND B.ISSUE_ALPHA_C = '')
OR
) 
ORDER BY 1 ASC NULLS LAST


TO FIND ALL INSTITUTIONS WITH MULTIPLE ISSUERS
SELECT DISTINCT ISSR.INST_ID_C,COUNT(*) 
FROM KBS.TISSUER_REF ISSR, KBS.TINST_REF INST
WHERE ISSR.INST_ID_C = INST.INST_ID_C
AND INST.INST_TYPE_C <> 'MUNI' 
GROUP BY ISSR.INST_ID_C 
HAVING COUNT(*)>1
ORDER BY 2 DESC NULLS LAST


TO FIND ALL INSTITUTIONS WITH MULTIPLE ABA
SELECT DISTINCT ABA.INST_ID_C,COUNT(*) 
FROM KBS.TABA_REF ABA, KBS.TINST_REF INST
WHERE ABA.INST_ID_C = INST.INST_ID_C
AND INST.INST_TYPE_C <> 'MUNI' 
GROUP BY ABA.INST_ID_C 
HAVING COUNT(*)>1
ORDER BY 2 DESC NULLS LAST




REFUNDING REPORT
SELECT DISTINCT OFRG.OFFERING_ID_C, OFRG.OFFERING_ORGL_M, TO_CHAR(OFRG.SALE_NOTICE_D, 'MM-DD-YYYY') SALE_NOTICE_D, TRIM(UNDR.UNDWRTR_N) || ' ' || TRIM (UNDR.CITY_N) || ' ' || TRIM (UNDR.STATE_ID_C) "UNDERWRITER"
FROM KBS.TOFFERING_REF OFRG, KBS.TISSUE_REF ISS, KBS.TINST_REF INST, KBS.TUNDERWRITER_REF UNDR
WHERE
((OFRG.SALE_NOTICE_D BETWEEN TO_DATE('01-01-2009', 'MM-DD-YYYY') AND TO_DATE('12-15-2011', 'MM-DD-YYYY'))
OR (OFRG.SALE_NOTICE_D IS NULL
AND EXISTS
(SELECT DISTINCT 'ISSUEUPDATES' FROM KBS.TISSUE_REF
WHERE OFFERING_ID_C = OFRG.OFFERING_ID_C
AND TRUNC(ADDED_Z) BETWEEN TRUNC(SYSDATE-60) AND TRUNC(SYSDATE-10)
GROUP BY OFFERING_ID_C
HAVING COUNT(*) > 0 )))
AND OFRG.SALE_STATUS_C NOT IN ('C', 'P')
AND OFRG.SETTLMNT_STATUS_C NOT IN ('C', 'P')
AND        INST.INST_ID_C = OFRG.INST_ID_C
AND INST.INST_TYPE_C IN ('MUNI')
AND NOT EXISTS (
SELECT DISTINCT 'PROCEEDSUSEDTO' FROM KBS.TCOMMENTS CMT1
WHERE CMT1.OFFERING_ID_C = OFRG.OFFERING_ID_C
AND CMT1.TABLE_ABBRVN_C IN ('TOFFRING', 'TISSUING','TISSUE')
AND CMT1.COMMENT_TYPE_I IN ('I')
AND (TRIM(CMT1.COMMENT_LINE_T) LIKE '%PROCEEDS%') AND TRIM(CMT1.COMMENT_LINE_T) LIKE '%USED TO%')
AND (EXISTS (
SELECT DISTINCT 'RFDGCOMMENTS' FROM KBS.TCOMMENTS CMT2
WHERE CMT2.OFFERING_ID_C = OFRG.OFFERING_ID_C
AND CMT2.TABLE_ABBRVN_C IN ('TOFFRING', 'TISSUING','TISSUE')
AND CMT2.COMMENT_TYPE_I IN ('I')
AND (((TRIM(CMT2.COMMENT_LINE_T) LIKE '%RFDG PER NIIDS%') OR (TRIM(CMT2.COMMENT_LINE_T) LIKE '%RFDG PER DALCOM%'))
OR ((TRIM(CMT2.COMMENT_LINE_T) LIKE '%REFUNDING PER NIIDS%') OR (TRIM(CMT2.COMMENT_LINE_T) LIKE '%REFUNDING PER DALCOM%'))))
OR EXISTS (
SELECT DISTINCT 'RFDGISSUING' FROM KBS.TISSUING_REF
WHERE OFFERING_ID_C = OFRG.OFFERING_ID_C
AND ((TRIM(ISSUING_CUSIP_T) LIKE 'RFDG%') OR (TRIM(ISSUING_CUSIP_T) LIKE 'REFUNDING%') OR
(TRIM(ISSUING_CUSIP_T) LIKE 'REFINANING%') OR (TRIM(ISSUING_CUSIP_T) LIKE 'REF%'))))
AND ISS.OFFERING_ID_C = OFRG.OFFERING_ID_C
AND TRIM(ISS.MATURITY_TYPE_C) <> '*'
AND (TRIM(ISS.MATURITY_D) IS NOT NULL AND TO_CHAR(ISS.MATURITY_D,'YYYY-MM-DD') >= TO_CHAR(SYSDATE, 'YYYY-MM-DD'))
AND UNDR.UNDWRTR_ID_C = OFRG.UNDWRTR_ID_C
ORDER BY OFRG.OFFERING_ID_C

TO FIND ALL VALUES IN A FIELD
SELECT DISTINCT INFO_SOURCE_C
FROM KBS.TINFO_SOURCE
ORDER BY 1


TO FIND CUSIPS IN SDM BUT NOT IN MB

SELECT DISTINCT ISR.ISSUER_ID_C, ISR.ISSUE_ALPHA_C 
FROM KBS.TISSUE_REF@MBUSER_PROD2 ISR 
WHERE NOT EXISTS (SELECT DISTINCT 'INSTINPROD' FROM KBS.TISSUE_REF PROD2 WHERE PROD2.ISSUER_ID_C = ISR.ISSUER_ID_C 
AND PROD2.ISSUE_ALPHA_C = ISR.ISSUE_ALPHA_C)
ORDER BY 1,2 ASC NULLS LAST

TO FIND ALL DEALS WITH MULTIPLE 93 OTL'S

SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.ISSUING_ID_C
FROM KBS.TISSUE_REF A 
WHERE 
EXISTS (SELECT DISTINCT ISSUING_ID_C, OTL_ID_C, COUNT(*) 
FROM KBS.TISSUING_OTL 
WHERE OTL_ID_C='93' AND A.ISSUING_ID_C=ISSUING_ID_C 
GROUP BY ISSUING_ID_C,OTL_ID_C HAVING COUNT(*)>1)

OR

SELECT DISTINCT ISSUING_ID_C, 
 COUNT(ISSUING_ID_C) AS NUMOCCURRENCES
FROM KBS.TISSUING_OTL
WHERE OTL_ID_C = '93'
GROUP BY ISSUING_ID_C
HAVING (COUNT(ISSUING_ID_C) > 1 )


SELECT DISTINCT C.ISSUER_ID_C, C.ISSUE_ALPHA_C, B.OFFERING_ID_C, A.COMMENT_LINE_T
FROM KBS.TCOMMENTS A, KBS.TOFFERING_REF B, KBS.TISSUE_REF C, KBS.TINST_REF D
WHERE A.OFFERING_ID_C=B.OFFERING_ID_C
AND B.OFFERING_ID_C=C.OFFERING_ID_C
AND C.INST_ID_C=D.INST_ID_C
AND D.INST_TYPE_C IN ('MUNI', 'CORP') 
AND A.COMMENT_LINE_T LIKE '%MAKE-WHOLE%'
AND A.COMMENT_TYPE_I = 'E'
AND C.MATURITY_D > TO_DATE('06/20/2012', 'MM/DD/YYYY')

SELECT DISTINCT A.ISSUER_ID_C, A.ISSUE_ALPHA_C, B.SPEC_TYPE_C
FROM KBS.TSPEC_SCHED_ISSUE A, KBS.TSPEC_REDEM B
WHERE A.FEATURE_ID_C=B.FEATURE_ID_C
AND B.SPEC_TYPE_C = 'MWH'


SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.MATURITYDATE, B.CALLABLE
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B
WHERE A.SECID=B.SECID
AND A.CRF_CINS IN ('Y9366LAA3', 'P3772WAE2', P1265VAA0', 'N01766AA7', 'U1065PAB7')

SELECT DISTINCT A.SECID, A.CPTYPE, A.CALLPUT
FROM EDI.CPOPT A, EDI.CPOPT B
WHERE A.SECID=B.SECID
AND A.CPTYPE<>B.CPTYPE
AND A.CALLPUT <> 'P'
AND A.CPTYPE IS NOT NULL
AND B.CPTYPE IS NOT NULL
AND A.PRICE IS NULL
AND A.PRICEASPERCENT IS NULL
AND B.PRICE IS NULL
AND B.PRICEASPERCENT IS NULL
AND A.ACTFLAG<>'D'
AND B.ACTFLAG<>'D'
ORDER BY A.SECID

SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.FIRSTCOUPONDATE, B.INTERESTPAYMENTFREQUENCY, C.EFFECTIVEDATE
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B, EDI.INTBC C
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID
AND B.ACTFLAG <> 'D'
AND C.ACTFLAG <> 'D'
AND B.INTERESTPAYMENTFREQUENCY IS NOT NULL
AND B.INTERESTBASIS IN ('FR', 'FRFXD', 'FXDFR')
AND B.MATURITYDATE > TO_DATE('06/02/2012', 'MM/DD/YYYY')

SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.*
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B
WHERE A.SECID=B.SECID
AND A.CRF_CINS IN ('D6426ZAA9', 'CINS D5621DAA3', 'CINS G46214AB1')
AND B.SENIORJUNIOR IS NOT NULL
AND B.SECUREDBY IS NOT NULL

SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.CALLPUT, B.CPTYPE, B.MANDATORYOPTIONAL, B.FROMDATE, B.PRICE, B.PRICEASPERCENT
FROM EDI.IDENTIFIER_XREF A, EDI.CPOPT B
WHERE A.SECID=B.SECID
AND A.ISIN = 'XS0313604554'

SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.MATURITYDATE, B.INTERESTBASIS, C.EFFECTIVEDATE, B.FRNINDEXBENCHMARK, B.MARKUP
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B, EDI.INTBC C
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID
AND B.FRNINDEXBENCHMARK IN ('USDLIBOR1M','USDLIBOR1Y','USDLIBOR2M','USDLIBOR3M', 'USDLIBOR6M')

SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.FROMDATE
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B
WHERE A.SECID=B.SECID
AND A.ISIN NOT LIKE 'US%'
AND A.ISIN NOT LIKE 'CA%'
AND B.FROMDATE BETWEEN TO_DATE('01/01/2011', 'MM/DD/YYYY') AND TO_DATE('12/31/2011', 'MM/DD/YYYY')
AND B.ACTFLAG <> 'D'

SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.INTERESTBASIS, D.EFFECTIVEDATE, B.FRNINDEXBENCHMARK, B.MARKUP, B.INTERESTRATE, B.FIRSTCOUPONDATE, B.INTERESTPAYMENTFREQUENCY, C.OLDINTERESTRATE
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B, EDI.IRCHG C, EDI.INTBC D
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID
AND A.SECID=D.SECID
AND A.ISIN NOT LIKE 'US%'
AND A.ISIN NOT LIKE 'CA%'
AND B.ACTFLAG <> 'D'
AND B.FRNINDEXBENCHMARK IS NOT NULL
AND B.FRNINDEXBENCHMARK <> 'CRDRAT'
AND B.FIRSTCOUPONDATE > TO_DATE('01/01/2012', 'MM/DD/YYYY')
AND B.MATURITYDATE > TO_DATE('09/01/2012', 'MM/DD/YYYY')
AND B.INTERESTPAYMENTFREQUENCY IS NOT NULL
AND C.OLDINTERESTRATE IS NOT NULL


SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.FRNINDEXBENCHMARK, B.ISSUEDATE, B.INTERESTPAYMENTFREQUENCY, B.FIRSTCOUPONDATE, B.FRNINTADJFREQ, C.EFFECTIVEDATE
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B, EDI.INTBC C
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID
AND A.ISIN NOT LIKE 'US%'
AND A.ISIN NOT LIKE 'CA%'
AND B.ISSUEDATE > TO_DATE('09/01/2010', 'MM/DD/YYYY')
AND B.FRNINDEXBENCHMARK <> 'CRDRAT'
AND B.MODIFIEDZ > TO_DATE('04/01/2011', 'MM/DD/YYYY')
AND B.ACTFLAG <> 'D'
AND C.ACTFLAG <> 'D'


SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.FRNINDEXBENCHMARK, B.MARKUP
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B
WHERE A.SECID=B.SECID
AND A.CRF_CINS = 'G6459BDN8'
AND B.ACTFLAG <> 'D'


SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, C.CALLABLE, B.CALLPUT, B.FROMDATE, B.CPTYPE, B.MANDATORYOPTIONAL, B.PRICE, B.PRICEASPERCENT
FROM EDI.IDENTIFIER_XREF A, EDI.CPOPT B, EDI.BOND C
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID
AND B. ACTFLAG <> 'D'
AND A.ISIN NOT LIKE 'US%'
AND A.ISIN NOT LIKE 'CA%'
AND C.CALLABLE = 'Y'
AND B.CALLPUT = 'C'
AND B.FROMDATE IS NOT NULL
AND B.CPTYPE <> 'KO'
AND B.MANDATORYOPTIONAL IS NULL
AND B.PRICE IS NULL
AND B.PRICEASPERCENT IS NULL
AND B.ACTFLAG <> 'D'
AND C.ACTFLAG <> 'D'


SELECT DISTINCT A.ISIN, A.SECID, B.*
FROM EDI.IDENTIFIER_XREF A, EDI.REDEM B
WHERE A.SECID=B.SECID
AND B.REDEMDATE IS NOT NULL
AND A.ISIN NOT LIKE 'US%'
AND A.ISIN NOT LIKE 'CA%'
AND B.ACTFLAG <> 'D'

SELECT DISTINCT B.CRF_CINS, B.ISIN, B.SECID, A.INTERESTBASIS, A.PRICEASPERCENT, C.EFFECTIVEDATE
FROM EDI.BOND A, EDI.IDENTIFIER_XREF B, EDI.INTBC C
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID
AND A.INTERESTBASIS = 'FRZC'
AND A.ACTFLAG <> 'D'
AND A.PRICEASPERCENT = 100
AND C.EFFECTIVEDATE < TO_DATE('09/15/2011', 'MM/DD/YYYY')


SELECT DISTINCT A.SECID, A.ACTFLAG, B.CURENCD, C.CURENCD, D.INTERESTBASIS, E.EFFECTIVEDATE, F.PRICEASPERCENT
FROM EDI.BOND A, EDI. BOND B, EDI.BOND C, EDI.BOND D, EDI.INTBC E, EDI.BOND F
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID
AND A.SECID=D.SECID
AND A.SECID=E.SECID
AND A.SECID=F.SECID
AND A.ACTFLAG <> 'D'
AND B.CURENCD <> 'USD'
AND C.CURENCD <> 'CAD' 
AND D.INTERESTBASIS = 'ZCSD'
AND E.EFFECTIVEDATE > TO_DATE('09/01/2011', 'MM/DD/YYYY')
AND F.PRICEASPERCENT IS NOT NULL


SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, C.CALLABLE, B.CALLPUT, B.FROMDATE, B.CPTYPE, B.MANDATORYOPTIONAL, B.PRICE, B.PRICEASPERCENT
FROM EDI.IDENTIFIER_XREF A, EDI.CPOPT B, EDI.BOND C
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID
AND B. ACTFLAG <> 'D'
AND A.ISIN NOT LIKE 'US%'
AND A.ISIN NOT LIKE 'CA%'
AND C.CALLABLE = 'Y'
AND B.CALLPUT = 'C'
AND B.FROMDATE IS NOT NULL
AND B.CPTYPE <> 'KO'
AND B.MANDATORYOPTIONAL = 'O'
AND B.PRICE IS NOT NULL
AND B.PRICEASPERCENT IS NOT NULL


AND B.ISSUEDATE BETWEEN TO_DATE('01/01/2012', 'MM/DD/YYYY') AND TO_DATE('12/31/2012 ', 'MM/DD/YYYY')
AND B.ACTFLAG <> 'D'


SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.ISSUEDATE, B.MATURITYDATE, C.FROMDATE
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B, EDI.CPOPT C
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID
AND B. ACTFLAG <> 'D'
AND B.MATURITYDATE < TO_DATE('01/01/1000', 'MM/DD/YYYY')

SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.INTERESTBASIS, C.EFFECTIVEDATE
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B, EDI.INTBC C
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID
AND A.ISIN NOT LIKE 'US%'
AND A.ISIN NOT LIKE 'CA%'
AND B.INTERESTBASIS = 'SUFR'
AND C.EFFECTIVEDATE > TO_DATE('01/01/2013 00:00:00', 'MM/DD/YYYY ') 
AND B.ACTFLAG <> 'D'


SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.INTERESTBASIS, C.EFFECTIVEDATE
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B, EDI.INTBC C
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID
AND A.ISIN NOT LIKE 'US%'
AND A.ISIN NOT LIKE 'CA%'
AND B.INTERESTBASIS IN ('SU', 'SD', 'SUSD', 'SUZC', 'SDZC') 
AND B.ACTFLAG <> 'D'


MB

SELECT DISTINCT A.INST_TYPE_C, CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C), B.MATURITY_D, B.COUPON_ORGL_P, C.FREQ_PERIOD_C 
FROM KBS.TINST_REF A, KBS.TISSUE_REF B, KBS.TVARIABLE_FEATURE C
WHERE A.INST_ID_C=B.INST_ID_C
AND B.ISSUER_ID_C=C.ISSUER_ID_C
AND B.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C
AND A.INST_TYPE_C = 'CORP'
AND B.MATURITY_D > (SYSDATE) 
AND C.VARIABLE_TYPE_C = 'FRN'
AND C.FIRST_ADJ_DT > TO_DATE('01/01/2012 ', 'MM/DD/YYYY ') 

FRN
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.INDEX_TYPE, A.INDEX_SUB_TYPE, A.CUTOFF_FREQ_CD, B.ADJ_DT, A.MODIFIED_BY_C
FROM KBS.TINDEX_GROUPING A, KBS.TVARIABLE_SCHEDULE B
WHERE A.ISSUER_ID_C=B.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C
AND A.INDEX_TYPE = 'LIBR'
AND A.INDEX_SUB_TYPE = '3MO'
AND A.CUTOFF_FREQ_CD IS NULL
AND B.ADJ_DT = TO_DATE('05/18/2012 ', 'MM/DD/YYYY ')
ORDER BY 1 ASC NULLS LAST

SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.ISSUING_ID_C
FROM KBS.TISSUE_REF A 
WHERE EXISTS
(SELECT DISTINCT  
  ISSUING_ID_C
FROM KBS.TCRDT_ENHMT_REF TBL
WHERE
A.ISSUING_ID_C=ISSUING_ID_C
AND CRDT_ENHMT_TYPE_C IN ('OBLI', 'ISSR')
AND CRDT_ENHMT_ID_C IN ('553725', '553726', '553729', '553731', '843901', '843902', '843903', '843905', '843906', '866349', '866351', '879699', '1031456', '1139149', '1407397', '618604', '618605', '618606', '665167', '665169', '665170', '729101', '729103', '729104', '729105', 



SELECT DISTINCT  Z.ISSUING_ID_C
FROM KBS.TCRDT_ENHMT_REF X,KBS.TPREREFUNDED_REF Z  
WHERE
X.ISSUING_ID_C=Z.ISSUING_ID_C
AND Z.PREF_TYPE_C = 'PREF'
AND X.CRDT_ENHMT_TYPE_C = 'OBLI'
AND X.CRDT_ENHMT_ID_C IN ('553725', '553726', '553729', '553731', '843901', '843902', '843903', '843905', '843906', '866349', '866351', '879699', '1031456', '1139149', '1407397', '618604', '618605', '618606', '665167', '665169', '665170', '729101', '729103', '729104', '729105', '729106', '890692', '890693', '891542', '907827', '907828', '907829', '949108', '949109', '949110', '982498', '982499', '1010465', '1010474', '1010476', '1091540', '1144694', '1144693', '1281140', '1281141', '1281142', '1548631', '1547353', '1312899', '1312908', '1387062', '1387060', '1387063', '1332119', '1577481', '1524385', '1576861', '1576862', '1576867', '1584749', '1811114', '1811115', '1811116', '1811117', '1812869', '1603765', '1813176', '1813175')


RATINGS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.OFFERING_ID_C, A.ISSUING_ID_C
FROM KBS.TISSUE_REF A, KBS.TINST_REF B, KBS.TISSUE_CRDT_RATING C 
WHERE A.INST_ID_C=B.INST_ID_C
AND A.ISSUE_ID_C=C.ISSUE_ID_C (+)
AND B.INST_TYPE_C = 'MUNI'
AND A.MATURITY_D > (SYSDATE)
AND 'MDY' = C.CRDT_RATG_AGNCY_C (+)
AND 'L' = C.CRDT_RATE_TYPE_C (+)
AND IS NOT NULL = C.CRDT_RATE_C (+)
AND 'N/R' <> C.CRDT_RATE_C (+)


RATINGS MODIFIED BY TEJ
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.MATURITY_D, B.CRDT_RATG_AGNCY_C, B.CRDT_RATE_TYPE_C, B.CRDT_RATE_C
FROM KBS.TISSUE_REF A, KBS.TISSUE_CRDT_RATING B 
WHERE A.ISSUE_ID_C=B.ISSUE_ID_C 
AND A.MATURITY_D > (SYSDATE)
AND B.CRDT_RATG_AGNCY_C <> 'MDY'
AND B.MODIFIED_BY_C LIKE 'KI7'

FULL CALL WITHOUT A 93 OTL
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, B.MATURITY_D, A.INST_TYPE_C, C.FULL_PART_CALL_C, E.CALL_D, C.CALL_PRICE_L, D.OTL_ID_C, B.ISSUING_ID_C 
FROM KBS.TINST_REF A, KBS.TISSUE_REF B, KBS.TCALLED_ISSUE C, KBS.TISSUING_OTL D, KBS.TCALLED_BOND E
WHERE A.INST_ID_C=B.INST_ID_C
AND B.ISSUER_ID_C=C.ISSUER_ID_C
AND B.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C
AND B.ISSUING_ID_C=D.ISSUING_ID_C
AND C.FEATURE_ID_C=E.FEATURE_ID_C
AND A.INST_TYPE_C = 'MUNI'
AND B.MATURITY_D > (SYSDATE)
AND C.FULL_PART_CALL_C = 'FULL'
AND B.ISSUING_ID_C NOT IN (
SELECT DISTINCT ISSUING_ID_C FROM KBS.TISSUING_OTL O WHERE O.ISSUING_ID_C=B.ISSUING_ID_C AND O.OTL_ID_C ='93'
)

ALL NON-MATURED CUSIPS (FORN,CORP) WITH A FULL CALL
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.INST_TYPE_C, D.ISSUER_DESC_T AS ISSUER, F.DATED_D, A.COUPON_ORGL_P AS COUPON, A.MATURITY_D, E.CALL_D, C.CALL_PRICE_L 
FROM KBS.TINST_REF B, KBS.TISSUE_REF A, KBS.TCALLED_ISSUE C, KBS.TISSUER_REF D, KBS.TCALLED_BOND E, KBS.TISSUING_REF F
WHERE B.INST_ID_C=A.INST_ID_C
AND A.ISSUER_ID_C=C.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C
AND B.INST_ID_C=D.INST_ID_C
AND A.ISSUING_ID_C=F.ISSUING_ID_C
AND C.FEATURE_ID_C=E.FEATURE_ID_C
AND B.INST_TYPE_C IN ('FORN', 'CORP')
AND A.MATURITY_D > (SYSDATE)
AND C.FULL_PART_CALL_C = 'FULL'

TO FIND ALL DEALS UPDATED BY NIIDS/DALCOMP
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP , B.ADDED_Z 
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND EXISTS (
SELECT DISTINCT OFFERING_ID_C 
FROM KBS.TINFO_SOURCE C 
WHERE C.OFFERING_ID_C=A.OFFERING_ID_C 
AND C.USER_ID_C= 'NIIDS'
)
AND B.ISSUING_ID_C IN (
SELECT DISTINCT ISSUING_ID_C FROM KBS.TISSUING_OTL O WHERE O.ISSUING_ID_C=B.ISSUING_ID_C AND O.OTL_ID_C ='43'
)
AND B.ADDED_Z > TO_DATE('06/01/2014 ', 'MM/DD/YYYY ') 
ORDER BY 2 DESC

 

SELECT DISTINCT A.INST_TYPE_C, CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, C.DATED_D, B.COUPON_ORGL_P, B.MATURITY_D, D.PAYMENT_FIRST_D AS FIRST CPN DATE, D.FREQ_PERIOD_C AS PAYMENT FEQ 
FROM KBS.TINST_REF A, KBS.TISSUE_REF B, KBS.TISSUING_REF C, KBS.TINT_PAY_CYCLE D
WHERE A.INST_ID_C=B.INST_ID_C
AND B.ISSUING_ID_C=C.ISSUING_ID_C
AND C.ISSUING_ID_C=D.ISSUING_ID_C
AND A.INST_TYPE_C = 'GOVT'
AND C.PURP_CLASS_C='AGYG'
AND C.DATED_D IS NOT NULL
AND C.DATED_D >= TO_DATE('01/01/2011 ', 'MM/DD/YYYY ') 
AND B.COUPON_ORGL_P > 0
AND B.ISSUING_ID_C NOT IN (
SELECT DISTINCT ISSUING_ID_C FROM KBS.TISSUING_OTL O WHERE O.ISSUING_ID_C=B.ISSUING_ID_C AND O.OTL_ID_C ='61')
AND B.ISSUING_ID_C NOT IN (
SELECT DISTINCT ISSUING_ID_C FROM KBS.TISSUING_OTL O WHERE O.ISSUING_ID_C=B.ISSUING_ID_C AND O.OTL_ID_C ='44')


SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.MATURITY_D, B.CRDT_RATG_AGNCY_C, B.CRDT_RATE_TYPE_C, B.CRDT_RATE_C, C.USER_ID_C
FROM KBS.TISSUE_REF A, KBS.TISSUE_CRDT_RATING B, KBS.TINFO_SOURCE C
WHERE A.ISSUE_ID_C=B.ISSUE_ID_C 
AND A.OFFERING_ID_C=C.OFFERING_ID_C
AND A.MATURITY_D > (SYSDATE)
AND C.USER_ID_C LIKE 'KI7%'
AND C. USER_ID_C NOT IN (
SELECT DISTINCT ISSUING_ID_C 
FROM KBS.TISSUE_CRDT_RATING O 
WHERE O.ISSUING_ID_C=A.ISSUING_ID_C 
AND B.CRDT_RATG_AGNCY_C='MDY')

MDY RTGS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.MATURITY_D, B.CRDT_RATG_AGNCY_C, B.CRDT_RATE_TYPE_C, B.CRDT_RATE_C, C.USER_ID_C
FROM KBS.TISSUE_REF A, KBS.TISSUE_CRDT_RATING B, KBS.TINFO_SOURCE C
WHERE A.ISSUE_ID_C=B.ISSUE_ID_C 
AND A.OFFERING_ID_C=C.OFFERING_ID_C
AND A.MATURITY_D > (SYSDATE)
AND C.USER_ID_C LIKE 'KI7%'
AND C. USER_ID_C NOT IN (
SELECT DISTINCT ISSUING_ID_C 
FROM KBS.TISSUE_CRDT_RATING O 
WHERE O.ISSUE_ID_C=A.ISSUE_ID_C 
AND B.CRDT_RATG_AGNCY_C='MDY')

SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.INTERESTBASIS, B.FRNINDEXBENCHMARK, B.MARKUP
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B
WHERE A.SECID=B.SECID
AND B.FRNINDEXBENCHMARK = 'GBPLIBOR3M'
AND A.ISIN NOT LIKE 'US%'
AND A.ISIN NOT LIKE 'CA%'

SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.* 
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B
WHERE A.SECID=B.SECID
AND A.CRF_CINS IN ('U9871EKX0', 'T1R733AQ6', 'G3157RK72', 'G3157RCV8', 'G3157RCF3', 'G2737GBC6', 'F61115FK6', 'F61115EM3', 'E2116CAH8', '88059ELA0', '88059EKZ6', '88059EKY9', '88059EKX1', '88059EKW3', '88059EKV5', '88059EKU7', '88059EKT0', '88059EKS2', '88059EKR4', '88059EKQ6', '3134A1H60')


SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.INTERESTBASIS, B.FRNINDEXBENCHMARK, B.MARKUP
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B
WHERE A.SECID=B.SECID
AND B.FRNINDEXBENCHMARK LIKE 'USDLIBOR%'
AND B.MATURITYDATE > TO_DATE('08/15/2012 ', 'MM/DD/YYYY ')
AND A.ISIN NOT LIKE 'US%'
AND A.ISIN NOT LIKE 'CA%'


UPDATED BY NIIDS & HAS PUT OTL
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP 
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND EXISTS (SELECT DISTINCT OFFERING_ID_C 
FROM KBS.TINFO_SOURCE C 
WHERE C.OFFERING_ID_C=A.OFFERING_ID_C 
AND C.USER_ID_C= 'OFST')
AND B.ADDED_Z > TO_DATE('08/28/2012 ', 'MM/DD/YYYY ')
AND EXISTS (SELECT DISTINCT ISSUING_ID_C, OTL_ID_C
FROM KBS.TISSUING_OTL 
WHERE OTL_ID_C='43' AND A.ISSUING_ID_C=ISSUING_ID_C)

TECH DEFAULTS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP 
FROM KBS.TFEATURE_XREF A, KBS.TDEFAULTS B
WHERE A.FEATURE_ID_C=B.FEATURE_ID_C
AND B.DEFAULT_TYPE_C = 'TDFL'

UPDATED BY DALCOMP & HAS INSURANCE
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP 
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, KBS.TCRDT_ENHMT_REF D
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUING_ID_C=D.ISSUING_ID_C
AND EXISTS (SELECT DISTINCT OFFERING_ID_C 
FROM KBS.TINFO_SOURCE C 
WHERE C.OFFERING_ID_C=A.OFFERING_ID_C 
AND C.USER_ID_C= 'DALCOM')
AND B.ADDED_Z > TO_DATE('08/23/2012 ', 'MM/DD/YYYY ')
AND D.CRDT_ENHMT_TYPE_C = 'INSN'
AND D.COVERAGE_TYPE_C = 'FULL'
ORDER BY 1 ASC NULLS LAST

TO FIND ALL CORP CUSIPS WITH MSF
SELECT DISTINCT A.FEATURE_ID_C, CONCAT(C.ISSUER_ID_C, C.ISSUE_ALPHA_C) AS CUSIP 
FROM KBS.TFEATURE_REF A, KBS.TFEATURE_XREF B, KBS.TISSUE_REF C, KBS.TSINKING_FUND_REF D, KBS.TINST_REF E
WHERE A.FEATURE_ID_C=B.FEATURE_ID_C
AND B.ISSUE_ID_C=C.ISSUE_ID_C
AND A.FEATURE_ID_C=D.FEATURE_ID_C
AND C.INST_ID_C=E.INST_ID_C
AND D.SF_BEGIN_D IS NOT NULL
AND E.INST_TYPE_C = 'CORP'
AND C.MATURITY_D > (SYSDATE)

CORP CUSIPS WITH OBLI
SELECT DISTINCT A.INST_TYPE_C, CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, C.CRDT_ENHMT_TYPE_C
FROM KBS.TINST_REF A, KBS.TISSUE_REF B, KBS.TCRDT_ENHMT_REF C
WHERE A.INST_ID_C=B.INST_ID_C
AND B.ISSUING_ID_C=C.ISSUING_ID_C
AND A.INST_TYPE_C = 'CORP'
AND C.CRDT_ENHMT_TYPE_C = 'OBLI'
AND B.MATURITY_D > (SYSDATE)

CUSIPS UPDATED AS BUILD AMERICA BONDS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.BUILD_AMERICA_BONDS_C, B.TAX_PROGRAM_C, B.TAX_CREDIT_FREQ_C, B.TAX_CREDIT_RATE
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C 
AND B.BUILD_AMERICA_BONDS_C IN ('ISSUER', 'HOLDER', 'UNKNOWN')


SELECT DISTINCT A.CRF_CINS AS CINS, A.ISSUERNAME, C.ISSID
FROM EDI.IDENTIFIER_XREF A, EDI.SCMST B, EDI.ISSUR C
WHERE B.ISSID=C.ISSID
AND A.SECID=B.SECID
AND A.ISSID = 80274

CORP ISSUERS WITH NAME "%BOOK ENTRY"
SELECT DISTINCT A.ISSUER_DESC_T AS ISSUER
FROM KBS.TISSUER_REF A, KBS.TINST_REF B
WHERE A.INST_ID_C=B.INST_ID_C
AND A.ISSUER_DESC_T LIKE '%BOOK ENTRY'
AND A.ISSUER_TYPE_C = 'CUSIP'
AND B.INST_TYPE_C='CORP'

SIFMA WEEKLY SWAP CUSIPS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, D.OFFERING_ID_C, A.INDEX_TYPE, A.INDEX_SUB_TYPE, A.SPREAD_PLUSMINUS_I, A.SPREAD_INT_RATE, A.SPREAD_BASIS_PTS, A.CUTOFF_FREQ_CD, B.ADJ_DT, C.FREQ_PERIOD_C, A.MODIFIED_BY_C
FROM KBS.TINDEX_GROUPING A, KBS.TVARIABLE_SCHEDULE B, KBS.TVARIABLE_FEATURE C, KBS.TISSUE_REF D
WHERE A.ISSUER_ID_C=B.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C
AND A.ISSUER_ID_C=C.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C
AND A.ISSUER_ID_C=D.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=D.ISSUE_ALPHA_C
AND A.INDEX_TYPE = 'SMSW'
AND C.FREQ_PERIOD_C = 'WK'
AND B.ADJ_DT = TO_DATE('11/24/2016', 'MM/DD/YYYY')


TO FIND ALL CUSIPS TO WHICH CERTAIN OBLI INSTITUTION IS ATTACHED
SELECT DISTINCT A.INST_ID_C, A.INST_N, A.INST_TYPE_C, D.ISSUE_ID_C, C.ISSUING_ID_C, D.OFFERING_ID_C, C.CRDT_ENHMT_TYPE_C, CONCAT(D.ISSUER_ID_C, D.ISSUE_ALPHA_C) AS CUSIP, C.CRDT_ENHMT_ID_C, E.DATED_D, D.MATURITY_D
FROM KBS.TINST_REF A, KBS.TCRDT_ENHMT_INST B, KBS.TCRDT_ENHMT_REF C, KBS.TISSUE_REF D, KBS.TISSUING_REF E
WHERE A.INST_ID_C=B.INST_ID_C
AND B.CRDT_ENHMT_ID_C=C.CRDT_ENHMT_ID_C
AND C.ISSUING_ID_C=D.ISSUING_ID_C 
AND D.ISSUING_ID_C=E.ISSUING_ID_C 
AND D.MATURITY_D > (SYSDATE)
AND A.INST_N = '% INC'
AND a.issuer_id_c='128445' and a.issue_alpha_c='AJ'

TO FIND ALL ISSUINGS TO WHICH CERTAIN OBLI INSTITUTION IS ATTACHED
SELECT DISTINCT A.INST_ID_C, A.INST_N, A.INST_TYPE_C, C.ISSUING_ID_C, D.OFFERING_ID_C, C.CRDT_ENHMT_TYPE_C, CONCAT(D.ISSUER_ID_C, D.ISSUE_ALPHA_C) AS CUSIP, E.DATED_D, D.MATURITY_D
FROM KBS.TINST_REF A, KBS.TCRDT_ENHMT_INST B, KBS.TCRDT_ENHMT_REF C, KBS.TISSUE_REF D, KBS.TISSUING_REF E
WHERE A.INST_ID_C=B.INST_ID_C
AND B.CRDT_ENHMT_ID_C=C.CRDT_ENHMT_ID_C
AND C.ISSUING_ID_C=D.ISSUING_ID_C 
AND D.ISSUING_ID_C=E.ISSUING_ID_C 
AND D.MATURITY_D > (SYSDATE)
AND A.INST_N = '% INC'


ALL CUSIP FOR PARTICULAR SECTOR (CLASS)
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.PURP_TYPE_C AS PURP, B.PURP_CLASS_C AS CLASS, B.PURP_SUB_CLASS_C AS SUBCL
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND B.PURP_CLASS_C= 'HSG'
ORDER BY 1 ASC NULLS LAST

ALL GO CUSIPS FOR SPECIFIED DTD RANGE
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP 
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND B.PURP_TYPE_C = 'GO'
AND B.DATED_D BETWEEN TO_DATE('01/01/2010 ', 'MM/DD/YYYY ') AND TO_DATE('01/01/2011 ', 'MM/DD/YYYY ')
AND ROWNUM < 1500
ORDER BY 1 ASC NULLS LAST

ALL REV CUSIPS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP 
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND B.PURP_TYPE_C = 'REV'
AND B.DATED_D BETWEEN TO_DATE('01/01/2010 ', 'MM/DD/YYYY ') AND TO_DATE('01/01/2011 ', 'MM/DD/YYYY ')
ORDER BY 1 ASC NULLS LAST

ALL DB CUSIPS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND B.PURP_TYPE_C = 'DB'
AND B.DATED_D BETWEEN TO_DATE('01/01/2010 ', 'MM/DD/YYYY ') AND TO_DATE('01/01/2011 ', 'MM/DD/YYYY ')
ORDER BY 1 ASC NULLS LAST

ALL CUSIPS WITHOUT AO DATA BY SECTOR (CLASS)
SELECT DISTINCT B.ISSUER_ID_C, B.ISSUE_ALPHA_C, A.PURP_TYPE_C AS PURP, A.PURP_CLASS_C AS CLASS, A.PURP_SUB_CLASS_C AS SUBCL, D.ISSUER_DESC_T AS ISSUER, A.ISSUING_CUSIP_T AS ISSUING_DESC
FROM KBS.TISSUING_REF A, KBS.TISSUE_REF B, KBS.TOFFERING_REF C, KBS.TISSUER_REF D, KBS.TINST_REF E
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.OFFERING_ID_C=C.OFFERING_ID_C
AND B.ISSUER_ID_C=D.ISSUER_ID_C
AND B.INST_ID_C=E.INST_ID_C
AND E.INST_TYPE_C = 'MUNI'
AND A.PURP_CLASS_C= 'HLTH'
AND A.SECURITY_TYPE_C = 'BOND'
AND A.DATED_D > TO_DATE('01/01/2006 ', 'MM/DD/YYYY ')
AND B.MATURITY_D > (SYSDATE)
AND C.OFFERING_TYPE_C <> 'R' 
AND C.OFFERING_TYPE_C <> 'PD'
AND NOT EXISTS (
SELECT DISTINCT ISSUING_ID_C 
FROM KBS.TCRDT_ENHMT_REF X
WHERE X.ISSUING_ID_C=A.ISSUING_ID_C 
AND X.CRDT_ENHMT_TYPE_C = 'ISSR')
AND NOT EXISTS (
SELECT DISTINCT ISSUING_ID_C 
FROM KBS.TCRDT_ENHMT_REF Y
WHERE Y.ISSUING_ID_C=A.ISSUING_ID_C 
AND Y.CRDT_ENHMT_TYPE_C = 'OBLI')
ORDER BY 1 ASC NULLS LAST

OFST SOURCE CODE EXISTS
AND EXISTS (
SELECT DISTINCT OFFERING_ID_C 
FROM KBS.TINFO_SOURCE C 
WHERE C.OFFERING_ID_C=A.OFFERING_ID_C 
AND C.INFO_SOURCE_C= 'OFST')

ALL EDUC BONDS IN MB
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C)AS CUSIP, A.PURP_TYPE_C AS PURP, A.PURP_CLASS_C AS CLASS, A.PURP_SUB_CLASS_C AS SUBCL, D.ISSUER_DESC_T AS ISSUER, A.ISSUING_CUSIP_T AS ISSUING_DESC
FROM KBS.TISSUING_REF A, KBS.TISSUE_REF B, KBS.TOFFERING_REF C, KBS.TISSUER_REF D
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.OFFERING_ID_C=C.OFFERING_ID_C
AND B.ISSUER_ID_C=D.ISSUER_ID_C
AND A.PURP_CLASS_C= 'EDUC'
AND A.SECURITY_TYPE_C = 'BOND'
AND A.DATED_D > TO_DATE('01/01/2006 ', 'MM/DD/YYYY ')
AND B.MATURITY_D > (SYSDATE)
AND C.OFFERING_TYPE_C <> 'R' 
AND C.OFFERING_TYPE_C <> 'PD'
ORDER BY 1 ASC NULLS LAST




ALL CUSIPS INCLUDING AO DATA BY SECTOR (CLASS)
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, A.PURP_TYPE_C AS PURP, A.PURP_CLASS_C AS CLASS, A.PURP_SUB_CLASS_C AS SUBCL, D.ISSUER_DESC_T AS ISSUER, A.ISSUING_CUSIP_T AS ISSUING_DESC, E.CRDT_ENHMT_TYPE_C AS ROLE_CODE, E. CRDT_ENHMT_EFF_D AS EFF_DATE, E.CRDT_ENHMT_END_D AS EXPIR_DATE, E. CRDT_ENHMT_EXP_C EXPIR_CODE, F.COVERAGE_P AS AMT_PCT, G.INST_N AS OBLIGOR, G.INST_CC6 AS CC6, D1.ISSUER_DESC_T AS CC6_INST, B.MATURITY_D
FROM KBS.TISSUING_REF A, KBS.TISSUE_REF B, KBS.TOFFERING_REF C, KBS.TISSUER_REF D, KBS.TCRDT_ENHMT_REF E, KBS.TCRDT_ENHMT_INST F, KBS.TINST_REF G, KBS.TISSUER_REF D1
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.OFFERING_ID_C=C.OFFERING_ID_C
AND B.ISSUER_ID_C=D.ISSUER_ID_C
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND E.CRDT_ENHMT_ID_C=F.CRDT_ENHMT_ID_C
AND F.INST_ID_C=G.INST_ID_C
AND G.INST_CC6 = D1.ISSUER_ID_C (+)
AND G.INST_TYPE_C = 'MUNI'
AND A.PURP_TYPE_C= 'GO'
AND A.PURP_CLASS_C= 'SCH'
AND A.DATED_D > TO_DATE('01/01/2006 ', 'MM/DD/YYYY ')
AND B.MATURITY_D > (SYSDATE)
AND C.OFFERING_TYPE_C <> 'R' 
AND C.OFFERING_TYPE_C <> 'PD'
AND EXISTS (
SELECT DISTINCT ISSUING_ID_C 
FROM KBS.TCRDT_ENHMT_REF X
WHERE X.ISSUING_ID_C=A.ISSUING_ID_C 
AND (X.CRDT_ENHMT_TYPE_C = 'ISSR' OR X.CRDT_ENHMT_TYPE_C = 'OBLI')
)
AND ROWNUM < 40000
ORDER BY 1 ASC NULLS LAST

AND NOT EXISTS (
SELECT DISTINCT ISSUER_ID_C, ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE Z
WHERE Z.ISSUER_ID_C=B.ISSUER_ID_C
AND Z.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C
AND Z.FULL_PART_CALL_C = 'FULL'
)
AND CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) IN ('234219GQ', '234219GR', '234219GM', '234219GN', '234219GP', '596604AW', '596604AX', '596604AY', '857322AV', '857322AQ', '857322AR', '857322AS', '857322AT', '857322BJ', '857322BK', '857322BL', '857322BM', '857322BP', '857322BQ', '224057ET', '224057EU', '224057EV', '224057EW', '224057EX', '224057EY', '665577AU', '665577AN', '665577AP', '665577AQ', '665577AR', '665577AS', '665577AT', '837469GA', '837469GB', '837469GC', '837469FY', '837469FZ', '494890TE', '494890TF', '494890TG', '262608LT', '943363GX', '943363GR', '943363GS', '943363GT', '815628ES', '815628ER', '397058CM', '397058CQ', '397058CR', '397058CS', '397058CT', '397058CP', '397058CL', '495741CL', '495741CP', '495741CS', '495741CM', '495741CQ', '256471FN', '256471FP', '256471FQ', '256471FR', '256471FS', '256471FT', '353442QY', '353442QZ', '353442RA', '353442RB', '353442RC', '353442RD', '445042J8', '445042J9', '445042K2', '763612AM', '763612AN', '763612AP', '763612AQ', '669199BC', '669199BD', '669199BE', '491854BD', '491854BE', '491854BF', '491854BG', '491854BH', '491854BJ', '491854BK', '350393EJ', '350393EK', '350393EL', '350393EM', '358334CX', '358334CZ', '358334DA', '358334DB', '358334CV', '358334CW', '358334CY', '537071HS', '537071HU', '537071HV', '537071HY', '537071JA', '537071JE', '537071JJ', '537071HT', '537071HW', '537071HX', '537071HZ', '537071JB', '953429CT', '953429CU', '953429CV', '953429CW', '953429CX', '953429CR', '953429CS', '953429CY', '185090BM', '185090BN', '185090BP', '185090BQ', '185090BR', '185090BS', '185090BT', '185090BU', '185090BV', '952347DE', '952347CT', '952347CU', '952347CV', '952347CW', '952347CX', '952347CY', '952347CZ', '952347DA', '714704BZ', '714704CA', '714704CC', '714704CD', '714704CE', '714704CF', '714704CB', '372453EA', '724581EW', '724581FA', '724581EP', '724581EQ', '724581ER', '724581ES', '724581ET', '724581EU', '130006DL', '130006DM', '130006DN', '662078BR', '662078BS', '662078BH', '662078BJ', '662078BK', '662078BL', '662078BM', '662078BN', '662078BP', '662078BQ', '774766FE', '774766FG', '774766FL', '774766FF', '774766FH', '774766FJ', '774766FK', '694393AW', '694393BA', '694393BF', '694393AP', '694393AQ', '694393AR', '694393AS', '421836EJ', '421836EK', '421836EL', '421836EM', '421836EN', '421836DV', '421836DW', '421836DX', '421836DY', '421836DZ', '421836EA', '421836EB', '421836EC', '421836ED', '421836EE', '421836EF', '421836EG', '421836EH', '642543LR', '642543LS', '642543LT', '642543LV', '642543LW', '642543LX', '642543LQ', '642543LU', '151893CR', '151893CS', '151893CT', '493332BS', '493332BT', '493332BU', '493332BV', '493332BW', '493332BX', '493332BY', '493332BZ', '704505FK', '704505FP', '704505FL', '704505FM', '704505FQ', '704505FR', '425002LF', '425002LG', '425002LE', '425002LL', '425002LH', '425002LJ', '614446BU', '614446BV', '614446BW', '614446BX', '614446BY', '614446BZ', '614446CA', '614446CB', '348856FU', '348856FV', '348856FW', '797138DG', '797138DH', '797138CY', '797138CZ', '797138DA', '797138DB', '797138DC', '797138DD', '797138DE', '797138DF', '797138DJ')



TO CHECK FOR AO EFFECTIVE DATE & PCT FIELD UPDATES
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, F.COVERAGE_P AS COVER, E.CRDT_ENHMT_EFF_D AS EFF_DATE
FROM KBS.TISSUING_REF A, KBS.TISSUE_REF B, KBS.TCRDT_ENHMT_REF E, KBS.TCRDT_ENHMT_INST F
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND E.CRDT_ENHMT_ID_C=F.CRDT_ENHMT_ID_C
AND CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) IN ('234219GQ', '234219GR', '234219GM', '234219GN', '234219GP', '596604AW', '596604AX', '596604AY', '857322AV', '857322AQ', '857322AR', '857322AS', '857322AT', '857322BJ', '857322BK', '857322BL', '857322BM', '857322BP', '857322BQ', '224057ET', '224057EU', '224057EV', '224057EW', '224057EX', '224057EY', '665577AU', '665577AN', '665577AP', '665577AQ', '665577AR', '665577AS', '797138DJ')









IPD-TO BRING UP ALL AO DATA IN PRODUCT DATABASE TO DQ
SELECT DISTINCT A.CUSIP, B.QSIP_ISSUER_DESC, A.AO_TYPE, A.AO_ENHANCER_NAME, 
A.AO_ENHANCER_CITY, A.AO_ENHANCER_STATE, A.AO_CC6_01, A.AO_AMT_PCT_I, A.AO_EXPIRATION_DATE, 
 A.AO_EXPIRATION_CODE, A.AO_AMT_PCT_X, A.AO_ENTITY_NAME, A.AO_ENTITY_CITY, A.AO_ENTITY_STATE, 
 C.PURP_TYPE_CODE, C.PURP_CLASS_CODE, C.PURP_SUB_CLASS_CODE 
FROM MASTER_REF.SPSE_ASSOCOBLIG_AO A, MASTER_REF.SPSE_CUSIPREC_QS B, MASTER_REF.SPSE_PURPOSE_PT C
WHERE A.CUSIP=B.CUSIP9
AND B.CUSIP9=C.CUSIP9
AND A.AO_TYPE <> 'INSR'
AND A.CUSIP IN ()


IPD-TO BRING UP ALL AO DATA IN PRODUCT DATABASE FOR SPREADSHEETS
SELECT DISTINCT 
  A.CUSIP, B.QSIP_ISSUER_DESC, A.AO_TYPE, A.AO_ENHANCER_NAME, 
  A.AO_INS_TYPE_IND, A.AO_FULL_SECMKT_INS_IND, A.AO_CC6_01, 
  A.AO_ENHANCER_CITY, A.AO_ENHANCER_STATE, A.AO_INSURANCE_CODE, 
  A.AO_CC6_02, A.AO_AMT_PCT_I, A.AO_EXPIRATION_DATE, 
  A.AO_EXPIRATION_CODE, A.AO_AMT_PCT_X, A.AO_ENTITY_NAME, 
  A.AO_CC6_03, A.AO_ENTITY_CITY, A.AO_ENTITY_STATE, 
  A.AO_CC6_04, C.PURP_TYPE_CODE, C.PURP_CLASS_CODE, C.PURP_SUB_CLASS_CODE 
FROM MASTER_REF.SPSE_ASSOCOBLIG_AO A, MASTER_REF.SPSE_CUSIPREC_QS B, MASTER_REF.SPSE_PURPOSE_PT C
WHERE A.CUSIP=B.CUSIP9
AND B.CUSIP9=C.CUSIP9
AND A.AO_TYPE <> 'INSR'
AND A.CUSIP IN ()


TO QUERY FOR ALL PTVM PUTS (SORTED BY DTD)

SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, C.DATED_D, A.OTL_TEXT_T 
FROM KBS.TISSUING_OTL A, KBS.TISSUE_REF B, KBS.TISSUING_REF C
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C
AND A.OTL_TEXT_T LIKE 'PTVM%'
ORDER BY 2 ASC NULLS LAST


LIST OF LIBORS WITH 5 DISCONTINUED CURRENCIES
SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.FRNINDEXBENCHMARK, B.CURENCD
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B
WHERE A.SECID=B.SECID
AND B.FRNINDEXBENCHMARK LIKE '%LIBOR%'
AND B.CURENCD IN ('NZD', 'DKK', 'SEK', 'AUD', 'CAD')


IPD-AO DATA IN PRODUCTS FOR KATHY'S 40 INCOMPLETE CUSIPS
SELECT DISTINCT 
  A.CUSIP, B.QSIP_ISSUER_DESC, A.AO_TYPE, A.AO_ENHANCER_NAME, 
  A.AO_INS_TYPE_IND, A.AO_FULL_SECMKT_INS_IND, A.AO_CC6_01, 
  A.AO_ENHANCER_CITY, A.AO_ENHANCER_STATE, A.AO_INSURANCE_CODE, 
  A.AO_CC6_02, A.AO_AMT_PCT_I, A.AO_EXPIRATION_DATE, 
  A.AO_EXPIRATION_CODE, A.AO_AMT_PCT_X, A.AO_ENTITY_NAME, 
  A.AO_CC6_03, A.AO_ENTITY_CITY, A.AO_ENTITY_STATE, 
  A.AO_CC6_04, C.PURP_TYPE_CODE, C.PURP_CLASS_CODE, C.PURP_SUB_CLASS_CODE 
FROM MASTER_REF.SPSE_ASSOCOBLIG_AO A, MASTER_REF.SPSE_CUSIPREC_QS B, MASTER_REF.SPSE_PURPOSE_PT C
WHERE A.CUSIP=B.CUSIP9
AND B.CUSIP9=C.CUSIP9
AND A.AO_TYPE <> 'INSR'
AND A.AO_TYPE <> 'LOC'
AND A.CUSIP IN ('00202NAA3', '025270AY5', '05567LYP6', '073605AC1', '093662AC8', '093662AD6', '097014AH7', '097023AD7', '17313YAJ0', '17453BAP6', '184502AP7', '184502AS1', '186108CF1', '234050AA0', '33882EAA1', '41013MCT5', '48245RAF1', '482620AW1', '491792AA5', '500769EB6', '51488YAB5', '52107QAC9', '530715AR2', '631103AA6', '780153AG7', '808510AA9', '939671AA1', '94975ZBH8', '960394AP9', '969133AJ6', '979845CP7', 'B533BR4D5', 'D1604XAA9', 'D20658YB6', 'F0609NAF5', 'F61115FF7', 'F67262AA7', 'G0457FAA5', 'G2018ZAA9', 'G2584XAA8')



IPD
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, A.PURP_TYPE_C AS PURP, A.PURP_CLASS_C AS CLASS, A.PURP_SUB_CLASS_C AS SUBCL, D.ISSUER_DESC_T AS ISSUER, A.ISSUING_CUSIP_T AS ISSUING_DESC, E.CRDT_ENHMT_TYPE_C AS ROLE_CODE, G.INST_N AS OBLIGOR, G.INST_CC6 AS CC6, F.COVERAGE_P AS ANT_PCT, E.CRDT_ENHMT_EFF_D AS EFF_DATE
FROM KBS.TISSUING_REF A, KBS.TISSUE_REF B, KBS.TOFFERING_REF C, KBS.TISSUER_REF D, KBS.TCRDT_ENHMT_REF E, KBS.TCRDT_ENHMT_INST F, KBS.TINST_REF G
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.OFFERING_ID_C=C.OFFERING_ID_C
AND B.ISSUER_ID_C=D.ISSUER_ID_C
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND E.CRDT_ENHMT_ID_C=F.CRDT_ENHMT_ID_C
AND F.INST_ID_C=G.INST_ID_C
AND G.INST_TYPE_C = 'MUNI'
AND A.PURP_CLASS_C IN ('IMPT', 'VP', 'BAN', 'RAN', 'TAN', 'TRN', 'STAN')
AND A.SECURITY_TYPE_C = 'BOND'
AND A.DATED_D > TO_DATE('01/01/2002 ', 'MM/DD/YYYY ')
AND C.OFFERING_TYPE_C <> 'R' 
AND C.OFFERING_TYPE_C <> 'PD'
AND EXISTS (
SELECT DISTINCT ISSUING_ID_C 
FROM KBS.TCRDT_ENHMT_REF X
WHERE X.ISSUING_ID_C=A.ISSUING_ID_C 
AND (X.CRDT_ENHMT_TYPE_C = 'ISSR' OR X.CRDT_ENHMT_TYPE_C = 'OBLI')
)
AND ROWNUM < 20000


FRACTIONAL NUMBERS ( SAVE TO TEXT FILE)
SELECT DISTINCT B.FRACTIONAL_ID_C, A.INST_N
FROM KBS.TINST_REF A, KBS.TINST_FRACT_XREF B
WHERE A.INST_ID_C = B.INST_ID_C
AND B.FRACTIONAL_ID_C >= 6670000
AND B.FRACTIONAL_ID_C <= 7709999
ORDER BY 1 ASC NULLS LAST	


TO FIND ALL MUNI MAKE-WHOLE CALLS 
SELECT DISTINCT B.FEATURE_ID_C, E.INST_TYPE_C, CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, D.MATURITY_D, B.SPEC_TYPE_C
FROM KBS.TFEATURE_XREF A, KBS.TSPEC_REDEM B, KBS.TSPEC_SCHEDULE C, KBS.TISSUE_REF D, KBS.TINST_REF E
WHERE A.FEATURE_ID_C=B.FEATURE_ID_C
AND A.FEATURE_ID_C=C.FEATURE_ID_C
AND A.ISSUER_ID_C=D.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=D.ISSUE_ALPHA_C 
AND D.INST_ID_C=E.INST_ID_C
AND B.SPEC_TYPE_C = 'MWH'
AND E.INST_TYPE_C = 'MUNI'



QUERY FOR JAMES (EDI, SENIORITY, CALLABLE INDICATORS)
SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.SENIORJUNIOR, B.CALLABLE, B.ADDEDZ
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B
WHERE A.SECID=B.SECID
AND B.ADDEDZ >= TO_DATE ('03/01/2013', 'MM/DD/YYYY')


QUERY CUSIPS TO IDENTIFY STATE CODE & INCORRECT STATE TAX CODE
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, A.STATE_INCORP_1_C, C.STATE_TAX_OVRDE_C 
FROM KBS.TINST_REF A, KBS.TISSUE_REF B, KBS.TISSUING_REF C
WHERE A.INST_ID_C=B.INST_ID_C
AND B.ISSUING_ID_C=C.ISSUING_ID_C
AND CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) IN ('00432CAM', '010399AQ', '0118326M', '012122Y8', '012122Z2', '012122Z6', '016721CP', '023474AB', '038906BF', '04108WAS', '052396EF', '052396EJ', '052396ER', '052396GV', '052396HR', '052396HT', '052396JA', '054033NF', '054213RQ', '057497CP', '059189CV', '07330CVM', '07330CVN', '075396LA', '084540BY', '092325AA', '09478RAA', '098786EU', '1008526N', '101029HM', '10620NBC', '10620NBS', '10620NBV', '10620NBW', '10623PBV', '10623PCK', '117657AJ', '118608BH', '13033HXM', '13033HXN', '13034PQV', '130625AQ', '130625AR', '130625AS', '130625BD', '130626AB', '130626AC', '130626AF', '130627AK', '13063AWQ', '130663CK', '13068GRB', '13068HD9', '13068HEE', '13068HFP', '130905CE', '130905DG', '137069FY', '1598074S', '1598074T', '1598074X', '1598074Y', '1598075A', '1598075B', '167531BG', '168601AS', '169178KJ', '172702FU', '180847A5', '180847A7', '180847C3', '180847C4', '180847C6', '181072NJ', '181072NK', '185713AE', '185713AF', '186343KK', '192167AC', '19463TAB', '196476BF', '196479RG', '19647HAT', '196630PP', '197478AB', '198756DE', '198828AB', '219770CD', '223577AE', '230579UL', '23226RAB', '251237B5', '251237C4', '251237VQ', '251237VS', '251255XL', '251255XM', '259372GZ', '266705VX', '266705VY', '26951PCJ', '270595AE', '270838AJ', '287468EF', '287468EH', '290641S7', '291195EK', '295085AW', '30002EAM', '303585RP', '303585RR', '303823DB', '304639PA', '33803MAA', '33803VAD', '34061NBP', '341149AD', '341529DD', '347456AA', '347572AA', '347790AF', '348172LC', '349515HJ', '356460JL', '357330AA', '358802K5', '359757AM', '360053DV', '365653GT', '366429AB', '372787FP', '373384TE', '373588CP', '376302BE', '376302BF', '377136KP', '386442GC', '399676EG', '399676EH', '400422AA', '403723DC', '404738LW', '414004CK', '414875AA', '415120CE', '416790AS', '423788BL', '424672NW', '425200P8', '425200Q2', '443525BN', '443730HH', '446356AY', '451187AT', '45129THV', '45129TMA', '45200FBC', '45504RDC', '455398GN', '455398GP', '455398GQ', '455398GT', '46636YJX', '467145BF', '469157AB', '470756CG', '471424BB', '47303LAA', '487170XP', '514246GA', '515048BJ', '533485AK', '533485AL', '54242EAA', '542620MH', '543760AE', '544552BQ', '544565AA', '545152EJ', '546456DC', '547856BC', '562462LX', '564538AN', '564538AV', '565179BQ', '565179BR', '565561AU', '566823RC', '566824CA', '567031NN', '567288MR', '567288MW', '567745FD', '569832LZ', '574205CJ', '57420NAN', '574463LC', '574463LD', '575824AE', '5758504X', '576047QB', '576047QC', '576047QD', '580472BF', '584724DT', '584724DU', '592598HV', '594553HM', '594569CG', '59465E2V', '594698BB', '594698BL', '59469C5N', '59469C6F', '59469C6P', '59469C7V', '59469CD2', '59469CH3', '59469CHQ', '59469CLT', '59469CPQ', '59469CRT', '59469CT5', '59469CU2', '59469CU3', '59469CUR', '59469CVF', '59469CX3', '59469CY3', '59469CZT', '59469CZV', '59469YAD', '60416HHV', '605279CS', '605356MG', '605356MJ', '60535JAF', '60635RMV', '60635RQW', '60636CEZ', '629870AU', '641461WF', '641461WG', '6432724H', '6432724J', '644614HA', '644614HB', '644614HD', '644614HE', '64469DRB', '64469DRS', '64469DRV', '645788MC', '645788SG', '645788SQ', '645788V8', '64605K8N', '646724AC', '647634YA', '649657AF', '649657AH', '64966CG5', '64966CG8', '64966CJH', '64966CTU', '64966CUD', '64966CUL', '64966DDS', '64966DDT', '64966DDW', '64966DDZ', '64966DJZ', '64966ED8', '64966EE3', '64966EH6', '64966EK3', '64966EM7', '64966EN5', '64966F4R', '64966F4S', '64966F5B', '64966FA3', '64966FA7', '64966FMG', '64966FMT', '64966FMU', '64966FWX', '64966GEE', '64966GQY', '64966GRH', '64966GTQ', '64966JP9', '64966JQ2', '64966JWB', '64966JWV', '64966KCK', '64966KCP', '64970HAC', '649716DY', '64971CW5', '64971CW6', '64971CW7', '64971KGF', '64971KGG', '649786BN', '649787C4', '649787C7', '649787K3', '6498317Q', '649834BW', '649834BZ', '649834HV', '649834PA', '649835C4', '649836JG', '649837TE', '64983MTS', '64983RK4', '64983SAZ', '649845DV', '64984EDJ', '649902DH', '649902DJ', '649902DK', '649902DM', '649902DN', '649902DS', '649902DX', '649902DZ', '649902EB', '658196QS', '658256TY', '658556BU', '6591545T', '6670276Z', '667027TK', '672523DS', '672523DU', '672523FB', '672523FT', '677377J4', '677596AH', '68423PQA', '685355DV', '696507FR', '696656EZ', '697600CR', '7023336J', '7023336L', '7023336R', '707162AV', '708684KH', '709222BV', '714386AS', '714386AT', '715076FG', '715076FJ', '717883AM', '717883AN', '717883AP', '718904AD', '721902BT', '724568FA', '733580QG', '734115CP', '74500PAA', '752278FA', '757606QD', '758508DH', '76116EBY', '76116EBZ', '76116ECG', '76116EFH', '76116EFJ', '76116EFL', '76116EFM', '76116EFP', '76128PAP', '768767AA', '768901BN', '769124EY', '770657AV', '785677AA', '786004QE', '786004RD', '786149GK', '79306ETD', '795583DX', '796711RW', '796711SA', '796815PK', '79771PPN', '79771PPR', '79771PXY', '798177CQ', '799054BL', '799054BM', '799054BS', '801639BC', '802615UM', '81170TBM', '812626F7', '818894AA', '819870GF', '826132AK', '831652AE', '834688AC', '835552GN', '837031GE', '83703FAX', '83710DGA', '83710DGC', '83710DNA', '83710DNB', '837147H4', '837752FZ', '841513LA', '841513LD', '841513LF', '841513LH', '841513LK', '848278AA', '860558AA', '862029QL', '863869CV', '864768LA', '865061CR', '86606KAN', '869317AE', '880541DB', '882668BN', '887802FJ', '890346HD', '890346HE', '895130XY', '903592AP', '914029X2', '914115RK', '91417KCZ', '91417KDC', '91417KDD', '915137SW', '915137SX', '915137SY', '915137SZ', '915137TB', '917763PB', '921645LR', '921730DT', '928844DX', '930445AQ', '938597AV', '939741PG', '939745D6', '93974A7J', '93974A7K', '93974A7L', '93974A7Q', '93974A7T', '93974A7U', '93974AP7', '93974ATU', '93974ATV', '93974ATZ', '93978ERG', '93978RAB', '93978RAP', '93978RAQ', '939830LR', '952530WT', '956553QQ', '956553QS', '958697AW', '958697BY', '971736FB', '975672Q2', '97830EBD', '981305ZJ', '989013BA')


QUERY FOR EXAMPLE CUSIPS FOR PREF ZEROS
SELECT DISTINCT A.ISSUER_ID_C, A.ISSUE_ALPHA_C, B.PREF_TYPE_C, B.PRICE_P, B.CAV_I
FROM KBS.TISSUE_REF A, KBS.TPREREFUNDED_REF B  
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND B.PREF_TYPE_C = 'PREF'
AND (B.PRICE_P IS NOT NULL OR B.CAV_I IS NOT NULL)
AND A.COUPON_ORGL_P = 0
AND EXISTS (SELECT DISTINCT OFFERING_ID_C 
FROM KBS.TINFO_SOURCE C 
WHERE C.OFFERING_ID_C=A.OFFERING_ID_C 
AND C.INFO_SOURCE_C= 'OFST')
AND ROWNUM < 3000
ORDER BY 1,2 ASC NULLS LAST




QUERY FOR EXAMPLE CUSIPS FOR PREF VARIABLES (2009-2012)
SELECT DISTINCT A.ISSUER_ID_C, A.ISSUE_ALPHA_C, C.DATED_D AS DTD, B.PREF_D AS PREF_DATE, A.COUPON_ORGL_P AS COUPON, B.PREF_TYPE_C AS PREF_TYPE, D.OTL_LINE_NUMBER_C, D.OTL_TEXT_T
FROM KBS.TISSUE_REF A, KBS.TPREREFUNDED_REF B, KBS.TISSUING_REF C, KBS.TISSUING_OTL D  
WHERE A.ISSUING_ID_C = B.ISSUING_ID_C
AND A.ISSUING_ID_C = C.ISSUING_ID_C
AND A.ISSUING_ID_C = D.ISSUING_ID_C
AND B.PREF_TYPE_C = 'PREF'
AND EXISTS (SELECT DISTINCT ISSUING_ID_C, OTL_ID_C
FROM KBS.TISSUING_OTL 
WHERE OTL_ID_C='43' AND A.ISSUING_ID_C=ISSUING_ID_C)
AND EXISTS (SELECT DISTINCT ISSUING_ID_C, OTL_ID_C
FROM KBS.TISSUING_OTL 
WHERE OTL_ID_C='48' AND A.ISSUING_ID_C=ISSUING_ID_C)
AND C.DATED_D BETWEEN TO_DATE('01/01/2009','MM/DD/YYYY') AND TO_DATE('01/01/2012','MM/DD/YYYY')
AND EXISTS (SELECT DISTINCT OFFERING_ID_C 
FROM KBS.TINFO_SOURCE X
WHERE X.OFFERING_ID_C=A.OFFERING_ID_C 
AND X.INFO_SOURCE_C= 'OFST')
AND ROWNUM < 3000
ORDER BY 1,2,7 ASC NULLS LAST



ALL REFUNDED CUSIPS IN A SPECIFIED TIME RANGE
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, B.OFFERING_ID_C, B.ISSUING_ID_C, F.ADDED_Z 
FROM KBS.TINST_REF A, KBS.TISSUE_REF B, KBS.TCALLED_ISSUE C, KBS.TISSUING_OTL D, KBS.TCALLED_BOND E, KBS.TPREREFUNDED_REF F
WHERE A.INST_ID_C=B.INST_ID_C
AND B.ISSUER_ID_C=C.ISSUER_ID_C
AND B.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C
AND B.ISSUING_ID_C=D.ISSUING_ID_C
AND C.FEATURE_ID_C=E.FEATURE_ID_C
AND B.ISSUING_ID_C=F.ISSUING_ID_C
AND F.ADDED_Z > TO_DATE('01/01/2012', 'MM/DD/YYYY')
AND B.ISSUING_ID_C IN (SELECT DISTINCT ISSUING_ID_C 
FROM KBS.TISSUING_OTL O 
WHERE O.ISSUING_ID_C=B.ISSUING_ID_C 
AND O.OTL_ID_C ='93')
ORDER BY 1 ASC NULLS LAST


ALL REFUNDING DEALS 
TRIM(COMMENT_LINE_T) LIKE '%PROCEEDS%' AND TRIM(COMMENT_LINE_T) LIKE '%USED TO%'
 AND ADDED_Z > TO_TIMESTAMP('1/1/12 ','FMMMFM/FMDDFM/YY ')



ISSUER NAME FROM OFFERING #
SELECT DISTINCT C.OFFERING_ID_C AS OFFERING_ID, A.ISSUER_DESC_T AS ISSUER
FROM KBS.TISSUER_REF A, KBS.TISSUE_REF C, KBS.TOFFERING_REF E
WHERE A.ISSUER_ID_C=C.ISSUER_ID_C
AND C.OFFERING_ID_C=E.OFFERING_ID_C
AND (C.OFFERING_ID_C IN ()
ORDER BY 1 ASC NULLS LAST

CUSIPS WHERE LIQF EXP IS PAST DUE
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, B.MATURITY_D, A.SECURITY_TYPE_C, C.CRDT_ENHMT_TYPE_C, C.CRDT_ENHMT_END_D
FROM KBS.TISSUING_REF A, KBS.TISSUE_REF B, KBS.TCRDT_ENHMT_REF C
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C
AND A.SECURITY_TYPE_C = 'SHFL'
AND B.MATURITY_D > (SYSDATE)
AND C.CRDT_ENHMT_TYPE_C = 'LIQF'
AND C.CRDT_ENHMT_END_D < TO_DATE('06/17/2013', 'MM/DD/YYYY')



DEALS NOT UPDATED BY OFST
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.OFFERING_ID_C, A.ISSUING_ID_C, B.SECURITY_TYPE_C AS SEC_TYPE, B.DATED_D, A.MATURITY_D, A.COUPON_ORGL_P AS COUPON  
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND B.SECURITY_TYPE_C IN ('BOND', 'NOTE')
AND B.DATED_D > TO_DATE('01/01/2000','MM/DD/YYYY') 
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND NOT EXISTS (
SELECT DISTINCT OFFERING_ID_C 
FROM KBS.TINFO_SOURCE X 
WHERE X.OFFERING_ID_C=A.OFFERING_ID_C 
AND X.INFO_SOURCE_C= 'OFST')
ORDER BY 1 ASC NULLS LAST


IPD-PTC QUERY FOR GARY/JAMES (PRODUCT DATABASE)
SELECT DISTINCT A.CUSIP9, B.QSIP_DATED_DATE, B.QSIP_MATURITY_DATE, A.CALL_PAR_DATE, B.QSIP_COUPON_RATE, C.ISSU_REOFFERING_YIELD, C.ISSU_PTC_OFFERING_YIELD, C.ISSU_PTC_OFFERING_PRICE
FROM MASTER_REF.SPSE_CALLREC_CA A, MASTER_REF.SPSE_CUSIPREC_QS B, MASTER_REF.SPSE_ISSUEDETAIL_IS C, MASTER_REF.SPSE_OFFERINGREC_OF D 
WHERE A.CUSIP9=B.CUSIP9
AND A.CUSIP9=C.CUSIP9
AND A.CUSIP9=D.CUSIP9
AND D.OFFR_INSTITUTION_TYPE = 'MUNI'
AND B.QSIP_DATED_DATE > TO_DATE('01/01/2012','MM/DD/YYYY')
AND B.QSIP_MATURITY_DATE > TO_DATE('07/01/2013','MM/DD/YYYY')
AND B.QSIP_TERM_SERIAL_IND IN ('S', 'T')
AND B.QSIP_COUPON_RATE > C.ISSU_REOFFERING_YIELD
AND B.QSIP_COUPON_RATE <> 0
AND C.ISSU_REOFFERING_YIELD <> 0
AND C.ISSU_PTC_OFFERING_YIELD IS NULL
AND C.ISSU_PTC_OFFERING_PRICE IS NULL
AND B.QSIP_MATURITY_DATE > A.CALL_PAR_DATE
ORDER BY 2 DESC NULLS LAST

SELECT DISTINCT A.ISSUER_ID_C, A.ISSUE_ALPHA_C, D.DATED_D, A.MATURITY_D, B.OTL_TEXT_T, A.COUPON_ORGL_P, A.OFFERING_YIELD_P, A.PTC_OFFERING_YIELD_P, A.PTC_OFFERING_PRICE_P
FROM KBS.TISSUE_REF A, KBS.TISSUING_OTL B, KBS.TINST_REF C, KBS.TISSUING_REF D 
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.INST_ID_C=C.INST_ID_C
AND A.ISSUING_ID_C=D.ISSUING_ID_C
AND C.INST_TYPE_C = 'MUNI'
AND D.DATED_D > TO_DATE('01/01/2012','MM/DD/YYYY')
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND A.COUPON_ORGL_P > A.OFFERING_YIELD_P
AND A.COUPON_ORGL_P <> 0
AND A.OFFERING_YIELD_P <> 0
AND B.OTL_TEXT_T LIKE 'CAL%'
AND A.PTC_OFFERING_PRICE_P IS NULL
AND A.PTC_OFFERING_YIELD_P IS NULL
AND EXISTS (SELECT DISTINCT ISSUING_ID_C, OTL_ID_C
FROM KBS.TISSUING_OTL 
WHERE D.ISSUING_ID_C=ISSUING_ID_C
AND OTL_ID_C='48')
ORDER BY 3 DESC NULLS LAST



PSFG QUERY TO FIND PREF CUSIPS THAT HAVE ACTIVE PSFG
SELECT DISTINCT CONCAT(D.ISSUER_ID_C, D.ISSUE_ALPHA_C) AS CUSIP, C.ISSUING_ID_C, G.PREF_D, C.ADDED_BY_C, C.ADDED_Z, F.OTL_TEXT_T
FROM KBS.TINST_REF A, KBS.TCRDT_ENHMT_INST B, KBS.TCRDT_ENHMT_REF C, KBS.TISSUE_REF D, KBS.TISSUING_REF E, KBS.TISSUING_OTL F, KBS.TPREREFUNDED_REF G
WHERE A.INST_ID_C=B.INST_ID_C
AND B.CRDT_ENHMT_ID_C=C.CRDT_ENHMT_ID_C
AND C.ISSUING_ID_C=D.ISSUING_ID_C 
AND D.ISSUING_ID_C=E.ISSUING_ID_C 
AND C.ISSUING_ID_C=F.ISSUING_ID_C
AND C.ISSUING_ID_C=G.ISSUING_ID_C
AND A.INST_N = 'PERMANENT SCHOOL FUND GUARANTY'
AND C.CRDT_ENHMT_EXP_C <> 'EXPIRE'
AND F.OTL_ID_C='93'
AND D.MATURITY_D > (SYSDATE)
ORDER BY 1 ASC NULLS LAST


SCHOL CREDIT ENHANCEMENTS- DISPLAY CC6 AND REPORTING ENTITY
SELECT DISTINCT  A.INST_ID_C, A.INST_N AS CREDIT_ENHANCEMENT, A.INST_CC6 AS CC6, A1.ISSUER_DESC_T
FROM KBS.TINST_REF A, KBS.TISSUER_REF A1 
WHERE A.INST_CC6 = A1.ISSUER_ID_C
AND A.INST_ID_C IN (335591, 501351, 335555, 335597, 335590, 335557, 335558, 118618, 335559, 336392, 335554, 335562, 335569, 335567, 335574, 335575, 335576, 335573, 335577, 335568, 335564, 335586, 568632, 335563, 335579, 335592, 335588, 450091, 335553, 336286, 118617, 335580, 335560, 335581)
ORDER BY 2 ASC NULLS LAST


ZERO CPN BONDS WITH FIRST CPN DATE POPULATED
SELECT DISTINCT A.ISSUER_ID_C, A.ISSUE_ALPHA_C, D.DATED_D, A.MATURITY_D, A.COUPON_ORGL_P, B.PAYMENT_FIRST_D, C.INST_TYPE_C
FROM KBS.TISSUE_REF A, KBS.TINT_PAY_CYCLE B, KBS.TINST_REF C , KBS.TISSUING_REF D 
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.INST_ID_C=C.INST_ID_C
AND A.ISSUING_ID_C=D.ISSUING_ID_C
AND C.INST_TYPE_C = 'MUNI'
AND A.MATURITY_D > (SYSDATE)
AND A.COUPON_ORGL_P = 0
AND A.MATURITY_TYPE_C <> '*'
AND B.PAYMENT_FIRST_D IS NOT NULL
ORDER BY 1,2 ASC NULLS LAST


SELECT DISTINCT  A.INST_ID_C, A.INST_N AS CREDIT_ENHANCEMENT, A.INST_CC6 AS CC6, A1.ISSUER_DESC_T
FROM KBS.TINST_REF A, KBS.TISSUER_REF A1 
WHERE A.INST_CC6 = A1.ISSUER_ID_C (+)
AND A.INST_ID_C IN (92384, 647718, 647748, 647499, 647715, 548878, 647156, 647683, 647716, 646938, 439754, 647872, 647859, 646822, 646752, 647058, 647525, 647388, 647383, 643337, 643339, 647739, 646661, 646921, 647940, 350070, 568796, 647158, 647747, 647080, 647967, 535197, 647735, 588921, 647056, 433713, 513985, 513986, 513989, 513987, 486676, 647522, 646763, 647057, 534680, 647616, 557725, 647434, 647949, 647537, 647541, 350864, 647722, 647500, 642861, 643309, 536049, 642649, 646858, 351494, 647508, 647430, 647708, 647751, 573464, 647552, 399085, 452230, 646672, 647181, 647723, 538857, 647054, 647205, 647786, 647617, 647059, 647062, 646117, 387518, 646203, 647484, 422398, 647501, 647758, 647602, 647585, 642965, 513991, 647756, 647755, 477383, 646841, 572041, 449568, 548117, 522560, 647921, 646393, 646563, 647045, 646553, 371579, 647431, 646838, 563933, 646205, 376802, 647710, 368770, 646261, 391878, 647568, 642806, 519420, 643328, 647492, 647709, 643195, 647535, 351309, 646217, 329350, 559947, 531682, 440684, 409009, 500535, 646616, 647571, 448447, 368112, 348812, 384306, 647051, 506276, 507672, 521461, 363261, 647724, 643093, 647579, 613207, 646181, 438253, 360554, 415618, 492844, 647536, 448775, 373154, 646917, 646916, 547914, 477526, 506273, 549103, 444570, 646720, 349754, 647874, 647934, 449018, 512711, 642798, 642799, 533782, 506316, 647966, 601727, 647505, 642767, 647964, 445897, 647060, 647850, 504525, 551647, 458346, 442652, 647212, 642772, 481025, 370321, 647624, 647740, 647582, 516164, 647538, 647029, 642940, 362523, 401076, 499884, 647359, 647361, 647435, 409779, 540373, 368146, 647599, 613211, 646748, 646271, 452038, 647902, 506312, 416514, 413058, 551549, 538183, 508405, 447570, 643271, 647727, 368339, 359005, 647677, 647482, 372955, 647053, 560167, 564747, 646876, 643314, 641659, 642805, 588865, 645927, 648194, 451831, 646625, 540078, 648190, 371529, 511311, 479736, 646615, 648022, 373669, 383157, 477493, 447694, 477297, 647606, 392842, 388789, 647750, 647766)



OBLI INSTITUTIONS CREATED BY AO TEAMS
SELECT DISTINCT  A.*
FROM KBS.TINST_REF A, KBS.TISSUER_REF A1 
WHERE A.INST_CC6 = A1.ISSUER_ID_C (+)
AND A.INST_TYPE_C= 'CORP'
AND A.STATE_INCORP_1_C <> 'CB'
AND A.ADDED_Z > TO_DATE('11/01/2012', 'MM/DD/YYYY')
AND A.INST_CATEGORY_C = 'OBLI'
AND (A.ADDED_BY_C = 'KI637'
OR A.ADDED_BY_C = 'KI618'
OR A.ADDED_BY_C = 'KI607'
OR A.ADDED_BY_C = 'KI534' 
OR A.ADDED_BY_C = 'KI588' 
OR A.ADDED_BY_C = 'KI541' 
OR A.ADDED_BY_C = 'KI555' 
OR A.ADDED_BY_C = 'KI572' 
OR A.ADDED_BY_C = 'KI549' 
OR A.ADDED_BY_C = 'KI585' 
OR A.ADDED_BY_C = 'KI576' 
OR A.ADDED_BY_C = 'KI535' 
OR A.ADDED_BY_C = 'KI537'
OR A.ADDED_BY_C = 'KI538' 
OR A.ADDED_BY_C = 'KI533' 
OR A.ADDED_BY_C = 'KI531' 
OR A.ADDED_BY_C = 'KI530' 
OR A.ADDED_BY_C = 'KI536' 
OR A.ADDED_BY_C = 'KI532' 
OR A.ADDED_BY_C = 'KI590' 
)
ORDER BY 3 ASC NULLS LAST


LIST OF ALL MAKE WHOLE CALLS (MUNI & CORP ONLY)
SELECT DISTINCT A.ISSUER_ID_C, A.ISSUE_ALPHA_C, D.INST_TYPE_C, C.SPEC_TYPE_C
FROM KBS.TISSUE_REF A, KBS.TFEATURE_XREF B, KBS.TSPEC_REDEM C, KBS.TINST_REF D
WHERE A.ISSUE_ID_C=B.ISSUE_ID_C
AND B.FEATURE_ID_C=C.FEATURE_ID_C
AND A.INST_ID_C=D.INST_ID_C
AND C.SPEC_TYPE_C = 'MWH'
AND D.INST_TYPE_C IN ('MUNI','CORP')


CHECK SPECIFIC CUSIPS TO SEE IF PSFG EXISTS ON PREF CUSIPS
SELECT DISTINCT C.ISSUING_ID_C, B.OFFERING_ID_C, A.INST_N, A.INST_ID_C, C.CRDT_ENHMT_EXP_C, E.DATED_D, B.MATURITY_D, C.MODIFIED_BY_C, C.MODIFIED_Z, X.OTL_TEXT_T
FROM KBS.TINST_REF A, KBS.TCRDT_ENHMT_INST D, KBS.TCRDT_ENHMT_REF C, KBS.TISSUE_REF B, KBS.TISSUING_REF E, KBS.TISSUING_OTL X
WHERE A.INST_ID_C=D.INST_ID_C
AND D.CRDT_ENHMT_ID_C=C.CRDT_ENHMT_ID_C
AND C.ISSUING_ID_C=B.ISSUING_ID_C 
AND B.ISSUING_ID_C=E.ISSUING_ID_C 
AND C.ISSUING_ID_C=X.ISSUING_ID_C
AND A.INST_N = 'PERMANENT SCHOOL FUND GUARANTY'
AND C.CRDT_ENHMT_EXP_C <> 'EXPIRE'
AND X.OTL_ID_C='93'
AND B.OFFERING_ID_C = 606713
ORDER BY 8,2 ASC NULLS LAST




SELECT DISTINCT B.ISSUER_ID_C, B.ISSUE_ALPHA_C, C.ISSUING_CUSIP_T, A.OTL_TEXT_T
FROM KBS.TISSUING_OTL A, KBS.TISSUE_REF B, KBS.TISSUING_REF C
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C (+)
AND A.ISSUING_ID_C=C.ISSUING_ID_C (+)
AND C.ISSUING_CUSIP_T LIKE '%-BAM-%'
AND ((A.OTL_ID_C = '48' AND A.OTL_TEXT_T NOT LIKE '%/#%') 
OR (NOT EXISTS (SELECT DISTINCT ISSUING_ID_C FROM KBS.TISSUING_OTL A WHERE OTL_ID_C ='48')))
ORDER BY 1,2 ASC NULLS LAST



SECONDARY INSD BAM CUSIPS THAT DON'T HAVE ORIG CUSIP ON 48 OTL OR DON'T HAVE 48 OTL AT ALL
SELECT DISTINCT B.ISSUER_ID_C, B.ISSUE_ALPHA_C, C.ISSUING_CUSIP_T
FROM KBS.TISSUE_REF B, KBS.TISSUING_REF C
WHERE B.ISSUING_ID_C=C.ISSUING_ID_C
AND C.ISSUING_CUSIP_T LIKE '%-BAM-%'
AND ((NOT EXISTS (SELECT DISTINCT ISSUING_ID_C 
FROM KBS.TISSUING_OTL 
WHERE C.ISSUING_ID_C=ISSUING_ID_C 
AND OTL_ID_C='48'))
OR (EXISTS (SELECT DISTINCT ISSUING_ID_C 
FROM KBS.TISSUING_OTL 
WHERE C.ISSUING_ID_C=ISSUING_ID_C 
AND OTL_ID_C='48'
AND OTL_TEXT_T NOT LIKE '%#%')))


CUSIPS THAT HAVE MDY & MDE RTGS, BUT NOT MDU & HAVE PRIMARY INSURANCE
SELECT DISTINCT A.ISSUER_ID_C, A.ISSUE_ALPHA_C, G.INST_N, C.CRDT_RATG_AGNCY_C, C.CRDT_RATE_C
FROM KBS.TISSUE_REF A, KBS.TINST_REF B, KBS.TISSUE_CRDT_RATING C, KBS.TCRDT_ENHMT_REF E, KBS.TCRDT_ENHMT_INST F, KBS.TINST_REF G 
WHERE A.INST_ID_C=B.INST_ID_C
AND A.ISSUE_ID_C=C.ISSUE_ID_C (+)
AND A.ISSUING_ID_C=E.ISSUING_ID_C (+)
AND F.INST_ID_C=G.INST_ID_C 
AND E.CRDT_ENHMT_ID_C=F.CRDT_ENHMT_ID_C 
AND B.INST_TYPE_C = 'MUNI' 
AND E.CRDT_ENHMT_TYPE_C = 'INSN'
AND E.PRIM_SECONDARY_C = 'P'
AND C.CRDT_RATG_AGNCY_C IN ('MDY','MDE')
AND EXISTS(
SELECT DISTINCT 'MDY'
FROM KBS.TISSUE_REF A1, KBS.TISSUE_CRDT_RATING C1
WHERE A1.ISSUE_ID_C=C1.ISSUE_ID_C 
AND A1.MATURITY_D > (SYSDATE)
AND A1.MATURITY_TYPE_C <> '*'
AND C1.CRDT_RATG_AGNCY_C = 'MDY'
AND C1.CRDT_RATE_TYPE_C = 'L'
AND C1.CRDT_RATE_C IS NOT NULL
AND C1.CRDT_RATE_C <> 'N/R'
AND A1.ISSUE_ID_C=A.ISSUE_ID_C
)
AND EXISTS (
SELECT DISTINCT 'MDE' 
FROM KBS.TISSUE_CRDT_RATING MDE 
WHERE MDE.ISSUE_ID_C=A.ISSUE_ID_C 
AND MDE.CRDT_RATG_AGNCY_C = 'MDE'
)
AND NOT EXISTS (
SELECT DISTINCT 'MDU' 
FROM KBS.TISSUE_CRDT_RATING MDU 
WHERE MDU.ISSUE_ID_C=A.ISSUE_ID_C 
AND MDU.CRDT_RATG_AGNCY_C = 'MDU'
)
ORDER BY 1,2 ASC, 4 DESC NULLS LAST



GARY—APPROXIMATE SETTLE DATE & FINAL SOURCE WORKED ON
SELECT DISTINCT F.SETTLMNT_D, E.DATED_D, G.INFO_SOURCE_C , A.ISSUER_ID_C,, A.ISSUE_ALPHA_C, D.ISSUER_DESC_T AS ISSUER, G.UNDWRTR_N
FROM KBS.TISSUE_REF A, KBS.TINST_REF B, KBS.TISSUER_REF D, KBS.TISSUING_REF E, KBS.TOFFERING_REF F, KBS.TINFO_SOURCE G, KBS.TUNDERWRITER_REF G 
WHERE A.INST_ID_C=B.INST_ID_C
AND A.INST_ID_C=D.INST_ID_C
AND A.INST_ID_C=G.INST_ID_C
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND A.OFFERING_ID_C=F.OFFERING_ID_C
AND A.ISSUER_ID_C=F.ISSUER_ID_C
AND F.UNDWRTR_ID_C=G.UNDWRTR_ID_C
AND B.INST_TYPE_C = 'MUNI'
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND F.SETTLMNT_STATUS_C = 'A'
AND Z.INFO_SOURCE_C IN ('OFST', 'KIS', 'DALFP')
ORDER BY 4,5 ASC NULLS LAST



DERIVATIVE CUSIPS ADDED TO MB ON A SPECIFIED DATE—DATE TRUNC
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, A.DATED_D, C.INST_N AS ISSUER, A.ISSUING_CUSIP_T AS ISSUING_DESC, A.SECURITY_TYPE_C, E.UNDWRTR_N, C.INST_TYPE_C, B.ADDED_Z
FROM KBS.TISSUING_REF A, KBS.TISSUE_REF B, KBS.TINST_REF C, KBS.TOFFERING_REF D, KBS.TUNDERWRITER_REF E
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND B.INST_ID_C=C.INST_ID_C
AND B.OFFERING_ID_C=D.OFFERING_ID_C
AND D.UNDWRTR_ID_C=E.UNDWRTR_ID_C
AND A.SECURITY_TYPE_C IN ('SHFL','INVF','LINK')
AND TRUNC(B.ADDED_Z) = TO_DATE('8/16/13','MM/DD/YY') 
ORDER BY 1 ASC NULLS LAST

CHECK CUSIPS FOR UW, DTD, ISSUER, ISS DESC FOR MISSING OS'S
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, B.OFFERING_ID_C AS OFFERING, A.DATED_D AS DTD, B.MATURITY_D AS MATURITY, E.UNDWRTR_N AS UNDERWRITER , C.ISSUER_DESC_T AS ISSUER, A.ISSUING_CUSIP_T AS ISSUING_DESC
FROM KBS.TISSUING_REF A, KBS.TISSUE_REF B, KBS.TISSUER_REF C, KBS.TOFFERING_REF D, KBS.TUNDERWRITER_REF E
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND B.INST_ID_C=C.INST_ID_C
AND B.OFFERING_ID_C=D.OFFERING_ID_C
AND D.UNDWRTR_ID_C=E.UNDWRTR_ID_C
AND ((B.ISSUER_ID_C = '951781' AND B.ISSUE_ALPHA_C = 'AB')
OR (B.ISSUER_ID_C = '92511Q' AND B.ISSUE_ALPHA_C = 'BL')
OR (B.ISSUER_ID_C = '92511Q' AND B.ISSUE_ALPHA_C = 'BB')
OR (B.ISSUER_ID_C = '547856' AND B.ISSUE_ALPHA_C = 'AT')
OR (B.ISSUER_ID_C = '746600' AND B.ISSUE_ALPHA_C = 'BL')
OR (B.ISSUER_ID_C = '80377B' AND B.ISSUE_ALPHA_C = 'DH')
OR (B.ISSUER_ID_C = '805020' AND B.ISSUE_ALPHA_C = 'DK')
OR (B.ISSUER_ID_C = '894232' AND B.ISSUE_ALPHA_C = 'AA'))
ORDER BY 1 ASC NULLS LAST


GARY-CUSIPS WHERE CPN, YIELD, PRICE, OR COMPOUND YIELD IS NEGATIVE (< 0)
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C), A.COUPON_ORGL_P AS COUPON, A.OFFERING_YIELD_P AS YIELD, A.OFFERING_PRICE_P AS PRICE, A.COMPOUND_YIELD_P AS COMPOUNDING_YIELD 
FROM KBS.TISSUE_REF A
WHERE A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND (A.COUPON_ORGL_P < 0
OR A.OFFERING_YIELD_P < 0
OR A.OFFERING_PRICE_P < 0
OR A.COMPOUND_YIELD_P < 0)

GARY-INSTITUTIONS THAT HAVE BOTH MUNI AND CORP CUSIPS IN THEM
SELECT DISTINCT A.INST_ID_C, A.INST_N
FROM KBS.TINST_REF A
WHERE EXISTS(
SELECT DISTINCT 'MUNI'
FROM KBS.TINST_REF A1
WHERE A1.INST_ID_C = A.INST_ID_C
AND A1.INST_TYPE_C = 'MUNI')
AND EXISTS (
SELECT DISTINCT 'CORP' 
FROM KBS.TINST_REF A2 
WHERE A2.INST_ID_C = A.INST_ID_C
AND A2.INST_TYPE_C = 'CORP')


SAL-IDENTIFY ALL CCA'S
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C), B.OTL_TEXT_T
FROM KBS.TISSUE_REF A, KBS.TISSUING_OTL B
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND B.OTL_TEXT_T LIKE 'CCA%'


SAL-DEALS DATED 1/1/1930
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, A.SECURITY_TYPE_C, C.INST_TYPE_C , F.ISSUER_DESC_T AS ISSUER, A.ISSUING_CUSIP_T AS ISSUING_DESC, B.ADDED_Z
FROM KBS.TISSUING_REF A, KBS.TISSUE_REF B, KBS.TINST_REF C, KBS.TOFFERING_REF D, KBS.TUNDERWRITER_REF E, KBS.TISSUER_REF F
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND B.INST_ID_C=C.INST_ID_C
AND B.OFFERING_ID_C=D.OFFERING_ID_C
AND D.UNDWRTR_ID_C=E.UNDWRTR_ID_C
AND B.ISSUER_ID_C=F.ISSUER_ID_C
AND B.MATURITY_D > (SYSDATE)
AND B.MATURITY_TYPE_C <> '*'
AND A.DATED_D = TO_DATE('01/01/1930','MM/DD/YYYY') 
ORDER BY 1 ASC NULLS LAST


KARI-APPROPRIATIONS CUSIPS
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, A.DATED_D, B.MATURITY_D, A.PURP_TYPE_C AS PURP, A.PURP_CLASS_C AS CLASS, A.PURP_SUB_CLASS_C AS SUBCL, D.ISSUER_DESC_T AS ISSUER, A.ISSUING_CUSIP_T AS ISSUING_DESC, E.CRDT_ENHMT_TYPE_C AS ROLE_CODE, G.INST_N AS OBLIGOR , G.INST_CC6 AS CC6, D1.ISSUER_DESC_T AS CC6_INST 
FROM KBS.TISSUING_REF A, KBS.TISSUE_REF B, KBS.TISSUER_REF D,KBS.TINST_REF G,
KBS.TCRDT_ENHMT_REF E, KBS.TCRDT_ENHMT_INST F, KBS.TISSUER_REF D1
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND B.ISSUER_ID_C=D.ISSUER_ID_C (+)
AND A.ISSUING_ID_C=E.ISSUING_ID_C (+)
AND E.CRDT_ENHMT_ID_C=F.CRDT_ENHMT_ID_C (+)
AND F.INST_ID_C=G.INST_ID_C (+)
AND G.INST_CC6 = D1.ISSUER_ID_C (+)
AND 'BPA' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'CLC' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'CLL' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'GIC' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'INSN' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'LIQF' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'LOC' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'SLC' <> E.CRDT_ENHMT_TYPE_C (+) 
AND 'SYB' <> E.CRDT_ENHMT_TYPE_C (+)
AND B.MATURITY_D > (SYSDATE)
AND B.MATURITY_TYPE_C <> '*'
AND G.INST_N LIKE '% APPROPRIATION%'
ORDER BY 1 ASC NULLS LAST


QUERY TO GET ANY NON-MUNI SECURITY TYPES TO CHANGE CATEGORY
SELECT DISTINCT A.INST_ID_C, CONCAT(C.ISSUER_ID_C, C.ISSUE_ALPHA_C) AS CUSIP, D.SECURITY_TYPE_C, D.ISSUING_ID_C, C.OFFERING_ID_C
FROM KBS.TINST_REF A, KBS.TISSUER_REF B, KBS.TISSUE_REF C, KBS.TISSUING_REF D 
WHERE A.INST_ID_C = B.INST_ID_C
AND A.INST_ID_C = C.INST_ID_C
AND C.ISSUING_ID_C=D.ISSUING_ID_C
AND C.ISSUER_ID_C IS NOT NULL
AND A.INST_CATEGORY_C = 'GUAR'
AND D.SECURITY_TYPE_C NOT IN ('BOND', 'NOTE', 'MTN', 'DEB', 'INVF', 'SHFL', 'TR', 'PAYS', 'LINK', 'OPTN', 'CP')
AND A.INST_ID_C = 8553
ORDER BY 1 ASC NULLS LAST


QUERY TO GET ISSUER INSTITUTIONS WITH CATEGORY=GUAR
SELECT DISTINCT A.INST_ID_C, B.ISSUER_ID_C, B.ISSUER_DESC_T
FROM KBS.TINST_REF A, KBS.TISSUER_REF B, KBS.TISSUE_REF C
WHERE A.INST_ID_C = B.INST_ID_C
AND A.INST_ID_C = C.INST_ID_C
AND A.INST_CATEGORY_C = 'GUAR'
ORDER BY 1 ASC NULLS LAST

FARHANA-LIST OF ALL DEFAULT CUSIPS IN MB
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, E.DATED_D AS DATED_DATE, A.MATURITY_D AS MATURITY_DATE, B.DEFAULT_TYPE_C, B.DEFAULT_D AS DEFAULT_DATE, B.CURRENT_D AS CURRENT_DATE 
FROM KBS.TISSUE_REF A, KBS.TDEFAULTS B, KBS.TFEATURE_REF C, KBS.TFEATURE_XREF D, KBS.TISSUING_REF E
WHERE A.ISSUE_ID_C = D.ISSUE_ID_C
AND C.FEATURE_ID_C = D.FEATURE_ID_C
AND B.FEATURE_ID_C = D.FEATURE_ID_C
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND B.DEFAULT_TYPE_C IN ('TDFL', 'DFLT')
AND B.DEFAULT_D IS NOT NULL
AND A.MATURITY_TYPE_C <> '*'
AND A.MATURITY_D > (SYSDATE)
AND B.DEFAULT_D > TO_DATE('01/01/1990','MM/DD/YYYY')
AND A.ISSUER_ID_C NOT IN ('006481', '006996', '00699C', '00699D', '00699B', '006997', '006480', '006999', '006994', '00699A', '006990', '006991', '00699G')
ORDER BY 5 DESC NULLS LAST




FARHANA-LIST OF ALL TECH DEFAULT CUSIPS IN MB
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, E.DATED_D AS DATED_DATE, A.MATURITY_D AS MATURITY_DATE, B.DEFAULT_TYPE_C, B.DEFAULT_D AS DEFAULT_DATE
FROM KBS.TISSUE_REF A, KBS.TDEFAULTS B, KBS.TFEATURE_REF C, KBS.TFEATURE_XREF D, KBS.TISSUING_REF E
WHERE A.ISSUE_ID_C = D.ISSUE_ID_C
AND C.FEATURE_ID_C = D.FEATURE_ID_C
AND B.FEATURE_ID_C = D.FEATURE_ID_C
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND B.DEFAULT_TYPE_C = 'TDFL'
AND B.DEFAULT_D IS NOT NULL
AND A.MATURITY_TYPE_C <> '*'
AND A.MATURITY_D > (SYSDATE)
AND B.DEFAULT_D > TO_DATE('01/01/1990','MM/DD/YYYY')
AND A.ISSUER_ID_C NOT IN ('006481', '006996', '00699C', '00699D', '00699B', '006997', '006480', '006999', '006994', '00699A', '006990', '006991', '00699G')
ORDER BY 5 DESC NULLS LAST



JANICE-7 MANDATORY FIELDS PLUS FEW OTHERS- 10/17/13
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.COUPON_ORGL_P AS COUPON, A.MATURITY_D AS MATURITY, B.PAYMENT_FIRST_D AS FC_DATE, C.OTL_TEXT_T AS CALL_OTL, D1.CRDT_RATE_C AS MDY_RATING, D1.CRDT_RATE_TYPE_C AS MDY_TYPE, D2.CRDT_RATE_C AS SP_RATING, D2.CRDT_RATE_TYPE_C AS SP_TYPE, D3.CRDT_RATE_C AS FTH_RATING, D3.CRDT_RATE_TYPE_C AS FTH_TYPE, B.FREQ_PERIOD_C AS INT_PAY_FREQ, E.ACCRUAL_COUNT_C AS DAY_COUNT, A.INT_MULT_DENOM_3_M AS DENOM, A.ISSUE_ORGL_M AS ISSUE_AMNT, A.ISSUE_OTSD_M AS OUTSTANDING_AMNT
FROM KBS.TISSUE_REF A, KBS.TINT_PAY_CYCLE B, KBS.TISSUING_OTL C, KBS.TISSUE_CRDT_RATING D1, KBS.TISSUE_CRDT_RATING D2, KBS.TISSUE_CRDT_RATING D3, KBS.TISSUING_REF E
WHERE A.ISSUING_ID_C = B.ISSUING_ID_C (+)
AND A.ISSUING_ID_C = C.ISSUING_ID_C (+)
AND A.ISSUE_ID_C=D1.ISSUE_ID_C (+)
AND A.ISSUE_ID_C=D2.ISSUE_ID_C (+)
AND A.ISSUE_ID_C=D3.ISSUE_ID_C (+)
AND A.ISSUING_ID_C=E.ISSUING_ID_C (+)
AND '48' = C.OTL_ID_C (+)
AND 'MDY' = D1.CRDT_RATG_AGNCY_C (+)
AND 'SP'= D2.CRDT_RATG_AGNCY_C (+)
AND 'FTH'= D3.CRDT_RATG_AGNCY_C (+)

AND ((A.ISSUER_ID_C = '00344N' AND A.ISSUE_ALPHA_C = 'FW')
OR (A.ISSUER_ID_C = '00344N' AND A.ISSUE_ALPHA_C = 'FX')
OR (A.ISSUER_ID_C = '00344N' AND A.ISSUE_ALPHA_C = 'FY')
OR (A.ISSUER_ID_C = '00344N' AND A.ISSUE_ALPHA_C = 'FZ')
OR (A.ISSUER_ID_C = '00344N' AND A.ISSUE_ALPHA_C = 'GA')

ORDER BY 1 ASC NULLS LAST



EDI-FINDING COUNTRY CODE ISINS/CINS
SELECT DISTINCT A.ISIN, A.CRF_CINS, B.CNTRYOFINCORP 
FROM EDI.IDENTIFIER_XREF A,EDI.ISSUR B
WHERE A.ISSID=B.ISSID
AND B.CNTRYOFINCORP = 'AA'

EDI-FORN INSTITUTIONS WITH MULTIPLE ISSUERS, BLANK COUNTRY CODE & COUNTS
SELECT DISTINCT A.INST_ID_C, B.INST_N, COUNT(*) 
FROM KBS.TISSUER_REF A, KBS.TINST_REF B
WHERE A.INST_ID_C = B.INST_ID_C
AND B.INST_TYPE_C = 'FORN'
AND B.COUNTRY_ID_C = '  '
GROUP BY A.INST_ID_C, B.INST_N
HAVING COUNT(DISTINCT A.ISSUER_ID_C) > 1
ORDER BY A.INST_ID_C, B.INST_N


IPD-QC931
SELECT DISTINCT A.CUSIP9, A.INT_CURR_INTEREST_IND AS CURR_INT_IND, A.INT_CURR_INTEREST_DATE AS CURR_DATE
FROM MASTER_REF.SPSE_INTPAY_IN A, MASTER_REF.SPSE_CUSIPREC_QS B, MASTER_REF.SPSE_OFFERINGREC_OF C
WHERE A.CUSIP9=B.CUSIP9 
AND A.CUSIP9=C.CUSIP9
AND A.INT_CURR_INTEREST_DATE = (SYSDATE+1)
AND B.QSIP_MATURITY_DATE > (SYSDATE)
AND C.OFFR_INSTITUTION_TYPE = 'MUNI'


QC932-MB
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP8, A.ISSUING_ID_C, C.CALL_D AS CALL_DATE, B.PREF_D AS PREF_DATE, D.CALL_PRICE_L AS CALL_PRICE, B.PRICE_PCT_P AS PREF_PRICE, B.CAV_I AS CAV_IND
FROM KBS.TISSUE_REF A, KBS.TPREREFUNDED_REF B, KBS.TCALLED_BOND C, KBS.TCALLED_ISSUE D, KBS.TINST_REF E
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUER_ID_C=D.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=D.ISSUE_ALPHA_C
AND C.FEATURE_ID_C=D.FEATURE_ID_C
AND A.INST_ID_C=E.INST_ID_C
AND ((B.PRICE_PCT_P <> D.CALL_PRICE_L) OR (B.PREF_D <> C.CALL_D))
AND D.FULL_PART_CALL_C = 'FULL'
AND E.INST_TYPE_C = 'MUNI'


IPD-QC932
SELECT DISTINCT A.CUSIP9, A.NOTP_EVENT_TYPE AS TYPE, A.NOTP_EVENT_DATE AS CALL_DATE, B.PREF_DATE, A.NOTP_EVENT_PRICE AS CALL_PRICE, B.PREF_PRICE 
FROM MASTER_REF.SPSE_NOTIFPUB_NP A, MASTER_REF.SPSE_PREREFND_PR B, MASTER_REF.SPSE_OFFERINGREC_OF C
WHERE A.CUSIP9=B.CUSIP9
AND A.CUSIP9=C.CUSIP9
AND A.NOTP_EVENT_TYPE = 'CCAL'
AND ((A.NOTP_EVENT_PRICE <> B.PREF_PRICE) OR (A.NOTP_EVENT_DATE <> B.PREF_DATE))
AND C.OFFR_INSTITUTION_TYPE = 'MUNI'


QC933-MB
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP8, C.DATED_D AS DATED_DATE, A.OFFERING_ID_C AS OFFERING, E.OTL_TEXT_T AS OTL, B.ADDED_Z 
FROM KBS.TISSUE_REF A, KBS.TPREREFUNDED_REF B, KBS.TISSUING_REF C, KBS.TINST_REF D, KBS.TISSUING_OTL E
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUING_ID_C= C.ISSUING_ID_C
AND A.INST_ID_C=D.INST_ID_C
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND D.INST_TYPE_C = 'MUNI'
AND E.OTL_TEXT_T LIKE '%/F'
AND E.OTL_ID_C = '93'
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'


IPD-QC934
SELECT DISTINCT A.CUSIP9, D.QSIP_ISSUER_DESC, E.CALL_NEXT_PREM_DATE, E.CALL_FIRST_TYPE
FROM MASTER_REF.SPSE_PREREFND_PR A, MASTER_REF.SPSE_CUSIPREC_QS B, MASTER_REF.SPSE_OFFERINGREC_OF C, MASTER_REF.SPSE_CUSIPREC_QS D, MASTER_REF.SPSE_CALLREC_CA E
WHERE A.CUSIP9=B.CUSIP9 
AND A.CUSIP9=C.CUSIP9
AND A.CUSIP9=D.CUSIP9
AND A.CUSIP9=E.CUSIP9
AND A.PREF_METHOD = 'G'
AND A.PREF_TYPE IS NULL
AND E.CALL_FIRST_TYPE NOT IN ('NONC', 'NODN')
AND E.CALL_NEXT_PREM_DATE <= (SYSDATE + 45)
AND C.OFFR_INSTITUTION_TYPE = 'MUNI'
AND B.QSIP_MATURITY_DATE > (SYSDATE)



QC935-MB
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP8, A.OFFERING_ID_C AS OFFERING, C.ISSUING_ID_C AS ISSUING, C.DATED_D AS DATED_DATE, E.SETTLMNT_D AS SETTLEMENT_DATE, C.ISSUING_CUSIP_T AS ISSUING_DESC, C.SECURITY_TYPE_C 
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF C, KBS.TINST_REF D, KBS.TOFFERING_REF E
WHERE A.ISSUING_ID_C= C.ISSUING_ID_C
AND A.INST_ID_C=D.INST_ID_C
AND A.OFFERING_ID_C=E.OFFERING_ID_C
AND D.INST_TYPE_C = 'MUNI'
AND C.SECURITY_TYPE_C = 'FORW'
AND E.SETTLMNT_D <= (SYSDATE+ 60)
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'



QC936-SDM


GARY-TREASURY BONDS
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, D.ISSUER_DESC_T AS ISSUER, C.ISSUING_CUSIP_T AS ISSUER_DESC, B.OFFERING_ID_C, E1.CRDT_RATE_C AS SP_RTG, E1.CRDT_RATE_STATUS_C AS SP_STATUS, E2.CRDT_RATE_C AS SPU_RTG, E2.CRDT_RATE_STATUS_C AS SPU_STATUS , E3.CRDT_RATE_C AS SPE_RTG, E3.CRDT_RATE_STATUS_C AS SPE_STATUS
FROM KBS.TINST_REF A, KBS.TISSUE_REF B, KBS.TISSUING_REF C, KBS.TISSUER_REF D, KBS.TISSUE_CRDT_RATING E1, KBS.TISSUE_CRDT_RATING E2, KBS.TISSUE_CRDT_RATING E3
WHERE A.INST_ID_C=B.INST_ID_C
AND B.ISSUING_ID_C=C.ISSUING_ID_C
AND A.INST_ID_C=D.INST_ID_C
AND B.ISSUE_ID_C=E1.ISSUE_ID_C (+)
AND B.ISSUE_ID_C=E2.ISSUE_ID_C (+)
AND B.ISSUE_ID_C=E3.ISSUE_ID_C (+)
AND A.INST_TYPE_C = 'GOVT'
AND A.INST_SUBTYPE_C = 'TSY'
AND A.STATE_INCORP_1_C = 'US'
AND B.MATURITY_D > (SYSDATE)
AND B.MATURITY_TYPE_C <> '*'
AND 'SP' = E1.CRDT_RATG_AGNCY_C (+)
AND 'SPU' = E2.CRDT_RATG_AGNCY_C (+)
AND 'SPE' = E3.CRDT_RATG_AGNCY_C (+)
ORDER BY 1 ASC NULLS LAST


FARHANA-SEARCH FOR A SPECIFIC RATING FOR NON-MATURED, NON-PREF CUSIPS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, C.CRDT_RATG_AGNCY_C, C. CRDT_RATE_TYPE_C , C.CRDT_RATE_C
FROM KBS.TISSUE_REF A, KBS.TINST_REF B, KBS.TISSUE_CRDT_RATING C
WHERE A.INST_ID_C=B.INST_ID_C
AND A.ISSUE_ID_C=C.ISSUE_ID_C
AND B.INST_TYPE_C = 'MUNI' 
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND C.CRDT_RATE_C = 'C'
AND NOT EXISTS (SELECT DISTINCT ISSUING_ID_C, OTL_ID_C
FROM KBS.TISSUING_OTL 
WHERE A.ISSUING_ID_C=ISSUING_ID_C AND OTL_ID_C='93')


IVAN-
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.OFFERING_ID_C, D.ISSUER_DESC_T AS ISSUER, E.ISSUING_CUSIP_T AS ISSUING_DESC, A.COUPON_ORGL_P, C1.OTL_TEXT_T AS WEEKLY, C2.OTL_TEXT_T AS SEMI_ANNUAL FROM KBS.TISSUE_REF A, KBS.TINST_REF B, KBS.TISSUING_OTL C1, KBS.TISSUING_OTL C2, KBS.TISSUER_REF D, KBS.TISSUING_REF E WHERE A.ISSUING_ID_C=C1.ISSUING_ID_C AND A.ISSUING_ID_C=C2.ISSUING_ID_C
AND A.INST_ID_C=B.INST_ID_C
AND A.ISSUER_ID_C=D.ISSUER_ID_C
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND (B.INST_TYPE_C = 'CORP' OR B.INST_TYPE_C = 'FORN')
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND C1.OTL_ID_C='44'
AND C2.OTL_ID_C='44'
AND (A.COUPON_ORGL_P=0 OR A.COUPON_ORGL_P IS NULL)
AND ((C1.OTL_TEXT_T LIKE '%/WK*%')
OR (C2.OTL_TEXT_T LIKE '%/SA*%'))


FARHANA-DEFAULTS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, E.DATED_D AS DATED_DATE, A.MATURITY_D AS MATURITY_DATE, B.DEFAULT_TYPE_C, B.DEFAULT_D AS DEFAULT_DATE, B.CURRENT_D AS CURRENT_DATE
FROM KBS.TISSUE_REF A, KBS.TDEFAULTS B, KBS.TFEATURE_REF C, KBS.TFEATURE_XREF D, KBS.TISSUING_REF E,
WHERE A.ISSUE_ID_C = D.ISSUE_ID_C
AND C.FEATURE_ID_C = D.FEATURE_ID_C
AND B.FEATURE_ID_C = D.FEATURE_ID_C
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND B.DEFAULT_TYPE_C IN ('TDFL', 'DFLT')
AND A.MATURITY_TYPE_C <> '*'
AND A.MATURITY_D > (SYSDATE)


FARHANA-DISTRIBUTIONS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, E.DATED_D AS DATED_DATE, A.MATURITY_D AS MATURITY_DATE, F.DISTRIB_TYPE_C, G.OTL_TEXT_T
FROM KBS.TISSUE_REF A, KBS.TFEATURE_REF C, KBS.TFEATURE_XREF D, KBS.TISSUING_REF E, KBS.TDISTRIBUTIONS F, KBS.TISSUING_OTL G
WHERE A.ISSUE_ID_C = D.ISSUE_ID_C
AND C.FEATURE_ID_C = D.FEATURE_ID_C
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND C.FEATURE_ID_C=F.FEATURE_ID_C
AND A.ISSUING_ID_C=G.ISSUING_ID_C (+)
AND A.MATURITY_TYPE_C <> '*'
AND A.MATURITY_D > (SYSDATE)
AND '93' = G.OTL_ID_C (+)



IVAN-RATINGS
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, D.ISSUER_DESC_T AS ISSUER, C.ISSUING_CUSIP_T AS ISSUER_DESC, B.OFFERING_ID_C, E1.CRDT_RATE_C AS MDU_RTG, E2.CRDT_RATE_C AS MDE_RTG
FROM KBS.TINST_REF A, KBS.TISSUE_REF B, KBS.TISSUING_REF C, KBS.TISSUER_REF D, KBS.TISSUE_CRDT_RATING E1, KBS.TISSUE_CRDT_RATING E2
WHERE A.INST_ID_C=B.INST_ID_C
AND B.ISSUING_ID_C=C.ISSUING_ID_C
AND A.INST_ID_C=D.INST_ID_C
AND B.ISSUE_ID_C=E1.ISSUE_ID_C 
AND B.ISSUE_ID_C=E2.ISSUE_ID_C
AND B.MATURITY_D > (SYSDATE)
AND B.MATURITY_TYPE_C <> '*'
AND E1.CRDT_RATG_AGNCY_C = 'MDU'
AND E2.CRDT_RATG_AGNCY_C = 'MDE'
AND ((E1.CRDT_RATE_C = 'AA2' AND E2.CRDT_RATE_C = 'AA3') 
OR (E1.CRDT_RATE_C = 'AA1' AND E2.CRDT_RATE_C = 'AA2'))
AND EXISTS (SELECT DISTINCT OFFERING_ID_C 
FROM KBS.TINFO_SOURCE X 
WHERE X.OFFERING_ID_C=B.OFFERING_ID_C 
AND X.USER_ID_C= 'MDYFEED'
AND X.ADDED_Z > TO_DATE('10/01/2013', 'MM/DD/YYYY'))
AND ROWNUM < 500

QC 293 – CALL FREQ MISMATCH PAYMENT FREQ FOR VARIABLES



QC 611-144A FEED
SELECT DISTINCT B.OFFERING_ID_C AS OFFERING, A.ISSUING_ID_C AS ISSUING, A.A144_C, B.OFFERING_TYPE_C
FROM KBS.TISSUING_REF A, KBS.TOFFERING_REF B
WHERE A.OFFERING_ID_C=B.OFFERING_ID_C
AND A.A144_C = 'Y'
AND B.OFFERING_TYPE_C <> 'PD'

QC 831-USING SUBSTRING TO GET DEAL WITH 44 OTL BUT NOT 43
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, B.MATURITY_D, SUBSTR(C.OTL_TEXT_T,1,3) AS VAR_TYPE, SUBSTR(C.OTL_TEXT_T,12,2) AS VAR_FREQ 
FROM KBS.TINST_REF A, KBS.TISSUE_REF B, KBS.TISSUING_OTL C
WHERE A.INST_ID_C=B.INST_ID_C
AND B.ISSUING_ID_C=C.ISSUING_ID_C
AND A.INST_TYPE_C = 'MUNI'
AND B.MATURITY_D > (SYSDATE)
AND C.OTL_ID_C ='44'
AND SUBSTR(C.OTL_TEXT_T,1,3) IN ('VAR', 'ADJ')
AND B.ISSUING_ID_C NOT IN (
SELECT DISTINCT ISSUING_ID_C 
FROM KBS.TISSUING_OTL X 
WHERE X.ISSUING_ID_C=B.ISSUING_ID_C 
AND X.OTL_ID_C ='43')

QC828-EXPIRED LOC
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP8, B.OFFERING_ID_C AS OFFERING_ID, D.ISSUER_DESC_T AS ISSUER, A.DATED_D AS DTD, B.COUPON_ORGL_P AS CPN, B.MATURITY_D AS MTY_DATE, G.INST_TYPE_C AS INST_TYPE, C.ABA_N AS PAY_AGT, C.CITY_N AS PAY_AGT_CITY, C.STATE_ID_C AS PAY_AGT_STATE, E.CRDT_ENHMT_END_D AS EXPIR_DATE, E. CRDT_ENHMT_EXP_C AS EXPIR_CODE, E.CRDT_ENHMT_TYPE_C AS CRDT_TYPE, G.INST_N AS CRDT_ENHANCER, H.FULL_PART_CALL_C, J.CALL_D
FROM KBS.TISSUING_REF A, KBS.TISSUE_REF B, KBS.TISSUER_REF D, KBS.TINST_REF G, KBS.TINST_REF G1,
KBS.TCRDT_ENHMT_REF E, KBS.TCRDT_ENHMT_INST F, KBS.TABA_REF C, KBS.TCALLED_ISSUE H, KBS.TCALLED_BOND J, KBS.TOFFERING_ABA K
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND B.ISSUER_ID_C=D.ISSUER_ID_C 
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND E.CRDT_ENHMT_ID_C=F.CRDT_ENHMT_ID_C 
AND F.INST_ID_C=G.INST_ID_C 
AND B.INST_ID_C=G1.INST_ID_C
AND B.ISSUER_ID_C= H.ISSUER_ID_C (+)
AND B.ISSUE_ALPHA_C= H.ISSUE_ALPHA_C (+)
AND H.FEATURE_ID_C=J.FEATURE_ID_C (+)
AND B.OFFERING_ID_C=K.OFFERING_ID_C
AND C.ABA_OFFICE_ID_C=K. ABA_OFFICE_ID_C
AND C.ABA_BRNCH_ID_C=K. ABA_BRNCH_ID_C
AND K.ABA_REL_TYPE_C='PAYAGENT'
AND G1.INST_TYPE_C = 'MUNI'
AND B.MATURITY_D > (SYSDATE)

(MISSING CALLED BOND REQUIREMENT)

AND E.CRDT_ENHMT_TYPE_C IN ('LOC', 'GTD', 'LIQF', 'SYB', 'BPA', 'LIC')
AND E.CRDT_ENHMT_END_D < (SYSDATE)
AND E.CRDT_ENHMT_EXP_C <> 'EXPIRE'
AND A.SECURITY_TYPE_C NOT IN ('CAP', 'DERI', 'INVF', 'LINK', 'PAYS')


KATHLEEN-EDI (CHECKING IF HAS COVERAGE ON ISIN)
SELECT DISTINCT A.ISIN, D.CRF_CINS, B.CALLABLE, C.CALLPUT, B.INTERESTRATE, B.DENOMINATIONMULTIPLE, B.MATURITYDATE
FROM EDI.SCMST A, EDI.BOND B, EDI.CPOPT C, EDI.IDENTIFIER_XREF D
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID
AND A.SECID=D.SECID
AND C.ACTFLAG <> 'D'
AND A.ISIN = 'DE000HY0BXS4'
OR A.ISIN = 'AT0000181888'
OR A.ISIN = 'XS0979377701'
OR A.ISIN = 'DE000HY0BXQ8'
OR A.ISIN = 'FR0121890166'
OR A.ISIN = 'XS0989842322'


EDI-ALL ISIN'S IN SCMST (BY COUNTRY)
SELECT DISTINCT A.ISIN, B.ISSUERNAME, B.CNTRYOFINCORP, C.BONDTYPE
FROM EDI.SCMST A, EDI.ISSUR B, EDI.BOND C
WHERE A.ISSID=B.ISSID
AND A.SECID=C.SECID
AND A.ISIN IS NOT NULL 
AND B.CNTRYOFINCORP IN ('US','GB','FR','IT','RU')
ORDER BY 1 ASC


CINS IN MB AS CUSIP
SELECT DISTINCT ISSUER_ID_C, ISSUER_TYPE_C, ISSUER_DESC_T
FROM KBS.TISSUER_REF
WHERE ISSUER_TYPE_C = 'CUSIP'
AND ISSUER_ID_C NOT LIKE '0%'
AND ISSUER_ID_C NOT LIKE '1%'
AND ISSUER_ID_C NOT LIKE '2%'
AND ISSUER_ID_C NOT LIKE '3%'
AND ISSUER_ID_C NOT LIKE '4%'
AND ISSUER_ID_C NOT LIKE '5%'
AND ISSUER_ID_C NOT LIKE '6%'
AND ISSUER_ID_C NOT LIKE '7%'
AND ISSUER_ID_C NOT LIKE '8%'
AND ISSUER_ID_C NOT LIKE '9%'


MB-NEW ISSUE CALENDAR REPORT (WITH CUSIPS)
SELECT DISTINCT B.OFFERING_TYPE_C, CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.SALE_NOTICE_D AS AWARD_DATE, H.ISSUER_DESC_T, F1.STATE_INCORP_1_C, J.ISSUING_CUSIP_T, A.ISSUE_ORGL_M, K1.UNDWRTR_N AS UNDERWRITER, K2.UNDWRTR_N AS FINL_ADVISOR, K3.UNDWRTR_N AS BOND_COUNSEL, A.MATURITY_D, F2.INST_ID_C AS INSURANCE, D1.CRDT_RATE_C AS MDY_RATING, D2.CRDT_RATE_C AS SP_RATING, D3.CRDT_RATE_C AS FTH_RATING
FROM KBS.TISSUE_REF A, KBS.TOFFERING_REF B, KBS.TCRDT_ENHMT_REF C, KBS.TISSUE_CRDT_RATING D1, KBS.TISSUE_CRDT_RATING D2, KBS.TISSUE_CRDT_RATING D3, KBS.TISSUING_REF E, KBS.TINST_REF F1, KBS.TCRDT_ENHMT_INST G, KBS.TINST_REF F2, KBS.TISSUER_REF H, KBS.TISSUING_REF J, KBS.TUNDERWRITER_REF K1, KBS.TUNDERWRITER_REF K2, KBS.TUNDERWRITER_REF K3
WHERE A.OFFERING_ID_C=B.OFFERING_ID_C 
AND A.ISSUING_ID_C=C.ISSUING_ID_C (+)
AND A.ISSUE_ID_C=D1.ISSUE_ID_C (+)
AND A.ISSUE_ID_C=D2.ISSUE_ID_C (+)
AND A.ISSUE_ID_C=D3.ISSUE_ID_C (+)
AND A.INST_ID_C=F1.INST_ID_C (+)
AND C.CRDT_ENHMT_ID_C= G.CRDT_ENHMT_ID_C (+)
AND G.INST_ID_C=F2.INST_ID_C (+)
AND A.ISSUER_ID_C=H.ISSUER_ID_C
AND A.ISSUING_ID_C=J.ISSUING_ID_C
AND B.UNDWRTR_ID_C=K1. UNDWRTR_ID_C
AND B.FISCL_ID_C=K2. UNDWRTR_ID_C
AND B.BOND_COUNSEL_C=K3. UNDWRTR_ID_C
AND 'MDY' = D1.CRDT_RATG_AGNCY_C (+)
AND 'SP'= D2.CRDT_RATG_AGNCY_C (+)
AND 'FTH'= D3.CRDT_RATG_AGNCY_C (+)
AND 'L' = D1. CRDT_RATE_TYPE_C (+)
AND 'L' = D2. CRDT_RATE_TYPE_C (+)
AND 'L' = D3. CRDT_RATE_TYPE_C (+)
AND 'INSN' = C.CRDT_ENHMT_TYPE_C (+)
AND 'P' = C.PRIM_SECONDARY_C (+)
AND 'FULL' = C.COVERAGE_TYPE_C (+)
AND F1.INST_TYPE_C = 'MUNI'
AND B.OFFERING_TYPE_C IN ('C', 'N')
AND B.SALE_NOTICE_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'


MB-NEW ISSUE CALENDAR REPORT (WITH OFFERINGS ONLY)
SELECT DISTINCT B.OFFERING_TYPE_C, B.OFFERING_ID_C, B.SALE_NOTICE_D AS AWARD_DATE, H.ISSUER_DESC_T AS ISSUER, F1.STATE_INCORP_1_C AS STATE, B.OFFERING_ORGL_M AS DEAL SIZE, K1.UNDWRTR_N AS UNDERWRITER, K2.UNDWRTR_N AS FINL_ADVISOR, K3.UNDWRTR_N AS BOND_COUNSEL
FROM KBS.TISSUE_REF A , KBS.TOFFERING_REF B, KBS.TINST_REF F1, KBS.TISSUER_REF H, KBS.TUNDERWRITER_REF K1, KBS.TUNDERWRITER_REF K2, KBS.TUNDERWRITER_REF K3
WHERE A.OFFERING_ID_C=B.OFFERING_ID_C 
AND A.INST_ID_C=F1.INST_ID_C (+)
AND A.ISSUER_ID_C=H.ISSUER_ID_C
AND B.UNDWRTR_ID_C=K1. UNDWRTR_ID_C
AND B.FISCL_ID_C=K2. UNDWRTR_ID_C
AND B.BOND_COUNSEL_C=K3. UNDWRTR_ID_C
AND F1.INST_TYPE_C = 'MUNI'
AND B.OFFERING_TYPE_C IN ('C', 'N')
AND B.SALE_NOTICE_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
ORDER BY 3 ASC



EDI-GUARANTOR DATA
SELECT DISTINCT A.SECID, A.ISIN, A.ISSUERNAME, A.CRF_CINS, B.GUARANTEETYPE, C.REGISTRARNAME, C.CITY, C.CNTRYCD
FROM EDI.IDENTIFIER_XREF A, EDI.SCAGY B, EDI.AGNCY C
WHERE A.SECID=B.SECID
AND B.AGNCYID=C.AGNCYID
AND B.RELATIONSHIP = 'GUR'
AND B.GUARANTEETYPE = 'GTD'



EDI-FRN INDEX
SELECT DISTINCT A.SECID, A.ISIN, B.FRNINDEXBENCHMARK
FROM EDI.SCMST A, EDI.BOND B
WHERE A.SECID=B.SECID
AND B.MATURITY_DATE > (SYSDATE)

GARY-EXPIRING LOC'S
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP8, B.OFFERING_ID_C AS OFFERING_ID, D.ISSUER_DESC_T AS ISSUER, G1.INST_TYPE_C, A.SECURITY_TYPE_C, A.DATED_D AS DTD, B.COUPON_ORGL_P AS CPN, B.MATURITY_D AS MTY_DATE, E.CRDT_ENHMT_END_D AS EXPIR_DATE, E. CRDT_ENHMT_EXP_C AS EXPIR_CODE, E.CRDT_ENHMT_TYPE_C AS CRDT_TYPE, G.INST_N AS LOC_BANK
FROM KBS.TISSUING_REF A, KBS.TISSUE_REF B, KBS.TISSUER_REF D, KBS.TINST_REF G, KBS.TINST_REF G1, KBS.TCRDT_ENHMT_REF E, KBS.TCRDT_ENHMT_INST F
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND B.ISSUER_ID_C=D.ISSUER_ID_C 
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND E.CRDT_ENHMT_ID_C=F.CRDT_ENHMT_ID_C 
AND F.INST_ID_C=G.INST_ID_C 
AND B.INST_ID_C=G1.INST_ID_C
AND B.MATURITY_D > (SYSDATE)
AND B.MATURITY_TYPE_C <> '*'
AND G1.INST_TYPE_C IN ('MUNI', 'CORP')
AND E.CRDT_ENHMT_TYPE_C IN ('LOC', 'GTD', 'LIQF', 'SYB', 'BPA', 'LIC', 'CLC')
AND E.CRDT_ENHMT_END_D < (SYSDATE) + 7
AND E.CRDT_ENHMT_END_D > TO_DATE('01/01/2009','MM/DD/YYYY') ---ONLY BRINGS BACK ENHANCEMENTS THAT EXPIRE 2009 OR AFTER
AND A.DATED_D > TO_DATE('01/01/2000','MM/DD/YYYY') ---ONLY BRINGS BACK DEALS DATED 2000 OR LATER
AND E.CRDT_ENHMT_EXP_C <> 'EXPIRE'
AND A.SECURITY_TYPE_C NOT IN ('CD', 'DERI', 'INVF', 'LINK', 'OPTN', 'PASS')
AND NOT EXISTS (
SELECT DISTINCT B.ISSUING_ID_C 
FROM KBS.TCALLED_ISSUE X
WHERE B.ISSUER_ID_C=X.ISSUER_ID_C
AND B.ISSUE_ALPHA_C=X.ISSUE_ALPHA_C
AND X.FULL_PART_CALL_C = 'FULL')
AND NOT EXISTS (
SELECT DISTINCT B.ISSUING_ID_C 
FROM KBS.TISSUING_OTL Y
WHERE B.ISSUING_ID_C=Y.ISSUING_ID_C
AND Y.OTL_ID_C='93')
ORDER BY 9 DESC NULLS LAST ---ORDERED BY LOC EXPIRATION DATES (MOST RECENT FIRST)


EXAMPLES OF FRN'S
SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.ISSUEDATE, B.MATURITYDATE, B.INTERESTBASIS, C.EFFECTIVEDATE, B.FRNINDEXBENCHMARK, B.MARKUP, B.INTERESTRATE, B.FIRSTCOUPONDATE, B.INTERESTPAYMENTFREQUENCY, B.FRNINTADJFREQ
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B, EDI.INTBC C
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID
AND B.ACTFLAG <> 'D'
AND C.ACTFLAG <> 'D'
AND B.INTERESTPAYMENTFREQUENCY IS NOT NULL
AND B.FRNINDEXBENCHMARK <> 'CRDRAT'
AND B.FRNINDEXBENCHMARK IS NOT NULL
AND B.INTERESTBASIS IN ('FR', 'FRFXD', 'FRSU', 'FRZC', 'FXDFR', 'SDFR', 'SUFR', 'ZCFR', 'FXDFRFXD')
AND B.MATURITYDATE > (SYSDATE)
AND A.ENDDATE IS NULL


EXAMPLES OF FRN'S 
SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.INTERESTBASIS, B.ISSUEDATE, B.MATURITYDATE, C.EFFECTIVEDATE, B.FRNINDEXBENCHMARK, B.MARKUP, B.MINIMUMINTERESTRATE, B.MAXIMUMINTERESTRATE, B.INTERESTRATE, B.FIRSTCOUPONDATE, B.INTCOMMENCEMENTDATE, B.FRNINTADJFREQ, B.INTERESTPAYMENTFREQUENCY
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B, EDI.INTBC C
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID
AND B.ACTFLAG <> 'D'
AND C.ACTFLAG <> 'D'
AND B.INTERESTPAYMENTFREQUENCY IS NOT NULL
AND B.FRNINDEXBENCHMARK <> 'CRDRAT'
AND B.FRNINDEXBENCHMARK IS NOT NULL
AND B.INTERESTBASIS IN ('FR', 'FRFXD', 'FRSU', 'FRZC', 'FXDFR', 'SDFR', 'SUFR', 'ZCFR', 'FXDFRFXD')
AND B.MATURITYDATE > (SYSDATE)
AND A.ENDDATE IS NULL



MIKE-DEFAULT EXAMPLES
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C), A.TECH_DFLT_REASON_C, A.BNKRPCY_FILR_TYP_C, A.BNKRPCY_CHPR_TYP_C, A.BNKRPCY_EMERGNCE_D, A.REORGANIZATION_D
FROM KBS.TDEFAULTS A, KBS.TFEATURE_XREF B
WHERE A.FEATURE_ID_C=B.FEATURE_ID_C
AND A.TECH_DFLT_REASON_C = 'BKRTCY'


KATHLEEN-COMPARING EDI FEED TO MB ((1)GET CINS FROM EDI FEED, (2)COMPARE AGAINST MB)

(1)
SELECT DISTINCT A.CRF_CINS, B.ISSUEDATE, B.MATURITYDATE, B.INTERESTRATE, B.FIRSTCOUPONDATE, B.INTERESTPAYMENTFREQUENCY AS INT_PAY_FREQ, B.INTERESTACCRUALCONVENTION AS DAY_COUNT, B.ISSUEAMOUNT AS ISSUE_AMOUNT, B.CURENCD AS CURRENCY, B.OUTSTANDINGAMOUNT
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B
WHERE A.SECID=B.SECID
AND A.ENDDATE IS NULL
AND B.MATURITYDATE > (SYSDATE)
AND (B.ISSUEDATE IS NOT NULL OR B.MATURITYDATE IS NOT NULL)
AND A.MODIFIEDZ > (SYSDATE-1)
AND (A.CRF_CINS NOT LIKE '0%' AND A.CRF_CINS NOT LIKE '1%' AND A.CRF_CINS NOT LIKE '2%' AND A.CRF_CINS NOT LIKE '3%' AND A.CRF_CINS NOT LIKE '4%' AND A.CRF_CINS NOT LIKE '5%' AND A.CRF_CINS NOT LIKE '6%' AND A.CRF_CINS NOT LIKE '7%' AND A.CRF_CINS NOT LIKE '8%' AND A.CRF_CINS NOT LIKE '9%')

(2)
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.EDI_DNP_ADDED_Z AS DNP_ADDED, C.DATED_D AS DTD, A.MATURITY_D AS MATURITY, A.COUPON_ORGL_P AS COUPON, D.PAYMENT_FIRST_D AS FC_DATE, D.FREQ_PERIOD_C AS INT_PAY_FREQ, C.ACCRUAL_COUNT_C AS DAY_COUNT, A.ISSUE_ORGL_M AS ISSUE_AMOUNT, A.CUR_ORGL_ID_C AS CURRENCY, A.ISSUE_OTSD_M AS OUTSTANDING_AMNT 
FROM KBS.TISSUE_REF A, KBS.TOFFERING_REF B, KBS.TISSUING_REF C, KBS.TINT_PAY_CYCLE D
WHERE A.OFFERING_ID_C=B.OFFERING_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C 
AND A.ISSUING_ID_C=D.ISSUING_ID_C (+)
AND A.MATURITY_D > (SYSDATE)
AND B.EDI_DNP_ADDED_Z IS NOT NULL
AND (
(A.ISSUER_ID_C = '62931Z' AND A.ISSUE_ALPHA_C = 'NA')


IPD
SELECT DISTINCT A.ISIN, B.CUSIP9, B.QSIP_ISSUER_DESC, B.QSIP_DATED_DATE, B.QSIP_MATURITY_DATE, B.QSIP_ISSUING_DESC
FROM MASTER_REF.SPSE_CUSIPREC_QS B, MASTER_REF.SPSE_II_II A
WHERE A.CUSIP9=B.CUSIP9

FARHANA-SINK FUNDS WITH 'FS'



LIZ-CD'S WITH MISSING INFO
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, C.DATED_D AS DTD, A.MATURITY_D AS MATURITY, A.COUPON_ORGL_P AS COUPON, D.PAYMENT_FIRST_D AS FC_DATE, D.FREQ_PERIOD_C AS INT_PAY_FREQ, A.ISSUE_ORGL_M AS ISSUE_AMOUNT, A.ISSUE_DENOM_1_M AS DENOM, E.OTL_TEXT_T AS CALL_OTL 
FROM KBS.TISSUE_REF A, KBS.TOFFERING_REF B, KBS.TISSUING_REF C, KBS.TINT_PAY_CYCLE D, KBS.TISSUING_OTL E
WHERE A.OFFERING_ID_C=B.OFFERING_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C 
AND A.ISSUING_ID_C=D.ISSUING_ID_C
AND A.ISSUING_ID_C=E.ISSUING_ID_C (+)
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND C.SECURITY_TYPE_C = 'CD' 
AND '48' = E.OTL_ID_C (+)
AND (A.MATURITY_D IS NULL
OR A.COUPON_ORGL_P IS NULL
OR A.ISSUE_ORGL_M = 0
OR C.DATED_D IS NULL
OR D.PAYMENT_FIRST_D IS NULL
OR D.FREQ_PERIOD_C = '  '
OR E.OTL_TEXT_T IS NULL)



MB-TO CHECK HOW FRN GOT SET UP IN MB
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CINS, A.ISIN, B.OTL_TEXT_T, C.INDEX_TYPE, C.INDEX_SUB_TYPE, D.ADJ_DT, D.ADJ_RATE
FROM KBS.TISSUE_REF A, KBS.TISSUING_OTL B, KBS.TINDEX_GROUPING C, KBS.TVARIABLE_SCHEDULE D
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C (+)
AND (A.ISSUER_ID_C=C.ISSUER_ID_C (+)
AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C (+))
AND (A.ISSUER_ID_C=D.ISSUER_ID_C (+)
AND A.ISSUE_ALPHA_C=D.ISSUE_ALPHA_C (+))
AND ((A.ISSUER_ID_C = 'U1737Q' AND A.ISSUE_ALPHA_C = 'UM')
OR (A.ISSUER_ID_C = 'G463AN' AND A.ISSUE_ALPHA_C = 'BU')

.
.
.
.
)

GARY-RATINGS (HAS U/L OR ENHANCED RTGS BUT NO REGULAR AGY (MDY, SP, FTH) RTG)






SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, B.MATURITY_D, A.INST_TYPE_C, C.FULL_PART_CALL_C, C.CALLED_AMT_L, F.SEQ_ID_C
FROM KBS.TINST_REF A, KBS.TISSUE_REF B, KBS.TCALLED_ISSUE C, KBS.TCALLED_BOND E, KBS.OUTSTANDING_AMT_SCHEDULE F
WHERE A.INST_ID_C=B.INST_ID_C
AND (B.ISSUER_ID_C=C.ISSUER_ID_C
AND B.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C)
AND C.FEATURE_ID_C=E.FEATURE_ID_C
AND (B.ISSUER_ID_C=F.ISSUER_ID_C
AND B.ISSUE_ALPHA_C=F.ISSUE_ALPHA_C)
AND A.INST_TYPE_C IN ('MUNI', 'CORP')
AND B.MATURITY_D > (SYSDATE)
AND B.ISSUE_ORGL_M > 0
AND C.CALLED_AMT_L IS NULL 
AND B.ISSUING_ID_C NOT IN (
SELECT DISTINCT ISSUING_ID_C FROM KBS.TISSUING_OTL O WHERE O.ISSUING_ID_C=B.ISSUING_ID_C AND O.OTL_ID_C ='93'
)
AND C.FULL_PART_CALL_C <> 'FULL'
ORDER BY 1,6 ASC NULLS LAST



LIZ-MISSING INFO (ON SPECIFIC FIELDS) 
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, D.ISSUER_DESC_T AS ISSUER, B.DATED_D AS DTD, A.COUPON_ORGL_P AS CPN, A.MATURITY_D AS MTY, A.ISSUE_ORGL_M AS ISSUE_AMT, A.CUR_ORGL_ID_C AS ISSUE_CURR, A.ISSUE_DENOM_1_M AS DENOM, B.ACCRUAL_COUNT_C AS DAY_COUNT, C.PAYMENT_FIRST_D AS FIRST_CPN_DATE, C.FREQ_PERIOD_C AS FREQ, B.SECURITY_TYPE_C AS SEC_TYPE,  MDY.CRDT_RATE_C AS MDY_RATING, SP.CRDT_RATE_C AS SP_RATING, F.OTL_TEXT_T AS CALL_OTL
FROM KBS.TISSUING_REF B, KBS.TISSUE_REF A, KBS.TINT_PAY_CYCLE C, KBS.TISSUER_REF D, KBS.TISSUE_CRDT_RATING MDY, KBS.TISSUE_CRDT_RATING SP, KBS.TISSUING_OTL F
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C (+)
AND A.ISSUER_ID_C=D.ISSUER_ID_C
AND A.ISSUE_ID_C=MDY.ISSUE_ID_C (+)
AND A.ISSUE_ID_C=SP.ISSUE_ID_C (+)
AND A.ISSUING_ID_C=F.ISSUING_ID_C (+)
AND 'MDY'= MDY.CRDT_RATG_AGNCY_C (+)
AND 'SP' = SP. CRDT_RATG_AGNCY_C (+)
AND '48'= F.OTL_ID_C (+)
AND ((A.ISSUER_ID_C = '701184' AND A.ISSUE_ALPHA_C = 'AE')
OR (A.ISSUER_ID_C = '721298' AND A.ISSUE_ALPHA_C = 'AA')…………


LIZ-MISSING FIELDS-CORP CALL
SELECT DISTINCT ISSUING_ID_C, CALL_TYPE_C, CALL_BEGIN_D, CALL_BEGIN_PRICE_L
FROM CVN.TCALL_DETAIL
WHERE ISSUING_ID_C IN (………..)



JANICE-SP RATINGS FOR CITI INQUIRY
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, C.CRDT_RATG_AGNCY_C, C.CRDT_RATE_TYPE_C, C.CRDT_RATE_C
FROM KBS.TISSUE_REF A, KBS.TINST_REF B, KBS.TISSUE_CRDT_RATING C 
WHERE A.INST_ID_C=B.INST_ID_C
AND A.ISSUE_ID_C=C.ISSUE_ID_C (+)
AND 'SP' = C.CRDT_RATG_AGNCY_C (+)
AND 'L' = C.CRDT_RATE_TYPE_C (+)
AND ((A.ISSUER_ID_C = 'G4110T' AND A.ISSUE_ALPHA_C = '10')
OR (A.ISSUER_ID_C = 'Y7566P' AND A.ISSUE_ALPHA_C = '10')
)……………….


GARY-RATINGS ADDED BY KI NOT FEEDS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.OFFERING_ID_C, A.ISSUING_ID_C
FROM KBS.TISSUE_REF A, KBS.TINST_REF B, KBS.TISSUE_CRDT_RATING C 
WHERE A.INST_ID_C=B.INST_ID_C
AND A.ISSUE_ID_C=C.ISSUE_ID_C (+)
AND B.INST_TYPE_C = 'MUNI'
AND A.MATURITY_D > (SYSDATE)
AND 'MDY' = C.CRDT_RATG_AGNCY_C (+)
AND 'L' = C.CRDT_RATE_TYPE_C (+)
AND IS NOT NULL = C.CRDT_RATE_C (+)
AND 'N/R' <> C.CRDT_RATE_C (+)



MB-CONVERTIBLE
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, C.*
FROM KBS.TISSUE_REF A, KBS.TFEATURE_XREF B, KBS.TCONVERTIBLE_REF C
WHERE (A.ISSUER_ID_C=B.ISSUER_ID_C AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C)
AND B.FEATURE_ID_C=C.FEATURE_ID_C
AND CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) = 'G3196W10'


EDI-CONVERTIBLE
SELECT DISTINCT C.SECID, C.ISIN, C.CRF_CINS, C.ENDDATE, A.ACTFLAG, B.ISSUEDATE, A.FROMDATE, A.TODATE, B.MATURITYDATE, A.PRICE, A.RATIONEW, A.RESSECTYCD, A.RESSECID
FROM EDI.CONVT A, EDI.BOND B, EDI.IDENTIFIER_XREF C
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID
AND C.SECID=79591
ORDER BY 2 ASC



EDI-QC 521-CCA/CUR OTL
SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.ISSUEDATE AS DTD, B.MATURITYDATE AS MTY_DATE, B.INTERESTBASIS, C.EFFECTIVEDATE, B.INTERESTRATE, B.FRNTYPE, B.FRNINDEXBENCHMARK AS FRN_INDEX, B.MARKUP, B.FRNINTADJFREQ, B.FIRSTCOUPONDATE AS FC_DATE, B.INTERESTPAYMENTFREQUENCY AS INT_PAY_FREQ
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B, EDI.INTBC C
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID (+)
AND A.ENDDATE IS NULL
AND B.INTERESTBASIS IN ('FXDZCFR','FRZCFXD')
AND A.CRF_CINS NOT LIKE '0%'
AND A.CRF_CINS NOT LIKE '1%'
AND A.CRF_CINS NOT LIKE '2%'
AND A.CRF_CINS NOT LIKE '3%'
AND A.CRF_CINS NOT LIKE '4%'
AND A.CRF_CINS NOT LIKE '5%'
AND A.CRF_CINS NOT LIKE '6%'
AND A.CRF_CINS NOT LIKE '7%'
AND A.CRF_CINS NOT LIKE '8%'
AND A.CRF_CINS NOT LIKE '9%'


IPD-REPORTING_ENTITIES WITH MULTIPLE CC6'S
SELECT DISTINCT A.AO_ENHANCER_NAME, A.AO_ENTITY_NAME, A.AO_CC6_03
FROM MASTER_REF.SPSE_ASSOCOBLIG_AO A, MASTER_REF.SPSE_ASSOCOBLIG_AO B, MASTER_REF.SPSE_CUSIPREC_QS C
WHERE A.AO_ENTITY_NAME=B.AO_ENTITY_NAME
AND A.AO_CC6_03 <> B.AO_CC6_03
AND C.QSIP_MATURITY_DATE > (SYSDATE)


EDI-STEP
SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, A.ENDDATE, B.ISSUEDATE, B.MATURITYDATE, B.INTERESTBASIS, C.EFFECTIVEDATE AS INTBC_EFFECTIVEDATE, D.EFFECTIVEDATE AS IRCHG_EFFECTIVEDATE, D.OLDINTERESTRATE, D.NEWINTERESTRATE, B.FIRSTCOUPONDATE, B.INTERESTPAYMENTFREQUENCY
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B, EDI.INTBC C, EDI.IRCHG D
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID (+)
AND A.SECID=D.SECID (+)
AND A.CRF_CINS NOT LIKE '0%'
AND A.CRF_CINS NOT LIKE '1%'
AND A.CRF_CINS NOT LIKE '2%'
AND A.CRF_CINS NOT LIKE '3%'
AND A.CRF_CINS NOT LIKE '4%'
AND A.CRF_CINS NOT LIKE '5%'
AND A.CRF_CINS NOT LIKE '6%'
AND A.CRF_CINS NOT LIKE '7%'
AND A.CRF_CINS NOT LIKE '8%'
AND A.CRF_CINS NOT LIKE '9%'
AND A.ENDDATE IS NULL
AND B.INTERESTBASIS IN ('SU','SD','SDZC','SUSD','SUZC','SUFR','SDFR','SDSU','SUSDSU', 'SDZC')
AND B.MATURITYDATE > (SYSDATE)
ORDER BY 2,9 ASC

FRN FEATURE/SCHEDULE EXIST WITHOUT FRN OTL
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP
FROM KBS.TVARIABLE_FEATURE A, KBS.TISSUE_REF B
WHERE A.ISSUER_ID_C=B.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C
AND A.VARIABLE_TYPE_C = 'FRN'
AND NOT EXISTS 
(SELECT DISTINCT ISSUING_ID_C
FROM KBS.TISSUING_OTL 
WHERE B.ISSUING_ID_C=ISSUING_ID_C 
AND OTL_ID_C='44')

OR

SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.VARIABLE_TYPE_C AS TYPE, C.DATED_D, B.MATURITY_D 
FROM KBS.TVARIABLE_FEATURE A, KBS.TISSUE_REF B, KBS.TISSUING_REF C
WHERE A.ISSUER_ID_C=B.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C
AND B.ISSUING_ID_C=C.ISSUING_ID_C
AND A.VARIABLE_TYPE_C IN ('FRN', 'STP')
AND NOT EXISTS 
(SELECT DISTINCT ISSUING_ID_C
FROM KBS.TISSUING_OTL 
WHERE B.ISSUING_ID_C=ISSUING_ID_C 
AND OTL_ID_C='44')
STP FEATURE/SCHEDULE EXIST WITHOUT STP OTL
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP
FROM KBS.TVARIABLE_FEATURE A, KBS.TISSUE_REF B
WHERE A.ISSUER_ID_C=B.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C
AND A.VARIABLE_TYPE_C = 'STP'
AND NOT EXISTS 
(SELECT DISTINCT ISSUING_ID_C
FROM KBS.TISSUING_OTL 
WHERE B.ISSUING_ID_C=ISSUING_ID_C 
AND OTL_ID_C='44')



TEST QC 521
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.ISIN, B.OTL_TEXT_T, D.PAYMENT_OBLGN_C, D.ACCRUAL_COUNT_C, D.ACCRUAL_CODE_C, D.RECORD_DATE_Q, D.RECORD_DATE_C, D.CUR_ID_C, D.PAYMENT_FORM_C, C.INT_PAY_TYPE_C, C.ACCRUAL_FIRST_D, C.PAYMENT_FIRST_D , C.FREQ_PER_OCCUR_Q, C.FREQ_PERIOD_C, C.FREQ_Q, C.FREQ_DAY_C, C.BUS_DAY_ADJ_C
FROM KBS.TISSUE_REF A, KBS.TISSUING_OTL B, KBS.TINT_PAY_CYCLE C, KBS.TISSUING_REF D
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C (+)
AND A.ISSUING_ID_C=C.ISSUING_ID_C (+)
AND A.ISSUING_ID_C=D.ISSUING_ID_C (+)
AND ((A.ISSUER_ID_C = 'G2520D' AND A.ISSUE_ALPHA_C = 'AS')
OR (A.ISSUER_ID_C = 'G0603N' AND A.ISSUE_ALPHA_C = 'DJ')
OR (A.ISSUER_ID_C = 'Y7087P' AND A.ISSUE_ALPHA_C = 'RH')
OR (A.ISSUER_ID_C = 'G0R0Z0' AND A.ISSUE_ALPHA_C = 'SM')
OR (A.ISSUER_ID_C = 'Y8T42U' AND A.ISSUE_ALPHA_C = 'AB')
OR (A.ISSUER_ID_C = 'T1188J' AND A.ISSUE_ALPHA_C = 'EP')
OR (A.ISSUER_ID_C = 'Y3R55E' AND A.ISSUE_ALPHA_C = 'KL')
OR (A.ISSUER_ID_C = 'N2583H' AND A.ISSUE_ALPHA_C = 'LR'))



GARY-HAS "MBIA" IN DESC BUT "NP" IN INSURANCE FIELD
SELECT DISTINCT B.ISSUING_ID_C, B.OFFERING_ID_C, B.DATED_D, B.ISSUING_CUSIP_T
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, KBS.TCRDT_ENHMT_REF C, KBS.TCRDT_ENHMT_INST D, KBS.TINST_REF E
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C
AND C.CRDT_ENHMT_ID_C=D.CRDT_ENHMT_ID_C 
AND D.INST_ID_C=E.INST_ID_C 
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND (B.ISSUING_CUSIP_T LIKE 'MBIA%'
OR B.ISSUING_CUSIP_T LIKE '% MBIA%')
AND E. INST_ID_C = 484187


EDI-LIST OF STEP CPNS BY INTERESTBASIS
SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, B.ISSUEDATE, B.MATURITYDATE, B.INTERESTBASIS, C.EFFECTIVEDATE AS INTBC_EFFECTIVE, B.FIRSTCOUPONDATE, B.INTERESTPAYMENTFREQUENCY, D.EFFECTIVEDATE AS IRCHG_EFFECTIVE, D.OLDINTERESTRATE, D.NEWINTERESTRATE
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B, EDI.INTBC C, EDI.IRCHG D
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID (+)
AND A.SECID=D.SECID (+)
AND A.ENDDATE IS NULL
AND B.MATURITYDATE > (SYSDATE)
AND B.INTERESTBASIS IN ('SU', 'SD', 'SDZC', 'SUSD', 'SUZC', 'SUFR', 'SDFR', 'SDSU', 'SUSDSU', 'ZCSU')

KRISTEN-DERIVATIVES
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS DERIV_CUSIP, J.UNDLY_ISSUER_ID_C, J.UNDLY_ISSUE_ALPHA_C, SUBSTR(F.OTL_TEXT_T,18,2) AS PUT_FREQ, SUBSTR(G.OTL_TEXT_T,12,2) AS VAR_FREQ, E.UNDWRTR_N AS UNDERWRITER
FROM KBS.TISSUING_REF A, KBS.TISSUE_REF B, KBS.TOFFERING_REF D, KBS.TUNDERWRITER_REF E, KBS.TISSUING_OTL F, KBS.TISSUING_OTL G, KBS.RESIDUAL H, KBS.RESIDUAL_UNDLY_BOND J
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND B.OFFERING_ID_C=D.OFFERING_ID_C
AND D.UNDWRTR_ID_C=E.UNDWRTR_ID_C (+)
AND A.ISSUING_ID_C=F.ISSUING_ID_C
AND A.ISSUING_ID_C=G.ISSUING_ID_C
AND (B.ISSUER_ID_C=H.ISSUER_ID_C (+) AND B.ISSUE_ALPHA_C=H.ISSUE_ALPHA_C (+) )
AND (B.ISSUER_ID_C=J.ISSUER_ID_C (+) AND B.ISSUE_ALPHA_C=J.ISSUE_ALPHA_C (+) )
AND A.SECURITY_TYPE_C IN ('SHFL','INVF','LINK')
AND B.MATURITY_TYPE_C <> '*'
AND B.MATURITY_D > (SYSDATE)
AND F.OTL_ID_C ='43'
AND F.OTL_TEXT_T LIKE 'PUT%'
AND SUBSTR(F.OTL_TEXT_T,18,2) IN ('MO', '3M', 'QU', '6M', 'SA', 'YR', '2Y', '3Y', '4Y', '5Y', '6Y', '7Y', '8Y', '9Y', 'TM')
AND G.OTL_ID_C ='44'
AND SUBSTR(G.OTL_TEXT_T,1,3) IN ('VAR', 'ADJ')
AND SUBSTR(G.OTL_TEXT_T,12,2) IN ('MO', 'QU', 'SA', 'BM', 'YR', 'TM') 
ORDER BY 1 ASC NULLS LAST


JANICE-ETM PREF TYPE & /E OTL
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, A.ISSUING_ID_C, B.PREF_TYPE_C, C.OTL_TEXT_T
FROM KBS.TISSUE_REF A,KBS.TPREREFUNDED_REF B, KBS.TISSUING_OTL C
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C 
AND B.PREF_TYPE_C = 'ETM'
AND C.OTL_TEXT_T LIKE '%/E%'
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'


GARY-ISSUERS THAT HAVE THE SAME OBLIGOR AS ISSR & OBLI WITHIN AN ISSUER
SELECT DISTINCT CONCAT(B1.ISSUER_ID_C, B1.ISSUE_ALPHA_C) AS CUSIP, B1.OFFERING_ID_C, B1.ISSUING_ID_C, A1.DATED_D, B1.MATURITY_D, E1.CRDT_ENHMT_TYPE_C AS ROLE_CODE1, E2.CRDT_ENHMT_TYPE_C AS ROLE_CODE2, G1.INST_N AS OBLIGOR , G1.INST_CC6 AS CC6, D11.ISSUER_DESC_T AS CC6_INST
FROM KBS.TISSUING_REF A1, KBS.TISSUE_REF B1, KBS.TISSUER_REF D1, KBS.TINST_REF G1,
KBS.TCRDT_ENHMT_REF E1, KBS.TCRDT_ENHMT_INST F1, KBS.TISSUER_REF D11, KBS.TISSUING_REF A2, KBS.TISSUE_REF B2, KBS.TISSUER_REF D2, KBS.TINST_REF G2,
KBS.TCRDT_ENHMT_REF E2, KBS.TCRDT_ENHMT_INST F2, KBS.TISSUER_REF D12
WHERE A1.ISSUING_ID_C=B1.ISSUING_ID_C
AND B1.ISSUER_ID_C=D1.ISSUER_ID_C (+)
AND A1.ISSUING_ID_C=E1.ISSUING_ID_C (+)
AND E1.CRDT_ENHMT_ID_C=F1.CRDT_ENHMT_ID_C (+)
AND F1.INST_ID_C=G1.INST_ID_C (+)
AND G1.INST_CC6 = D11.ISSUER_ID_C (+)
AND E1.CRDT_ENHMT_TYPE_C = 'ISSR'
AND A2.ISSUING_ID_C=B2.ISSUING_ID_C
AND B2.ISSUER_ID_C=D2.ISSUER_ID_C (+)
AND A2.ISSUING_ID_C=E2.ISSUING_ID_C (+)
AND E2.CRDT_ENHMT_ID_C=F2.CRDT_ENHMT_ID_C (+)
AND F2.INST_ID_C=G2.INST_ID_C (+)
AND G2.INST_CC6 = D12.ISSUER_ID_C (+)
AND E2.CRDT_ENHMT_TYPE_C = 'OBLI'
AND B1.ISSUER_ID_C=B2.ISSUER_ID_C
AND B1.ISSUE_ALPHA_C=B2.ISSUE_ALPHA_C
AND G1.INST_N=G2.INST_N



QC975-QUERY FOR CALLED BOND USER STORY
SELECT DISTINCT A.CRF_CINS, A.ISIN, A.SECID, B.ACTFLAG, B.REDEMDATE, B.PRICEASPERCENT, B.PREMIUMASPERCENT, B.REDEMPRICE, C.PARVALUE, B.REDEMTYPE, B.PARTFINAL, B.AMOUNTREDEEMED, D.EFFECTIVEDATE, D.OLDOUTVALUE, D.NEWOUTVALUE 
FROM EDI.IDENTIFIER_XREF A, EDI.REDEM B, EDI.BOND C, EDI.BOCHG D
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID (+)
AND A.SECID=D.SECID (+)
AND B.REDEMDATE IS NOT NULL
AND B.REDEMTYPE <> 'MAT'
AND B.ACTFLAG <> 'D'
AND A.CRF_CINS NOT LIKE '0%'
AND A.CRF_CINS NOT LIKE '1%'
AND A.CRF_CINS NOT LIKE '2%'
AND A.CRF_CINS NOT LIKE '3%'
AND A.CRF_CINS NOT LIKE '4%'
AND A.CRF_CINS NOT LIKE '5%'
AND A.CRF_CINS NOT LIKE '6%'
AND A.CRF_CINS NOT LIKE '7%'
AND A.CRF_CINS NOT LIKE '8%'
AND A.CRF_CINS NOT LIKE '9%'
AND A.ENDDATE IS NULL
AND C.MATURITYDATE > (SYSDATE)
AND ROWNUM < 30000
ORDER BY 1 ASC NULLS LAST



QC975-UAT CHECK
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.MATURITY_D, E.CALL_D, C.CALL_PRICE_L, C.FULL_PART_CALL_C, C.CALLED_AMT_L, C.SUPPLEMENT_D, C.SOURCE_FUNDS_C, C.NOTIFY_SVC_1_C, C.NOTIFY_SVC_2_C, C.ADDED_BY_C, C.ADDED_Z, C.MODIFIED_BY_C, C.MODIFIED_Z, F.ABA_OFFICE_ID_C, F.ABA_N, G.TABLE_ABBRVN_C, H.ADDED_BY_C, H.ADDED_Z, H.MODIFIED_BY_C, H.MODIFIED_Z
FROM KBS.TISSUE_REF A, KBS.TCALLED_ISSUE C, KBS.TCALLED_BOND E, KBS.TFEATURE_ABA F, KBS.TFEATURE_REF G, KBS.TFEATURE_XREF H
WHERE A.ISSUER_ID_C=C.ISSUER_ID_C (+)
AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C (+)
AND C.FEATURE_ID_C=E.FEATURE_ID_C (+)
AND E.FEATURE_ID_C=F.FEATURE_ID_C (+)
AND F.FEATURE_ID_C=G.FEATURE_ID_C (+)
AND G.FEATURE_ID_C=H.FEATURE_ID_C (+)
AND ((A.ISSUER_ID_C = 'B10415' AND A.ISSUE_ALPHA_C = 'AA')
OR (A.ISSUER_ID_C = 'D8283Q' AND A.ISSUE_ALPHA_C = 'AA')
OR (A.ISSUER_ID_C = 'D2552L' AND A.ISSUE_ALPHA_C = 'WF')
OR (A.ISSUER_ID_C = 'B27584' AND A.ISSUE_ALPHA_C = 'BC')
OR (A.ISSUER_ID_C = 'N7S088' AND A.ISSUE_ALPHA_C = 'JE')
OR (A.ISSUER_ID_C = 'T3R4D4' AND A.ISSUE_ALPHA_C = 'AA')
OR (A.ISSUER_ID_C = 'G6494N' AND A.ISSUE_ALPHA_C = 'AA')
OR (A.ISSUER_ID_C = 'P0609E' AND A.ISSUE_ALPHA_C = 'AA')
OR (A.ISSUER_ID_C = 'F83494' AND A.ISSUE_ALPHA_C = 'TQ')
OR (A.ISSUER_ID_C = 'P21850' AND A.ISSUE_ALPHA_C = 'AA')
OR (A.ISSUER_ID_C = 'N6011S' AND A.ISSUE_ALPHA_C = 'AE')
)

JANICE-LIST OF CUSIPS BY TYPE AND WITH FULL CALL (PASSED)
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, A.MATURITY_D, D.CALL_D, C.FULL_PART_CALL_C 
FROM KBS.TISSUE_REF A, KBS.TINST_REF B, KBS.TCALLED_ISSUE C, KBS.TCALLED_BOND D
WHERE A.INST_ID_C=B.INST_ID_C
AND A.ISSUER_ID_C=C.ISSUER_ID_C (+)
AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C (+)
AND C.FEATURE_ID_C=D.FEATURE_ID_C (+)
AND B.INST_TYPE_C= 'FORN'
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND (C.FULL_PART_CALL_C = 'FULL' AND D.CALL_D < (SYSDATE))

TEJ BONDS (NON-MATURED WITH T&C DATA)
SELECT DISTINCT C.SECID, C.ISIN, A.CRF_CINS, B.ISSUEDATE, B.MATURITYDATE, B.INTERESTRATE, B.FIRSTCOUPONDATE AS FC_DATE, B.INTERESTPAYMENTFREQUENCY AS INT_PAY_FREQ, B.INTERESTACCRUALCONVENTION AS DAY_COUNT, B.ISSUEAMOUNT, B.OUTSTANDINGAMOUNT, B.CURENCD AS CURRENCY, B.PARVALUE AS DENOM, B.INTERESTBASIS, B.FRNINDEXBENCHMARK, B.CALLABLE, D.CNTRYOFINCORP, C.ADDEDZ
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B, EDI.SCMST C, EDI.ISSUR D
WHERE C.ISSID = D.ISSID (+)
AND B.SECID=C.SECID (+)
AND B.SECID=A.SECID (+)
AND D.CNTRYOFINCORP IN ('HK', 'MY', 'KR', 'CN', 'JP', 'PH', 'SG', 'VN', 'TH', 'TW', 'ID') 
AND B.MATURITYDATE > (SYSDATE)

CANADIAN BONDS (NON-MATURED WITH T&C DATA)
SELECT DISTINCT C.SECID, C.ISIN, A.CRF_CINS, B.ISSUEDATE, B.MATURITYDATE, B.INTERESTRATE, B.FIRSTCOUPONDATE AS FC_DATE, B.INTERESTPAYMENTFREQUENCY AS INT_PAY_FREQ, B.INTERESTACCRUALCONVENTION AS DAY_COUNT, B.ISSUEAMOUNT, B.OUTSTANDINGAMOUNT, B.CURENCD AS CURRENCY, B.PARVALUE AS DENOM, B.INTERESTBASIS, B.FRNINDEXBENCHMARK, B.CALLABLE, D.CNTRYOFINCORP, C.ADDEDZ
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B, EDI.SCMST C, EDI.ISSUR D
WHERE C.ISSID = D.ISSID (+)
AND B.SECID=C.SECID (+)
AND B.SECID=A.SECID (+)
AND D.CNTRYOFINCORP = 'CA' 
AND B.MATURITYDATE > (SYSDATE)



JANICE-LIST OF GOVT BONDS
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, A.INST_TYPE_C, A.INST_SUBTYPE_C, E.ISSUER_DESC_T AS ISSUER, C.ISSUING_CUSIP_T AS ISSUING_DESC, C.DATED_D AS DATED, C.SECURITY_TYPE_C AS SEC_TYPE, B.COUPON_ORGL_P AS CPN, B.MATURITY_D AS MATURITY, B.ISSUE_ORGL_M AS ORIGINAL, B.ISSUE_OTSD_M AS OUTSTANDING, G.OTL_TEXT_T AS CALL_FEATURE
FROM KBS.TINST_REF A, KBS.TISSUE_REF B, KBS.TISSUING_REF C, KBS.TINT_PAY_CYCLE D, KBS.TISSUER_REF E, KBS.TCRDT_ENHMT_REF F, KBS.TISSUING_OTL G
WHERE A.INST_ID_C=B.INST_ID_C
AND B.ISSUING_ID_C=C.ISSUING_ID_C
AND C.ISSUING_ID_C=D.ISSUING_ID_C
AND A.INST_ID_C=E.INST_ID_C
AND B.ISSUING_ID_C=F.ISSUING_ID_C (+)
AND B.ISSUING_ID_C=G.ISSUING_ID_C (+)
AND A.INST_TYPE_C = 'GOVT'
AND B.MATURITY_D > (SYSDATE)
AND B.MATURITY_TYPE_C <> '*'
AND G.OTL_ID_C = '48'
ORDER BY 1 ASC NULLS LAST


MRC--- MISSING INT PAY DATA
SELECT DISTINCT C.CRF_CINS, C.ISIN, C.SECID, B.INTERESTBASIS, B.ISSUEDATE, B.INTCOMMENCEMENTDATE, B.FIRSTCOUPONDATE, B.INTERESTPAYMENTFREQUENCY, B.MATURITYDATE
FROM EDI.SCMST A, EDI.BOND B, EDI.IDENTIFIER_XREF C
WHERE A.SECID=B.SECID (+)
AND A.SECID=C.SECID (+)
AND C.ENDDATE IS NULL
AND A.ISIN IN ('AT000B002621', 'CH0110335871', 'CH0124295756', 'BE0008260151', 'BE0008280357')


SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.*, C.EDI_DNP_ADDED_BY_C, C.EDI_DNP_ADDED_Z
FROM KBS.TISSUE_REF A, KBS.TINT_PAY_CYCLE B, KBS.TOFFERING_REF C
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C (+)
AND A.OFFERING_ID_C=C.OFFERING_ID_C (+)
AND ((A.ISSUER_ID_C = 'C32148' AND A.ISSUE_ALPHA_C = 'VH')
OR (A.ISSUER_ID_C = 'D171M6' AND A.ISSUE_ALPHA_C = 'AA')
OR (A.ISSUER_ID_C = 'Q3920E' AND A.ISSUE_ALPHA_C = 'BK')
OR (A.ISSUER_ID_C = 'D96098' AND A.ISSUE_ALPHA_C = 'BH')
)


CMA-COMPARISON
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, A.ISIN, A.CUR_ORGL_ID_C AS CURRENCY, B.ASSET_CLAIM_C AS SENIORITY, A.COUPON_ORGL_P, A.MATURITY_D AS MTY, C.CALL_TYPE_C AS CALL_TYPE, B.DATED_D AS ISSUE_DATE , ISSUE_OTSD_M AS OTSD_AMNT
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, CVN.TCALL_DETAIL C
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C (+)
AND A.ISSUING_ID_C=C.ISSUING_ID_C (+)



SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, E.DATED_D AS DATED_DATE, A.MATURITY_D AS MATURITY_DATE, B.DEFAULT_TYPE_C, B.DEFAULT_D AS DEFAULT_DATE, F.MISSED_PYMT_TYPE_C, G.CRDT_RATE_C, H.ISSUER_DESC_T, J1.ABA_N AS PAY_AGENT, J2.ABA_N AS REGISTRAR, J3.ABA_N AS TRUSTEE
FROM KBS.TISSUE_REF A, KBS.TDEFAULTS B, KBS.TFEATURE_REF C, KBS.TFEATURE_XREF D, KBS.TISSUING_REF E, KBS.TDFT_DST_MSSD_PYMT F, KBS.TISSUE_CRDT_RATING G, KBS.TISSUER_REF H, KBS.TABA_REF J1, KBS.TOFFERING_ABA K1, KBS.TABA_REF J2, KBS.TOFFERING_ABA K2, KBS.TABA_REF J3, KBS.TOFFERING_ABA K3 
WHERE A.ISSUE_ID_C = D.ISSUE_ID_C
AND D.FEATURE_ID_C = C.FEATURE_ID_C (+)
AND D.FEATURE_ID_C = B.FEATURE_ID_C (+)
AND C.FEATURE_ID_C=F.FEATURE_ID_C (+)
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND D.ISSUE_ID_C=G.ISSUE_ID_C (+)
AND D.ISSUER_ID_C=H.ISSUER_ID_C (+)
AND A.OFFERING_ID_C=K1.OFFERING_ID_C
AND K1.ABA_OFFICE_ID_C=J1.ABA_OFFICE_ID_C (+)
AND K1.ABA_BRNCH_ID_C=J1.ABA_BRNCH_ID_C (+)
AND A.OFFERING_ID_C=K2.OFFERING_ID_C 
AND K2.ABA_OFFICE_ID_C=J2.ABA_OFFICE_ID_C (+)
AND K2.ABA_BRNCH_ID_C=J2.ABA_BRNCH_ID_C (+)
AND A.OFFERING_ID_C=K3.OFFERING_ID_C 
AND K3.ABA_OFFICE_ID_C=J3.ABA_OFFICE_ID_C (+)
AND K3.ABA_BRNCH_ID_C=J3.ABA_BRNCH_ID_C (+)
AND K1.ABA_REL_TYPE_C='PAYAGENT'
AND K2.ABA_REL_TYPE_C='REGISTRAR'
AND K3.ABA_REL_TYPE_C='TRUSTEE'
AND G.CRDT_RATE_C IN ('D')
AND B.DEFAULT_D IS NOT NULL
AND A.MATURITY_TYPE_C <> '*'
AND B.DEFAULT_D > TO_DATE('01/01/1990','MM/DD/YYYY')
AND A.ISSUER_ID_C NOT IN ('006481', '006996', '00699C', '00699D', '00699B', '006997', '006480', '006999', '006994', '00699A', '006990', '006991', '00699G')


KRISTEN-PUT/REMARKETING REPORT
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, SUBSTR(A.OTL_TEXT_T,1,4) AS PUT_TYPE, TO_DATE(SUBSTR(A.OTL_TEXT_T,5,6), 'MMDDYY') AS PUT_DATE, SUBSTR(A.OTL_TEXT_T,17,3) AS PUT_FREQ
FROM KBS.TISSUING_OTL A, KBS.TISSUE_REF B, KBS.TISSUING_REF C
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C
AND C.SECURITY_TYPE_C = 'BOND'
AND A.OTL_ID_C <> '93'
AND (A.OTL_TEXT_T LIKE 'PUTM%' OR A.OTL_TEXT_T LIKE 'PUTR%' OR A.OTL_TEXT_T LIKE 'PUTC%')
AND TO_DATE(SUBSTR(A.OTL_TEXT_T,5,6),'MM/DD/YY') BETWEEN TO_DATE('08/01/2014','MM/DD/YY') AND TO_DATE('12/31/2014','MM/DD/YY')
AND B.MATURITY_D > (SYSDATE)
AND B.MATURITY_TYPE_C <> '*'
ORDER BY 3 ASC



JANICE-EUROZONE TREASURIES
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, C.INST_TYPE_C AS INST_TYPE, C.INST_SUBTYPE_C AS SUB_TYPE, A.CUR_ORGL_ID_C AS CURR, D.ISSUER_DESC_T AS ISSUER, B.ISSUING_CUSIP_T AS ISS_DESC, B.DATED_D AS DTD, B.SECURITY_TYPE_C AS SEC_TYPE, A.COUPON_ORGL_P AS CPN, A.MATURITY_D AS MTY, A.ISSUE_ORGL_M AS ORGL_AMNT, A.ISSUE_OTSD_M AS OTSD_AMNT
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, KBS.TINST_REF C, KBS.TISSUER_REF D
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.INST_ID_C=C.INST_ID_C
AND A.INST_ID_C=D.INST_ID_C
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND A.CUR_ORGL_ID_C IN ('SEK','NOK', 'CHF')


SELECT DISTINCT B.ISSUING_ID_C, C.INST_TYPE_C AS INST_TYPE, C.INST_SUBTYPE_C AS SUB_TYPE, A.CUR_ORGL_ID_C AS CURR, D.ISSUER_DESC_T AS ISSUER, B.ISSUING_CUSIP_T AS ISS_DESC, B.DATED_D AS DTD, B.SECURITY_TYPE_C AS SEC_TYPE, A.COUPON_ORGL_P AS CPN, A.MATURITY_D AS MTY, A.ISSUE_ORGL_M AS ORGL_AMNT, A.ISSUE_OTSD_M AS OTSD_AMNT
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, KBS.TINST_REF C, KBS.TISSUER_REF D
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.INST_ID_C=C.INST_ID_C
AND A.INST_ID_C=D.INST_ID_C
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND A.CUR_ORGL_ID_C = 'EUR'

GARY- INFRASTRUCTURE BONDS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, B.PURP_TYPE_C AS PURP, B.PURP_CLASS_C AS CLASS, B.PURP_SUB_CLASS_C AS SUB_CLASS, D.ISSUER_DESC_T AS ISSUER, B.ISSUING_CUSIP_T AS ISS_DESC, B.DATED_D AS DTD, B.SECURITY_TYPE_C AS SEC_TYPE, A.COUPON_ORGL_P AS CPN, A.MATURITY_D AS MTY
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, KBS.TINST_REF C, KBS.TISSUER_REF D
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.INST_ID_C=C.INST_ID_C
AND A.INST_ID_C=D.INST_ID_C
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'

NEED MORE PARAMETERS TO REDUCE RESULTS.


MURI-DEFECT TESTING 
SELECT DISTINCT CONCAT(ISS.ISSUER_ID_C,ISS.ISSUE_ALPHA_C) AS CUSIP, X.FEED_ID_C, ISS.OFFERING_ID_C, RTG.CRDT_RATG_AGNCY_C, RTG.CRDT_RATE_TYPE_C, 
RTG.CRDT_RATE_C, RTG.MURI_IND, RTG.ADDED_BY_C, RTG.ADDED_Z, RTG.MODIFIED_BY_C, RTG.MODIFIED_Z, RTG2.CRDT_RATG_AGNCY_C, 
RTG2.CRDT_RATE_TYPE_C, RTG2.CRDT_RATE_C, RTG2.MURI_IND, RTG2.ADDED_BY_C, RTG2.ADDED_Z, RTG2.MODIFIED_BY_C, RTG2.MODIFIED_Z
FROM KBS.TISSUE_REF ISS,
KBS.TISSUE_CRDT_RATING RTG,
KBS.TISSUE_CRDT_RATING RTG2,
KBS.MDYPF_RATINGS_MANAGEMENT X
WHERE ISS.ISSUE_ID_C=RTG.ISSUE_ID_C
AND ISS.ISSUE_ID_C=RTG2.ISSUE_ID_C
AND ISS.ISSUER_ID_C=X.ISSUER_ID_C
AND ISS.ISSUE_ALPHA_C=X.ISSUE_ALPHA_C
AND ISS.MATURITY_D > (SYSDATE)
AND ISS.MATURITY_TYPE_C <> '*'
AND RTG.CRDT_RATG_AGNCY_C = 'MDY'
AND RTG.MURI_IND = 'I'
AND RTG2.CRDT_RATG_AGNCY_C = 'MDU'
AND EXISTS (SELECT DISTINCT 'MDU' FROM KBS.TISSUE_CRDT_RATING WHERE ISSUE_ID_C=ISS.ISSUE_ID_C
AND CRDT_RATG_AGNCY_C = 'MDU'
AND CRDT_RATE_TYPE_C = 'L'
AND (CRDT_RATE_C IS NOT NULL AND CRDT_RATE_C <> 'N/R')
)
ORDER BY 1 ASC NULLS LAST

QC1114-QUERY 
SELECT DISTINCT  A.CRF_CINS, A.ISIN, A.SECID, B.INTERESTBASIS, B.ISSUEDATE, B.MATURITYDATE, B.FIRSTCOUPONDATE, B.INTCOMMENCEMENTDATE, B.INTERESTPAYMENTFREQUENCY, B.INTERESTACCRUALCONVENTION
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B
WHERE A.SECID=B.SECID
AND B.MATURITYDATE > (SYSDATE)
AND A.CRF_CINS NOT LIKE '0%'
AND A.CRF_CINS NOT LIKE '1%'
AND A.CRF_CINS NOT LIKE '2%'
AND A.CRF_CINS NOT LIKE '3%'
AND A.CRF_CINS NOT LIKE '4%'
AND A.CRF_CINS NOT LIKE '5%'
AND A.CRF_CINS NOT LIKE '6%'
AND A.CRF_CINS NOT LIKE '7%'
AND A.CRF_CINS NOT LIKE '8%'
AND A.CRF_CINS NOT LIKE '9%'
AND A.ENDDATE IS NULL
AND ROWNUM < 1000

QC1114-UAT SCRIPT
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, A.ISIN, B.DATED_D, A.MATURITY_D, B.ACCRUAL_COUNT_C, B.RECORD_DATE_Q, B.RECORD_DATE_C, B.PAYMENT_FORM_C, B.PAYMENT_OBLGN_C, C.ACCRUAL_FIRST_D, C.PAYMENT_FIRST_D, C.INT_PAY_TYPE_C, C.FREQ_PER_OCCUR_Q, C.FREQ_PERIOD_C, C.FREQ_Q, C.FREQ_DAY_C
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, KBS.TINT_PAY_CYCLE C
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C (+)
AND ((A.ISSUER_ID_C = 'X17447' AND A.ISSUE_ALPHA_C = '11')
OR (A.ISSUER_ID_C = 'G9213D' AND A.ISSUE_ALPHA_C = 'AW')
OR (A.ISSUER_ID_C = 'Y07013' AND A.ISSUE_ALPHA_C = '28')
OR (A.ISSUER_ID_C = 'G6754J' AND A.ISSUE_ALPHA_C = 'AC')
OR (A.ISSUER_ID_C = 'L015A7' AND A.ISSUE_ALPHA_C = 'AX')
OR (A.ISSUER_ID_C = 'G9105L' AND A.ISSUE_ALPHA_C = 'AB')
OR (A.ISSUER_ID_C = 'G92450' AND A.ISSUE_ALPHA_C = 'LU')
OR (A.ISSUER_ID_C = 'T1188J' AND A.ISSUE_ALPHA_C = 'ED')
)

ANDREW- ZEROS WITH CALLED BOND AT 100
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, C.OTL_TEXT_T, D.CALL_PRICE_L
FROM KBS.TINST_REF A, KBS.TISSUE_REF B, KBS.TISSUING_OTL C, KBS.TCALLED_ISSUE D
WHERE A.INST_ID_C=B.INST_ID_C 
AND B.ISSUING_ID_C=C.ISSUING_ID_C
AND (B.ISSUER_ID_C=D.ISSUER_ID_C
AND B.ISSUE_ALPHA_C=D.ISSUE_ALPHA_C)
AND A.INST_TYPE_C = 'MUNI'
AND B.MATURITY_D > (SYSDATE)
AND B.MATURITY_TYPE_C <> '*'
AND (C.OTL_TEXT_T LIKE 'CPA%'
OR C.OTL_TEXT_T LIKE 'ZER%' )
AND D.CALL_PRICE_L = 100
AND B.ISSUER_ID_C NOT LIKE '00699%'
ORDER BY 1 ASC


GARY-SPAN
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, D.ISSUER_DESC_T AS ISSUER, C.ISSUING_CUSIP_T AS ISSUER_DESC, B.OFFERING_ID_C, E1.CRDT_RATE_C AS SP_RTG, E2.CRDT_RATE_C AS SPE_RTG, E3.CRDT_RATE_C AS SPU_RTG
FROM KBS.TINST_REF A, KBS.TISSUE_REF B, KBS.TISSUING_REF C, KBS.TISSUER_REF D, KBS.TISSUE_CRDT_RATING E1, KBS.TISSUE_CRDT_RATING E2, KBS.TISSUE_CRDT_RATING E3
WHERE A.INST_ID_C=B.INST_ID_C 
AND B.ISSUING_ID_C=C.ISSUING_ID_C
AND A.INST_ID_C=D.INST_ID_C
AND B.ISSUE_ID_C=E1.ISSUE_ID_C (+)
AND B.ISSUE_ID_C=E2.ISSUE_ID_C (+)
AND B.ISSUE_ID_C=E3.ISSUE_ID_C (+)
AND B.MATURITY_D > (SYSDATE)
AND B.MATURITY_TYPE_C <> '*'
AND 'SP'= E1.CRDT_RATG_AGNCY_C (+)
AND 'SPE'= E2.CRDT_RATG_AGNCY_C (+)
AND 'SPU'= E3.CRDT_RATG_AGNCY_C (+)


EDI-CALLED BOND RECORD THAT DO NOT HAVE EDI_DNP CHECKED & NO CALLED BOND UPDATED
SELECT DISTINCT A.CRF_CINS, A.ISIN, A.SECID, B.ACTFLAG, B.REDEMDATE, B.PRICEASPERCENT, B.PREMIUMASPERCENT, B.REDEMPRICE, C.PARVALUE, B.REDEMTYPE, B.PARTFINAL, B.AMOUNTREDEEMED, D.EFFECTIVEDATE, D.OLDOUTVALUE, D.NEWOUTVALUE 
FROM EDI.IDENTIFIER_XREF A, EDI.REDEM B, EDI.BOND C, EDI.BOCHG D , KBS.TOFFERING_REF E, KBS.TISSUE_REF F
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID (+)
AND A.SECID=D.SECID (+)
AND ((SUBSTR(A.CRF_CINS,1,6) = F.ISSUER_ID_C)
AND (SUBSTR(A.CRF_CINS,7,2) = F.ISSUE_ALPHA_C))
AND E.OFFERING_ID_C=F.OFFERING_ID_C
AND E.EDI_DNP_ADDED_BY_C IS NULL
AND NOT EXISTS (
SELECT DISTINCT ISSUER_ID_C FROM KBS.TCALLED_ISSUE WHERE ISSUER_ID_C=F.ISSUER_ID_C)
AND B.REDEMDATE IS NOT NULL
AND B.REDEMTYPE <> 'MAT'
AND B.PARTFINAL = 'P'
AND B.ACTFLAG <> 'D'
AND A.CRF_CINS NOT LIKE '0%'
AND A.CRF_CINS NOT LIKE '1%'
AND A.CRF_CINS NOT LIKE '2%'
AND A.CRF_CINS NOT LIKE '3%'
AND A.CRF_CINS NOT LIKE '4%'
AND A.CRF_CINS NOT LIKE '5%'
AND A.CRF_CINS NOT LIKE '6%'
AND A.CRF_CINS NOT LIKE '7%'
AND A.CRF_CINS NOT LIKE '8%'
AND A.CRF_CINS NOT LIKE '9%'
AND A.ENDDATE IS NULL
AND A.SOURCEID = 'CP360'
AND C.MATURITYDATE > (SYSDATE)
AND ROWNUM < 30000
ORDER BY 1 ASC NULLS LAST


EDI-CONVERTIBLE QUERY
SELECT DISTINCT A.SECID, A.ISIN, A.CRF_CINS, A.ENDDATE, C.ACTFLAG, B.ISSUEDATE, C.FROMDATE, C.TODATE, B.MATURITYDATE, C.PRICE, C.RATIONEW, C.RESSECTYCD, E.FEATURE_ID_C, H.EDI_DNP_ADDED_BY_C
FROM EDI.IDENTIFIER_XREF A , EDI.BOND B, EDI.CONVT C, KBS.TCONVERTIBLE_REF E, KBS.TISSUE_REF F, KBS.TFEATURE_XREF G , KBS.TOFFERING_REF H
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID
AND ((SUBSTR(A.CRF_CINS,1,6) = F.ISSUER_ID_C)
AND (SUBSTR(A.CRF_CINS,7,2) = F.ISSUE_ALPHA_C))
AND (F.ISSUER_ID_C=G.ISSUER_ID_C (+)
AND F.ISSUE_ALPHA_C=G.ISSUE_ALPHA_C (+)) 
AND G.FEATURE_ID_C=E.FEATURE_ID_C (+)
AND F.OFFERING_ID_C=H.OFFERING_ID_C
AND A.CRF_CINS NOT LIKE '0%'
AND A.CRF_CINS NOT LIKE '1%'
AND A.CRF_CINS NOT LIKE '2%'
AND A.CRF_CINS NOT LIKE '3%'
AND A.CRF_CINS NOT LIKE '4%'
AND A.CRF_CINS NOT LIKE '5%'
AND A.CRF_CINS NOT LIKE '6%'
AND A.CRF_CINS NOT LIKE '7%'
AND A.CRF_CINS NOT LIKE '8%'
AND A.CRF_CINS NOT LIKE '9%'
AND C.ACTFLAG <> 'D'
AND C.RESSECTYCD IN ('EQS', 'PRF')
AND F.MATURITY_D > (SYSDATE)
AND (C.FROMDATE IS NOT NULL OR C.TODATE IS NOT NULL)
AND ROWNUM < 50000
ORDER BY 2,3,7 ASC NULLS LAST


CHECK TO SEE IF CALLED BOND EXISTS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.FEATURE_ID_C, B.CALL_D, C.CALL_PRICE_L, C.CALLED_AMT_L
FROM KBS.TISSUE_REF A, KBS.TCALLED_BOND B, KBS.TCALLED_ISSUE C
WHERE (A.ISSUER_ID_C=C.ISSUER_ID_C (+)
AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C (+))
AND C.FEATURE_ID_C=B.FEATURE_ID_C (+)
AND (A.ISSUER_ID_C = '480797' AND A.ISSUE_ALPHA_C = 'AM')
ORDER BY 1,3 ASC


LIZ-ABA'S NOT ADDED BY ABA FEED
SELECT DISTINCT  CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, B.ABA_N, C.ABA_REL_TYPE_C, B.ADDED_BY_C AS BANK_CREATED_BY, B.ADDED_Z, C.ADDED_BY_C AS AGT_ADDED_TO_MB_BY, C.ADDED_Z
FROM KBS.TISSUE_REF A, KBS.TABA_REF B, KBS.TOFFERING_ABA C
WHERE A.OFFERING_ID_C=C.OFFERING_ID_C (+)
AND C.ABA_OFFICE_ID_C=B.ABA_OFFICE_ID_C (+)
AND C.ABA_BRNCH_ID_C=B.ABA_BRNCH_ID_C (+)
AND B.ABA_OFFICE_ID_C IN (99999115, 99999114, 99999113, 99999112, 99999111, 99999110, 99999109, 99999108, 99999107, 99999106, 99999105, 99999104, 99999103, 99999102, 99999101, 99999100
)


LIZ-CORP CREDIT ENHANCEMENTS WITH UNKNOWN EXP
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP8, G1.INST_TYPE_C AS TYPE, B.OFFERING_ID_C AS OFFERING, D.ISSUER_DESC_T AS ISSUER, A.SECURITY_TYPE_C AS SEC_TYPE, A.DATED_D AS DTD, B.MATURITY_D AS MTY_DATE, E.CRDT_ENHMT_END_D AS EXP_DATE, E. CRDT_ENHMT_EXP_C AS EXP_CODE, E.CRDT_ENHMT_TYPE_C AS CRDT_TYPE, G.INST_N AS ENHMT_PROVIDER
FROM KBS.TISSUING_REF A, KBS.TISSUE_REF B, KBS.TISSUER_REF D, KBS.TINST_REF G, KBS.TINST_REF G1, KBS.TCRDT_ENHMT_REF E, KBS.TCRDT_ENHMT_INST F, KBS.TCALLED_ISSUE H, KBS.TCALLED_BOND I
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND B.ISSUER_ID_C=D.ISSUER_ID_C 
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND E.CRDT_ENHMT_ID_C=F.CRDT_ENHMT_ID_C 
AND F.INST_ID_C=G.INST_ID_C 
AND B.INST_ID_C=G1.INST_ID_C
AND B.ISSUER_ID_C=H.ISSUER_ID_C
AND B.ISSUE_ALPHA_C=H.ISSUE_ALPHA_C
AND H.FEATURE_ID_C=I.FEATURE_ID_C
AND G1.INST_TYPE_C IN ('CORP', 'MUNI')
AND B.MATURITY_D > (SYSDATE)
AND B.MATURITY_TYPE_C <> '*'
AND A.SECURITY_TYPE_C NOT IN ('SHFL','INVF','LINK','TR','INDX','CP','CAP','DERI','LINK','PAYS','POOL')
AND E.CRDT_ENHMT_TYPE_C IN ('LOC','GTD','LIQF','SYB','BPA','LIC','SLC','CLC')
AND (E.CRDT_ENHMT_EXP_C = 'UNKNWN' OR (E.CRDT_ENHMT_END_D < (SYSDATE) +14 AND E.CRDT_ENHMT_END_D > (SYSDATE)))
AND E.CRDT_ENHMT_EXP_C <> 'EXPIRE'

AND NOT EXISTS (
SELECT DISTINCT 'COMPLETECALL' 
FROM KBS.TCALLED_ISSUE CISS, KBS.TCALLED_BOND CBND
WHERE CISS.ISSUER_ID_C = B.ISSUER_ID_C
AND CISS.ISSUE_ALPHA_C = B.ISSUE_ALPHA_C
AND CISS.FULL_PART_CALL_C ='FULL'
AND CBND.FEATURE_ID_C = CISS.FEATURE_ID_C)

AND NOT EXISTS (
SELECT DISTINCT 'PREF'
FROM KBS.TPREREFUNDED_REF
WHERE ISSUING_ID_C = A.ISSUING_ID_C
AND TRIM(PREF_TYPE_C) IN ('PREF', 'ETM') )
ORDER BY 8 ASC


GARY-ALL S&P RATED CUSIPS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, E.ISSUER_DESC_T AS ISSUER, D.ISSUING_CUSIP_T AS ISSUING_DESC, D.DATED_D AS DTD, A.COUPON_ORGL_P AS CPN, A.OFFERING_ID_C AS OFFERING, F.PRELIM_INFO_C
FROM KBS.TISSUE_REF A, KBS.TINST_REF B, KBS.TISSUE_CRDT_RATING C, KBS.TISSUING_REF D, KBS.TISSUER_REF E, KBS.TOFFERING_REF F 
WHERE A.INST_ID_C=B.INST_ID_C
AND A.ISSUE_ID_C=C.ISSUE_ID_C (+)
AND A.ISSUING_ID_C=D.ISSUING_ID_C
AND A.ISSUING_ID_C=D.ISSUING_ID_C
AND A.OFFERING_ID_C=F.OFFERING_ID_C
AND B.INST_TYPE_C = 'MUNI'
AND A.MATURITY_D > (SYSDATE)
AND C.CRDT_RATG_AGNCY_C IN ('SP', 'SPU', 'SPE')
AND C.CRDT_RATE_C IS NOT NULL
AND C.CRDT_RATE_C <> 'N/R'
AND NOT EXISTS
(
SELECT DISTINCT 'COMPLETECALL' 
FROM KBS.TCALLED_ISSUE Z, KBS.TCALLED_BOND W
WHERE Z.ISSUER_ID_C = A.ISSUER_ID_C
AND Z.ISSUE_ALPHA_C = A.ISSUE_ALPHA_C
AND Z.FULL_PART_CALL_C ='FULL'
AND W.CALL_D < (SYSDATE)
AND W.FEATURE_ID_C = Z.FEATURE_ID_C
)
AND EXISTS (
SELECT DISTINCT X.OFFERING_ID_C 
FROM KBS.TINFO_SOURCE X 
WHERE X.OFFERING_ID_C=A.OFFERING_ID_C 
AND X.INFO_SOURCE_C IN ('OFST','KIS','NIIDS','NIIDT','NIIDP','DALFP','DALCW','DALPP','DALR','FACT','OSAM','OSRM','OSCA','OSRA','OSCD')
)

ORDER BY 1 ASC


DEALS THAT PAY AT MTY BUT HAVE FC DATE POPULATED
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.ISSUING_ID_C, A.MATURITY_D, B.PAYMENT_FIRST_D, B.FREQ_PERIOD_C 
FROM KBS.TISSUE_REF A, KBS.TINT_PAY_CYCLE B
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.MATURITY_D = B.PAYMENT_FIRST_D
AND B.FREQ_PERIOD_C = 'MAT'
AND A.MATURITY_D > (SYSDATE)
AND (A.ISSUER_ID_C LIKE '0%'
OR A.ISSUER_ID_C LIKE '1%'
OR A.ISSUER_ID_C LIKE '2%'
OR A.ISSUER_ID_C LIKE '3%'
OR A.ISSUER_ID_C LIKE '4%'
OR A.ISSUER_ID_C LIKE '5%'
OR A.ISSUER_ID_C LIKE '6%'
OR A.ISSUER_ID_C LIKE '7%'
OR A.ISSUER_ID_C LIKE '8%'
OR A.ISSUER_ID_C LIKE '9%'
)

KATHLEEN-GAP ANALYSIS OF DB CUSIP FEED
SELECT DISTINCT CONCAT(A.ISSUER_NUM,A.ISSUE_NUM) AS CUSIP, A.FEED_ID_C, A.DATED_DT, A.MATURITY_DT, A.RATE, B.FIRST_COUPON_DT, B.PAYMENT_FREQUENCY 
FROM KBS.TCUSIP_ISSUE A, KBS.TCUSIP_ISSUE_ATTR B, KBS.TCUSIP_EXT_ATTR C
WHERE A.FEED_ID_C=B.FEED_ID_C
AND A.ISSUER_NUM=B.ISSUER_NUM
AND A.ISSUE_NUM=B.ISSUE_NUM
AND A.FEED_ID_C=C.FEED_ID_C
AND A.ISSUER_NUM=C.ISSUER_NUM
AND A.ISSUE_NUM=C.ISSUE_NUM
AND A.ADDED_BY_C = 'CUSIPDB'
AND A.ADDED_Z BETWEEN TO_TIMESTAMP('06/01/2014','MM/DD/YYYY') AND TO_TIMESTAMP('06/15/2014','MM/DD/YYYY')


QC1123-TEST DATA
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, B.MATURITY_D, B.ISSUE_OTSD_M, C.FULL_PART_CALL_C, E.CALL_D, C.CALL_PRICE_L, B.ISSUING_ID_C 
FROM KBS.TISSUE_REF B, KBS.TCALLED_ISSUE C, KBS.TCALLED_BOND E
WHERE B.ISSUER_ID_C=C.ISSUER_ID_C
AND B.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C
AND C.FEATURE_ID_C=E.FEATURE_ID_C
AND B.MATURITY_D > (SYSDATE)
AND NOT EXISTS (
SELECT DISTINCT 'FULL' 
FROM KBS.TCALLED_ISSUE Y
WHERE B.ISSUER_ID_C=Y.ISSUER_ID_C
AND B.ISSUE_ALPHA_C=Y.ISSUE_ALPHA_C 
AND Y.FULL_PART_CALL_C = 'FULL')
ORDER BY 1 ASC NULLS LAST

QC1140-EDI BONDS THAT PAY AT MTY
SELECT DISTINCT A.CRF_CINS, A.ISIN, A.SECID, B.ISSUEDATE, B.MATURITYDATE, B.INTCOMMENCEMENTDATE, B.FIRSTCOUPONDATE, B.INTERESTPAYMENTFREQUENCY, D.*, E. EDI_DNP_ADDED_BY_C
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B, KBS.TISSUE_REF C, KBS.TINT_PAY_CYCLE D, KBS.TOFFERING_REF E
WHERE A.SECID=B.SECID
AND B.MATURITYDATE=FIRSTCOUPONDATE
AND B.INTERESTPAYMENTFREQUENCY = 'ITM'
AND ((SUBSTR(A.CRF_CINS,1,6) = C.ISSUER_ID_C)
AND (SUBSTR(A.CRF_CINS,7,2) = C.ISSUE_ALPHA_C))
AND C.ISSUING_ID_C=D.ISSUING_ID_C
AND C.OFFERING_ID_C=E.OFFERING_ID_C
AND C.COUPON_ORGL_P > 0
AND D.PAYMENT_FIRST_D IS NOT NULL
AND A.CRF_CINS NOT LIKE '0%'
AND A.CRF_CINS NOT LIKE '1%'
AND A.CRF_CINS NOT LIKE '2%'
AND A.CRF_CINS NOT LIKE '3%'
AND A.CRF_CINS NOT LIKE '4%'
AND A.CRF_CINS NOT LIKE '5%'
AND A.CRF_CINS NOT LIKE '6%'
AND A.CRF_CINS NOT LIKE '7%'
AND A.CRF_CINS NOT LIKE '8%'
AND A.CRF_CINS NOT LIKE '9%'

ORDER BY 1 ASC


PERPETUITY WITHOUT A FULL CALL
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, A.OFFERING_ID_C, A.ISSUING_ID_C, B.DATED_D AS DATED_DATE, A.MATURITY_TYPE_C, A.MATURITY_D
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, KBS.TCALLED_ISSUE C
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUER_ID_C=C.ISSUER_ID_C (+)
AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C (+)
AND A.MATURITY_TYPE_C = 'P'
AND NOT EXISTS (
SELECT DISTINCT ISSUER_ID_C, ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE 
WHERE ISSUER_ID_C=A.ISSUER_ID_C
AND ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND FULL_PART_CALL_C = 'FULL')

ORDER BY 6 ASC NULLS LAST



RATINGS/LUW TIMESTAMPS
SELECT DISTINCT A.*, B.*, C.*
FROM KBS.TISSUE_REF A, KBS.TISSUE_CRDT_RATING B, TOFFERING_LUW_HIST C
WHERE A.ISSUE_ID_C=B.ISSUE_ID_C
AND A.OFFERING_ID_C=C.OFFERING_ID_C
AND (A.ISSUER_ID_C = '00699B' AND A.ISSUE_ALPHA_C = 'BJ')


MELISSA-FULL CALLS WITH AMOUNTS AND MULT_ISSUE_OTSD>0 (WITH OTSD_AMOUNT_HISTORY)
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, F.DATED_D AS DTD, A.COUPON_ORGL_P AS CPN, A.MTY_D, E.CALL_D, C.CALL_PRICE_L, C.CALLED_AMT_L AS CALLED_AMNT, C.SOURCE_FUNDS_C AS SOURCE, A.ISSUE_OTSD_M AS MULT_ISSUE_OTSD, G.OTSD_AMT_EFFECT_D, G.OTSD_AMT AS OTSD_AMT_HISTORY  
FROM KBS.TINST_REF B, KBS.TISSUE_REF A, KBS.TCALLED_ISSUE C, KBS.TCALLED_BOND E, KBS.TISSUING_REF F, KBS.OUTSTANDING_AMT_SCHEDULE G
WHERE B.INST_ID_C=A.INST_ID_C
AND (A.ISSUER_ID_C=C.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C)
AND A.ISSUING_ID_C=F.ISSUING_ID_C
AND C.FEATURE_ID_C=E.FEATURE_ID_C
AND A.ISSUER_ID_C=G.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=G.ISSUE_ALPHA_C
AND A.MATURITY_D > (SYSDATE)
AND (C.FULL_PART_CALL_C = 'FULL' AND C.CALLED_AMT_L > 0)
AND A.ISSUE_OTSD_M > 0
AND G.OTSD_AMT_EFFECT_D = (SELECT DISTINCT MAX(OTSD_AMT_EFFECT_D) FROM KBS.OUTSTANDING_AMT_SCHEDULE WHERE ISSUER_ID_C = A.ISSUER_ID_C AND ISSUE_ALPHA_C = A.ISSUE_ALPHA_C)
ORDER BY 1 ASC

MELISSA-FULL CALLS WITH AMOUNTS AND MULT_ISSUE_OTSD>0 (WITHOUT OTSD_AMOUNT_HISTORY)
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, F.DATED_D AS DTD, A.COUPON_ORGL_P AS CPN, A.MTY_D, E.CALL_D, C.CALL_PRICE_L, C.CALLED_AMT_L AS CALLED_AMNT, C.SOURCE_FUNDS_C AS SOURCE, A.ISSUE_OTSD_M AS MULT_ISSUE_OTSD
FROM KBS.TINST_REF B, KBS.TISSUE_REF A, KBS.TCALLED_ISSUE C, KBS.TCALLED_BOND E, KBS.TISSUING_REF F
WHERE B.INST_ID_C=A.INST_ID_C
AND (A.ISSUER_ID_C=C.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C)
AND A.ISSUING_ID_C=F.ISSUING_ID_C
AND C.FEATURE_ID_C=E.FEATURE_ID_C
AND A.MATURITY_D > (SYSDATE)
AND (C.FULL_PART_CALL_C = 'FULL' AND C.CALLED_AMT_L > 0)
AND A.ISSUE_OTSD_M > 0
ORDER BY 1 ASC




SELECT DISTINCT CISS.* FROM KBS.TCALLED_ISSUE CISS
WHERE NOT EXISTS (
SELECT DISTINCT 'CALLBOND' FROM KBS.TCALLED_BOND WHERE FEATURE_ID_C = CISS.FEATURE_ID_C)
AND NOT EXISTS (
SELECT DISTINCT 'FEATREF' FROM KBS.TFEATURE_REF WHERE FEATURE_ID_C = CISS.FEATURE_ID_C)
AND NOT EXISTS (
SELECT DISTINCT 'FEATXREF' FROM KBS.TFEATURE_XREF WHERE FEATURE_ID_C = CISS.FEATURE_ID_C)


GARY-MISSING OBLIGOR / CC6 REPORT
SELECT DISTINCT B.ISSUING_ID_C AS ISSUING, B.OFFERING_ID_C AS OFFERING, B.DATED_D AS DTD, B.PURP_TYPE_C AS PURP, B.PURP_CLASS_C AS CLASS, B.PURP_SUB_CLASS_C AS SUBCL, D.ISSUER_DESC_T AS ISSUER, B.ISSUING_CUSIP_T AS ISSUING_DESC, E.CRDT_ENHMT_TYPE_C AS AO_TYPE, G.INST_ID_C AS INSTITUTION, G.INST_N AS OBLIGOR , G.INST_CC6 AS CC6, D1.ISSUER_DESC_T AS CC6_INST, E.CRDT_ENHMT_EFF_D AS EFF_DATE, E.CRDT_ENHMT_END_D AS EXPIR_DATE, E. CRDT_ENHMT_EXP_C AS EXPIR_CODE, F.COVERAGE_P AS PCT,F.PRINCIPAL_L AS AMT
FROM KBS.TOFFERING_REF A, KBS.TISSUING_REF B, KBS.TISSUER_REF D, KBS.TINST_REF G, KBS.TCRDT_ENHMT_REF E, KBS.TCRDT_ENHMT_INST F, KBS.TISSUER_REF D1 
WHERE A.OFFERING_ID_C=B.OFFERING_ID_C
AND A.INST_ID_C=D.INST_ID_C
AND B.ISSUING_ID_C=E.ISSUING_ID_C (+)
AND E.CRDT_ENHMT_ID_C=F.CRDT_ENHMT_ID_C (+)
AND F.INST_ID_C=G.INST_ID_C (+)
AND G.INST_CC6 = D1.ISSUER_ID_C (+)
AND 'BPA' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'CLC' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'CLL' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'GIC' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'INSN' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'LIQF' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'LOC' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'SLC' <> E.CRDT_ENHMT_TYPE_C (+) 
AND 'SYB' <> E.CRDT_ENHMT_TYPE_C (+)
AND B.DATED_D > (SYSDATE-14)
AND (E.CRDT_ENHMT_TYPE_C IS NULL OR G.INST_CC6 IS NULL)
AND G.INST_TYPE_C IN ('MUNI', 'CORP')
ORDER BY 10 ASC NULLS LAST


EDI-UNDERWRITER QUERY
SELECT DISTINCT C.CRF_CINS, C.ISIN, A.*, B.*
FROM EDI.SCAGY A, EDI.AGNCY B , EDI.IDENTIFIER_XREF C
WHERE A.AGNCYID = B.AGNCYID
AND A.SECID=C.SECID
AND A.RELATIONSHIP = 'UNW'


GARY-VARIABLES WITH A YIELD/PRICE POPULATED
SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, A.INST_TYPE_C, D.DATED_D AS DTD, B.MATURITY_D AS MTY, SUBSTR(C.OTL_TEXT_T,12,2) AS VAR_FREQ, B.OFFERING_YIELD_P AS YIELD, B.OFFERING_PRICE_P AS PRICE 
FROM KBS.TINST_REF A, KBS.TISSUE_REF B, KBS.TISSUING_OTL C, KBS.TISSUING_REF D
WHERE A.INST_ID_C=B.INST_ID_C
AND B.ISSUING_ID_C=C.ISSUING_ID_C
AND B.ISSUING_ID_C=D.ISSUING_ID_C
AND C.OTL_ID_C ='44'
AND SUBSTR(C.OTL_TEXT_T,12,2) IN ('WK','DY','MO')
AND (B.OFFERING_YIELD_P <> 0
OR B.OFFERING_PRICE_P <> 0)
AND B.MATURITY_D > (SYSDATE)
AND B.MATURITY_TYPE_C <> '*'




SDM-LIST ALL CREDIT ENHANCEMENTS
SELECT DISTINCT CONCAT(A1.ISSUER_ID_C,A1.ISSUE_ALPHA_C) AS CUSIP, A1.CRDT_ENHMT_ID_C, 
  A1.CRDT_ENHMT_SUB_C, 
  A1.CRDT_ENHMT_EFF_D, A1.CRDT_ENHMT_END_D, A1.CRDT_ENHMT_EXP_C, 
  A1.CRDT_ENHMT_EXP_Q, B1.INST_N, 

CONCAT(A2.ISSUER_ID_C,A2.ISSUE_ALPHA_C) AS CUSIP, A2.CRDT_ENHMT_ID_C, 
  A2.CRDT_ENHMT_SUB_C, 
  A2.CRDT_ENHMT_EFF_D, A2.CRDT_ENHMT_END_D, A2.CRDT_ENHMT_EXP_C, 
  A2.CRDT_ENHMT_EXP_Q, B2.INST_N  

FROM KBS.TCRDT_ENHMT_REF A1, KBS.TCRDT_ENHMT_REF A2, KBS.TCRDT_ENHMT_REF A3, KBS.TCRDT_ENHMT_REF A4, KBS.TCRDT_ENHMT_REF A5,
KBS.TINST_REF B1, KBS.TINST_REF B2, KBS.TINST_REF B3,
KBS.TINST_REF B4, KBS.TINST_REF B5 

WHERE A1.INST_SUB_ID_1_C=B1.INST_SUB_ID_C
AND A2.INST_SUB_ID_2_C=B2.INST_SUB_ID_C
AND A3.INST_SUB_ID_3_C=B3.INST_SUB_ID_C
AND A4.INST_SUB_ID_4_C=B4.INST_SUB_ID_C
AND A5.INST_SUB_ID_5_C=B5.INST_SUB_ID_C
AND (A1. ISSUER_ID_C = '92851R' AND A1. ISSUE_ALPHA_C = 'AD')
AND (A2. ISSUER_ID_C = '92851R' AND A2. ISSUE_ALPHA_C = 'AD')
AND (A3. ISSUER_ID_C = '92851R' AND A3. ISSUE_ALPHA_C = 'AD')
AND (A4. ISSUER_ID_C = '92851R' AND A4. ISSUE_ALPHA_C = 'AD')
AND (A5. ISSUER_ID_C = '92851R' AND A5. ISSUE_ALPHA_C = 'AD')



CHECK DEFAULT/DISTRIBUTION BY CUSIP
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.DEFAULT_TYPE_C, B.DEFAULT_D, C.DISTRIB_TYPE_C, C.DISTRIBUTION_D 
FROM KBS.TFEATURE_XREF A, KBS.TDEFAULTS B, KBS.TDISTRIBUTIONS C
WHERE A.FEATURE_ID_C=B.FEATURE_ID_C
AND A.FEATURE_ID_C=C.DEFAU_FEATURE_ID_C
AND ((A.ISSUER_ID_C = '658905' AND A.ISSUE_ALPHA_C = 'DY')
OR (A.ISSUER_ID_C = '83755L' AND A.ISSUE_ALPHA_C = 'RS')
OR (A.ISSUER_ID_C = '56052U' AND A.ISSUE_ALPHA_C = 'BF')
OR (A.ISSUER_ID_C = '76222R' AND A.ISSUE_ALPHA_C = 'JZ')
OR (A.ISSUER_ID_C = '83755L' AND A.ISSUE_ALPHA_C = 'NP')
OR (A.ISSUER_ID_C = '924156' AND A.ISSUE_ALPHA_C = 'AA')
OR (A.ISSUER_ID_C = '65901D' AND A.ISSUE_ALPHA_C = 'AN')
OR (A.ISSUER_ID_C = '443527' AND A.ISSUE_ALPHA_C = 'CP')
OR (A.ISSUER_ID_C = '130905' AND A.ISSUE_ALPHA_C = 'EJ')
OR (A.ISSUER_ID_C = '61204R' AND A.ISSUE_ALPHA_C = 'AR')
OR (A.ISSUER_ID_C = '837542' AND A.ISSUE_ALPHA_C = 'AR')
OR (A.ISSUER_ID_C = '179864' AND A.ISSUE_ALPHA_C = 'DW')
OR (A.ISSUER_ID_C = '647110' AND A.ISSUE_ALPHA_C = 'FF')
OR (A.ISSUER_ID_C = '658877' AND A.ISSUE_ALPHA_C = 'BR')
OR (A.ISSUER_ID_C = '641461' AND A.ISSUE_ALPHA_C = 'NQ')
)
ORDER BY 1 ASC


DEFAULTS AND DISTRIBUTIONS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, A.FEATURE_ID_C, B.TABLE_ABBRVN_C 
FROM KBS.TFEATURE_XREF A, KBS.TFEATURE_REF B
WHERE A.FEATURE_ID_C=B.FEATURE_ID_C
AND ((A.ISSUER_ID_C = '658905' AND A.ISSUE_ALPHA_C = 'DY')
OR (A.ISSUER_ID_C = '83755L' AND A.ISSUE_ALPHA_C = 'RS')
OR (A.ISSUER_ID_C = '56052U' AND A.ISSUE_ALPHA_C = 'BF')
OR (A.ISSUER_ID_C = '76222R' AND A.ISSUE_ALPHA_C = 'JZ')
OR (A.ISSUER_ID_C = '83755L' AND A.ISSUE_ALPHA_C = 'NP')
OR (A.ISSUER_ID_C = '924156' AND A.ISSUE_ALPHA_C = 'AA')
OR (A.ISSUER_ID_C = '65901D' AND A.ISSUE_ALPHA_C = 'AN')
OR (A.ISSUER_ID_C = '443527' AND A.ISSUE_ALPHA_C = 'CP')
OR (A.ISSUER_ID_C = '130905' AND A.ISSUE_ALPHA_C = 'EJ')
OR (A.ISSUER_ID_C = '61204R' AND A.ISSUE_ALPHA_C = 'AR')
OR (A.ISSUER_ID_C = '837542' AND A.ISSUE_ALPHA_C = 'AR')
OR (A.ISSUER_ID_C = '179864' AND A.ISSUE_ALPHA_C = 'DW')
OR (A.ISSUER_ID_C = '647110' AND A.ISSUE_ALPHA_C = 'FF')
OR (A.ISSUER_ID_C = '658877' AND A.ISSUE_ALPHA_C = 'BR')
OR (A.ISSUER_ID_C = '641461' AND A.ISSUE_ALPHA_C = 'NQ')
)
AND B.TABLE_ABBRVN_C IN ('TDEFAULT', 'TDISTRIB')
AND A.FEATURE_ID_C IN (4185431, 4185439, 4185442, 4185602, 4185615, 4185623, 4185625, 4185669, 4185671, 4185673, 4185675, 4185677, 4185432, 4185603, 4185624, 4185443, 4185616, 4185626, 4185670, 4185676, 4185674, 4185672, 4185678, 4185444, 4185445)
ORDER BY 1,3,2 ASC


SPECIFIC TEST FILES
SELECT DISTINCT  CONCAT(B.ISSUER_ID_C,B.ISSUE_ALPHA_C) AS CUSIP, A.*
FROM KBS.TSINKING_FUND_REF A, KBS.TFEATURE_XREF B
WHERE A.FEATURE_ID_C=B.FEATURE_ID_C
AND A.MODIFIED_BY_C = 'DALCOM'
AND A.MODIFIED_Z > TO_DATE('10/13/14', 'MM/DD/YY')



ALINA-DEFAULTS THAT ALSO HAVE PARTIAL CALLS > DEFAULT DATE
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.DEFAULT_TYPE_C, B.DEFAULT_D AS DEFAULT_DATE, B.CURRENT_D, G.SOURCE_FUNDS_C AS SOURCE, G.FULL_PART_CALL_C AS TYPE, F.CALL_D AS CALL_DATE 
FROM KBS.TISSUE_REF A, KBS.TDEFAULTS B, KBS.TFEATURE_REF C, KBS.TFEATURE_XREF D, KBS.TISSUING_REF E, KBS.TCALLED_BOND F, KBS.TCALLED_ISSUE G
WHERE A.ISSUE_ID_C = D.ISSUE_ID_C
AND C.FEATURE_ID_C = D.FEATURE_ID_C
AND B.FEATURE_ID_C = D.FEATURE_ID_C
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND (A.ISSUER_ID_C=G.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=G.ISSUE_ALPHA_C)
AND F.FEATURE_ID_C=G.FEATURE_ID_C
AND B.DEFAULT_TYPE_C = 'DFLT'
AND B.CURRENT_D IS NULL
AND A.MATURITY_TYPE_C <> '*'
AND A.MATURITY_D > (SYSDATE)
AND G.FULL_PART_CALL_C = 'PART'
AND F.CALL_D > B.DEFAULT_D




SELECT DISTINCT CONCAT(B.ISSUER_ID_C, B.ISSUE_ALPHA_C) AS CUSIP, D.DATED_D, TO_DATE(SUBSTR(C.OTL_TEXT_T,5,6),'MMDDYY') AS CALL_DATE
FROM KBS.TINST_REF A, KBS.TISSUE_REF B, KBS.TISSUING_OTL C, KBS.TISSUING_REF D
WHERE A.INST_ID_C=B.INST_ID_C
AND B.ISSUING_ID_C=C.ISSUING_ID_C
AND B.ISSUING_ID_C=D.ISSUING_ID_C
AND B.MATURITY_D > (SYSDATE)
AND D.DATED_D > TO_DATE('10/01/2014','MM/DD/YYYY')
AND C.OTL_ID_C ='48'
AND C.OTL_TEXT_T LIKE 'CALL%'
AND TO_DATE(SUBSTR(C.OTL_TEXT_T,5,6),'MM/DD/YY') < TO_DATE('01/01/2015','MM/DD/YYYY')



SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, A.OFFERING_ID_C, C.INFO_DESC_T, B.INDEX_TYPE 
FROM KBS.TISSUE_REF A, KBS.TINDEX_GROUPING B, KBS.TINFO_SOURCE C, KBS.TINFO_SOURCE C2
WHERE (A.ISSUER_ID_C=B.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C (+))
AND A.OFFERING_ID_C=C.OFFERING_ID_C
AND A.OFFERING_ID_C2=C.OFFERING_ID_C
AND C.INFO_DESC_T LIKE 'CPN% TO NULL%'
AND A.MATURITY_D > (SYSDATE)
AND C2.INFO_SOURCE_C= 'SHTCPN'
ORDER BY 2 ASC


SELECT DISTINCT A.CRF_CINS, A.ISIN, SUM(B.OUTSTANDINGAMOUNT*1000000) AS EDI_OTSD_AMT, F.REDEMDATE, F.AMOUNTREDEEMED, E.OTSD_AMT AS MB_OTSD_AMT, G.CALL_D, H.CALLED_AMT_L
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B, KBS.TISSUE_REF C, KBS.OUTSTANDING_AMT_SCHEDULE E, EDI.REDEM F, KBS.TCALLED_BOND G, KBS.TCALLED_ISSUE H 
WHERE A.SECID=B.SECID
AND ((SUBSTR(A.CRF_CINS,1,6) = C.ISSUER_ID_C)
AND (SUBSTR(A.CRF_CINS,7,2) = C.ISSUE_ALPHA_C))
AND (C.ISSUER_ID_C=E.ISSUER_ID_C AND C.ISSUE_ALPHA_C=E.ISSUE_ALPHA_C)
AND A.SECID=F.SECID
AND (C.ISSUER_ID_C=H.ISSUER_ID_C
AND C.ISSUE_ALPHA_C=H.ISSUE_ALPHA_C)
AND G.FEATURE_ID_C=H.FEATURE_ID_C
AND E.OTSD_AMT_EFFECT_D = (SELECT DISTINCT MAX(OTSD_AMT_EFFECT_D) FROM KBS.OUTSTANDING_AMT_SCHEDULE WHERE ISSUER_ID_C = C.ISSUER_ID_C AND ISSUE_ALPHA_C = C.ISSUE_ALPHA_C)
AND 
)
GROUP BY A.CRF_CINS, A.ISIN, F.REDEMDATE, F.AMOUNTREDEEMED, E.OTSD_AMT, G.CALL_D, H.CALLED_AMT_L



SELECT DISTINCT A.CRF_CINS, A.ISIN, SUM(B.OUTSTANDINGAMOUNT*1000000) AS EDI_OTSD_AMT, F.REDEMDATE, F.AMOUNTREDEEMED, E.OTSD_AMT AS MB_OTSD_AMT, G.CALL_D, H.CALLED_AMT_L
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B, KBS.TISSUE_REF C, KBS.OUTSTANDING_AMT_SCHEDULE E, EDI.REDEM F, KBS.TCALLED_BOND G, KBS.TCALLED_ISSUE H 
WHERE A.SECID=B.SECID
AND ((SUBSTR(A.CRF_CINS,1,6) = C.ISSUER_ID_C)
AND (SUBSTR(A.CRF_CINS,7,2) = C.ISSUE_ALPHA_C))
AND (C.ISSUER_ID_C=E.ISSUER_ID_C AND C.ISSUE_ALPHA_C=E.ISSUE_ALPHA_C)
AND A.SECID=F.SECID
AND (C.ISSUER_ID_C=H.ISSUER_ID_C
AND C.ISSUE_ALPHA_C=H.ISSUE_ALPHA_C)
AND G.FEATURE_ID_C=H.FEATURE_ID_C
AND E.OTSD_AMT_EFFECT_D = (SELECT DISTINCT MAX(OTSD_AMT_EFFECT_D) FROM KBS.OUTSTANDING_AMT_SCHEDULE WHERE ISSUER_ID_C = C.ISSUER_ID_C AND ISSUE_ALPHA_C = C.ISSUE_ALPHA_C)
ORDER BY 1 ASC


SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, B.OTL_TEXT_T 
FROM KBS.TISSUE_REF A, KBS.TISSUING_OTL B
WHERE A.ISSUING_ID_C = B.ISSUING_ID_C
AND B.OTL_TEXT_T LIKE 'VAR%'
AND A.MATURITY_D > (SYSDATE)


SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, A.OFFERING_ID_C, C.INFO_DESC_T, B.INDEX_TYPE 
FROM KBS.TISSUE_REF A, KBS.TINDEX_GROUPING B, KBS.TINFO_SOURCE C
WHERE (A.ISSUER_ID_C=B.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C (+))
AND A.OFFERING_ID_C=C.OFFERING_ID_C
AND C.INFO_DESC_T LIKE 'CPN% TO NULL%'
AND A.MATURITY_D > (SYSDATE)


LIZ-PERSHING REPORT MODIFICATION
SELECT DISTINCT INST_ID_C, INST_N, INST_TYPE_C, INST_SUBTYPE_C 
FROM KBS.TINST_REF
WHERE
INST_TYPE_C = 'GOVT'
AND STATE_INCORP_1_C = 'US'
AND INST_SUBTYPE_C = '  '


DEFAULTS/DISTRIBUTIONS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, E.DATED_D AS DATED_DATE, A.MATURITY_D AS MATURITY_DATE, G.FEATURE_ID_C AS DFLT_FEAT, G.DEFAULT_TYPE_C, G.DEFAULT_D, G.CURRENT_D, F.FEATURE_ID_C AS DIST_FEAT, F.DISTRIB_TYPE_C, F.DISTRIBUTION_D
FROM KBS.TISSUE_REF A, KBS.TFEATURE_REF C, KBS.TFEATURE_REF C2, KBS.TFEATURE_XREF D, KBS.TFEATURE_XREF D2, KBS.TISSUING_REF E, KBS.TDISTRIBUTIONS F, KBS.TDEFAULTS G
WHERE A.ISSUE_ID_C=D.ISSUE_ID_C
AND C.FEATURE_ID_C=D.FEATURE_ID_C (+)
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND C.FEATURE_ID_C=F.FEATURE_ID_C (+)
AND C2.FEATURE_ID_C=D2.FEATURE_ID_C (+)
AND C2.FEATURE_ID_C=G.FEATURE_ID_C
AND A.ISSUE_ID_C=D2.ISSUE_ID_C
AND ((A.ISSUER_ID_C = '84965M' AND A.ISSUE_ALPHA_C = 'AB')
OR (A.ISSUER_ID_C = '84965M' AND A.ISSUE_ALPHA_C = 'AC')
OR (A.ISSUER_ID_C = '84965M' AND A.ISSUE_ALPHA_C = 'AD')
OR (A.ISSUER_ID_C = '84965M' AND A.ISSUE_ALPHA_C = 'AE')
OR (A.ISSUER_ID_C = '84965M' AND A.ISSUE_ALPHA_C = 'AF')
OR (A.ISSUER_ID_C = '84965M' AND A.ISSUE_ALPHA_C = 'AG')


SDM- DEFAULTS/DISTRIBUTIONS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.FEATURE_ID_C AS DFLT_FEATURE, A.DEFAULT_TYPE_C, A.DEFAULT_D, A.CURRENT_D, A.TECH_DFLT_REASON_C, B.FEATURE_ID_C AS DIST_FEATURE, B.DEFAU_FEATURE_ID_C AS DFLT_FEATURE_REF, B.DISTRIB_TYPE_C, B.DISTRIBUTION_D  
FROM KBS.TDEFAULTS A, KBS.TDISTRIBUTIONS B
WHERE ((A.ISSUER_ID_C=B.ISSUER_ID_C)
AND (A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C))
AND (A.ISSUER_ID_C= '537131' AND A.ISSUE_ALPHA_C = 'AK')

ORDER BY 4,2 ASC


ALL CALLED BOND RECORDS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, 
    B.CALL_D, C.CALL_PRICE_L, C.CALLED_AMT_L, C.FULL_PART_CALL_C, C.SOURCE_FUNDS_C
FROM KBS.TISSUE_REF A,
   KBS.TCALLED_BOND B,
   KBS.TCALLED_ISSUE C
WHERE B.FEATURE_ID_C=C.FEATURE_ID_C (+)
AND ((A.ISSUER_ID_C=C.ISSUER_ID_C) AND (A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C))
AND  (A.ISSUER_ID_C=C.ISSUER_ID_C AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C) 
AND…(A.ISSUER_ID_C= ' ' AND A.ISSUE_ALPHA_C= ' ')
ORDER BY 1,2 ASC


CINS WITH MULTIPLE ACTIVE ISIN LINKAGES
SELECT DISTINCT CRF_CINS, COUNT(*) DUPCOUNT 
FROM EDI.IDENTIFIER_XREF 
WHERE ENDDATE IS NULL
HAVING COUNT(*)>1
GROUP BY CRF_CINS


DUPLICATE PARTIAL CALLED BOND RECORDS (BASED ON CALL DATE ONLY)--MB
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.CALL_D, C.FULL_PART_CALL_C, COUNT(*) DUPCOUNT 
FROM KBS.TISSUE_REF A,KBS.TCALLED_BOND B, KBS.TCALLED_ISSUE C
WHERE B.FEATURE_ID_C=C.FEATURE_ID_C
AND (A.ISSUER_ID_C=C.ISSUER_ID_C AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C)
AND C.FULL_PART_CALL_C= 'PART'
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
GROUP BY CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C), B.CALL_D, C.FULL_PART_CALL_C 
HAVING COUNT(*) > 1
ORDER BY 1,2 ASC


DUPLICATE PARTIAL CALLED BOND RECORDS (BASED ON CALL DATE ONLY)--SDM
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, C.CALL_D, C.FULL_PART_CALL_C,    
    COUNT(*) DUPCOUNT 
FROM KBS.TISSUE_REF A,KBS.TCALLED_ISSUE C
WHERE (A.ISSUER_ID_C=C.ISSUER_ID_C AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C)
AND C.FULL_PART_CALL_C= 'PART'
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
GROUP BY CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C), C.CALL_D, C.FULL_PART_CALL_C 
HAVING COUNT(*) > 1
ORDER BY 1,2 ASC


GARY—FC DATE = MATURITY ON MUNI CUSIPS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.DATED_D, C.PAYMENT_FIRST_D AS FIRST_CPN_DATE, C.FREQ_PERIOD_C AS FREQ, A.MATURITY_D, D.ISSUER_DESC_T AS ISSUER, B.ISSUING_CUSIP_T AS ISSUING_DESC  
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, KBS.TINT_PAY_CYCLE C, KBS.TISSUER_REF D, KBS.TINST_REF E
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND B.ISSUING_ID_C=C.ISSUING_ID_C
AND A.ISSUER_ID_C=D.ISSUER_ID_C
AND A.INST_ID_C=E.INST_ID_C
AND E.INST_TYPE_C = 'MUNI'
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND A.COUPON_ORGL_P > 0
AND C.FREQ_PERIOD_C <> 'MAT'
AND C.PAYMENT_FIRST_D=A.MATURITY_D


CONVERT TIMESTAMPS TO DATE/TIME
SELECT DISTINCT FEED_ID_C, 
  ADDED_BY_C, TO_CHAR (ADDED_Z,'MM/DD/YYYY HH:MI:SS AM') AS ADDED_Z, 
  MODIFIED_BY_C, TO_CHAR (MODIFIED_Z,'MM/DD/YYYY HH:MI:SS AM') AS MODIFIED_Z
FROM KBS.RATG_FITCH_FEED
WHERE TO_CHAR (ADDED_Z,'MM/DD/YYYY HH:MI:SS AM') > '11/20/2014 08:00:00 AM'
ORDER BY 1 ASC


CALLS FOR TESTING 

CALI-MB
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.OTL_TEXT_T
FROM KBS.TISSUE_REF A, KBS.TISSUING_OTL B
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND B.OTL_TEXT_T LIKE '%CALI%'
AND B.MODIFIED_Z > TO_TIMESTAMP('11/09/2005 6:00:00.000000 PM','FMMMFM/FMDDFM/YYYY FMHH12FM:MI:SS.FF AM')
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'

SDM
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.CALL_TYPE_C, B.CALL_D, B.CALL_PRICE_P
FROM KBS.TISSUE_REF A, KBS.TCALL_SCHEDULE B
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND B.CALL_TYPE_C = 'CALI'
AND B.CALL_PRICE_P > 100
AND A.MATURITY_TYPE_C <> '*'
AND A.MATURITY_D > (SYSDATE)

CALL-MB
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.OTL_TEXT_T
FROM KBS.TISSUE_REF A, KBS.TISSUING_OTL B
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND B.OTL_TEXT_T LIKE '%CALL%NONC%'
AND B.MODIFIED_Z > TO_TIMESTAMP('11/09/2005 6:00:00.000000 PM','FMMMFM/FMDDFM/YYYY FMHH12FM:MI:SS.FF AM')
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'





SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.OFFERING_ID_C, B.INFO_DESC_T, B.USER_ID_C, TO_CHAR (B.ADDED_Z,'MM/DD/YYYY HH:MI:SS AM') AS ADDED_Z
FROM KBS.TISSUE_REF A, KBS.TINFO_SOURCE B
WHERE A.OFFERING_ID_C=B.OFFERING_ID_C
AND B.INFO_DESC_T LIKE 'CPN FM%'
AND B.INFO_SOURCE_D = TO_DATE('11/26/2014 00:00:00', 'MM/DD/YYYY HH24:MI:SS')
AND B.INFO_SOURCE_C = 'CALCPN'
ORDER BY 1 ASC


CURRENCY IN MB AGAINST CUSIP FEED
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, E.DATED_D, D.COUNTRY_ID_C AS DOMICILE, F.CURRENCY_CD AS CUSIP_CURR, A.CUR_ORGL_ID_C AS ISSUE_ORGL_CURR, A.CUR_DENOM_ID_C AS ISSUE_DENOM_CURR, B.CUR_ORGL_ID_C AS OFF_ORGL_CURR, B.CUR_DENOM_ID_C AS OFF_DENOM_CURR, C.CUR_ID_C AS INT_PAY_CURR  
FROM KBS.TISSUE_REF A, KBS.TOFFERING_REF B, KBS.TISSUING_REF C, KBS.TINST_REF D, KBS.TISSUING_REF E, KBS.TCUSIP_ISSUE_ATTR F 
WHERE A.OFFERING_ID_C=B.OFFERING_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C
AND (A.ISSUER_ID_C=F.ISSUER_NUM AND A.ISSUE_ALPHA_C=F.ISSUE_NUM) 
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND A.INST_ID_C=D.INST_ID_C
AND D.INST_TYPE_C = 'CORP'
AND A.MATURITY_D > (SYSDATE)
ORDER BY 1 ASC


FIND YIELD/PRICE ERRORS
SELECT DISTINCT ISSUING_ID_C, OFFERING_ID_C, INST_ID_C, ISSUER_ID_C, ISSUE_ALPHA_C, 
  OFFERING_VALUE_C, OFFERING_YIELD_P, OFFERING_PRICE_P, COMPOUND_YIELD_P, 
  COUPON_ORGL_P, MODIFIED_BY_C, MODIFIED_Z
FROM KBS.TISSUE_REF
WHERE
OFFERING_PRICE_P < 20
 AND COUPON_ORGL_P <> 0
 AND OFFERING_PRICE_P <> 0
 AND OFFERING_YIELD_P <> 0 
 AND OFFERING_YIELD_P < 10 
 AND COUPON_ORGL_P > 0
 AND OFFERING_VALUE_C = '$'
 AND MODIFIED_Z > TO_TIMESTAMP('12/06/2014 2:00:00.000000 PM','FMMMFM/FMDDFM/YYYY FMHH12FM:MI:SS.FF AM')


DUPLICATE AO
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, E.CRDT_ENHMT_TYPE_C AS ROLE_CODE, G.INST_N AS OBLIGOR, G.INST_ID_C AS INST_ID, E.CRDT_ENHMT_EXP_C AS EXP_CODE, COUNT(*) 
FROM KBS.TISSUING_REF B, KBS.TISSUE_REF A, KBS.TISSUER_REF D, KBS.TINST_REF G,
KBS.TCRDT_ENHMT_REF E, KBS.TCRDT_ENHMT_INST F, KBS.TISSUER_REF D1
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUER_ID_C=D.ISSUER_ID_C (+)
AND B.ISSUING_ID_C=E.ISSUING_ID_C (+)
AND E.CRDT_ENHMT_ID_C=F.CRDT_ENHMT_ID_C (+)
AND F.INST_ID_C=G.INST_ID_C (+)
AND G.INST_CC6 = D1.ISSUER_ID_C (+)
AND 'BPA' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'CLC' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'CLL' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'GIC' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'INSN' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'LIQF' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'LOC' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'SLC' <> E.CRDT_ENHMT_TYPE_C (+) 
AND 'SYB' <> E.CRDT_ENHMT_TYPE_C (+)
AND ((A.ISSUER_ID_C = '005518' AND A.ISSUE_ALPHA_C = 'PG')
OR (A.ISSUER_ID_C = '005518' AND A.ISSUE_ALPHA_C = 'PH')
OR (A.ISSUER_ID_C = '005518' AND A.ISSUE_ALPHA_C = 'PJ')
OR (A.ISSUER_ID_C = '005518' AND A.ISSUE_ALPHA_C = 'PK')
)
GROUP BY CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C), E.CRDT_ENHMT_TYPE_C, G.INST_N, G.INST_ID_C, E.CRDT_ENHMT_EXP_C
HAVING COUNT(*)>1
ORDER BY 1,2 ASC NULLS LAST


DUPLICATE AO IN SDM
SELECT DISTINCT CONCAT(ISSUER_ID_C, ISSUE_ALPHA_C) AS CUSIP, CRDT_ENHMT_TYPE_C, CRDT_ENHMT_SUB_C, INST_SUB_ID_1_C, CRDT_ENHMT_EXP_C, COUNT(*)
FROM KBS.TCRDT_ENHMT_REF
WHERE CRDT_ENHMT_SUB_C IN ('ISSR','OBLI', 'SCH', 'GUAR', 'GTD') 
GROUP BY CONCAT(ISSUER_ID_C, ISSUE_ALPHA_C), CRDT_ENHMT_TYPE_C, CRDT_ENHMT_SUB_C, INST_SUB_ID_1_C, CRDT_ENHMT_EXP_C
HAVING COUNT(*) > 1
ORDER BY 1 ASC


SDM-DUPLICATE AO
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, C.OFFERING_ID_C, C.ISSUING_ID_C, A.CRDT_ENHMT_TYPE_C, A.CRDT_ENHMT_SUB_C, A.CRDT_ENHMT_ID_C AS ID1, A.INST_SUB_ID_1_C AS A1, D1.INST_N AS INST_A1, A.INST_SUB_ID_2_C AS A2, D2.INST_N AS INST_A2, A.INST_SUB_ID_3_C AS A3, D3.INST_N AS INST_A3, A.INST_SUB_ID_4_C AS A4, D4.INST_N AS INST_A4, A.INST_SUB_ID_5_C AS A5, D5.INST_N AS INST_A5, B.CRDT_ENHMT_ID_C AS ID2, B.INST_SUB_ID_1_C AS B1, D6.INST_N AS INST_B1, B.INST_SUB_ID_2_C AS B2, D7.INST_N AS INST_B2, B.INST_SUB_ID_3_C AS B3, D8.INST_N AS INST_B3, B.INST_SUB_ID_4_C AS B4, D9.INST_N AS INST_B4, B.INST_SUB_ID_5_C AS B5, D10.INST_N AS INST_B5, A.CRDT_ENHMT_EXP_C EXP1, B.CRDT_ENHMT_EXP_C AS EXP2
FROM KBS.TCRDT_ENHMT_REF A, KBS.TCRDT_ENHMT_REF B, KBS.TISSUE_REF C, KBS.TINST_REF D1, KBS.TINST_REF D2, KBS.TINST_REF D3, KBS.TINST_REF D4, KBS.TINST_REF D5, KBS.TINST_REF D6, KBS.TINST_REF D7, KBS.TINST_REF D8, KBS.TINST_REF D9, KBS.TINST_REF D10 
WHERE (A.ISSUER_ID_C=B.ISSUER_ID_C AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C)
AND (A.ISSUER_ID_C=C.ISSUER_ID_C AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C) 
AND A.INST_SUB_ID_1_C=D1.INST_SUB_ID_C
AND B.INST_SUB_ID_1_C=D6.INST_SUB_ID_C
AND A.INST_SUB_ID_2_C=D2.INST_SUB_ID_C
AND B.INST_SUB_ID_2_C=D7.INST_SUB_ID_C
AND A.INST_SUB_ID_3_C=D3.INST_SUB_ID_C
AND B.INST_SUB_ID_3_C=D8.INST_SUB_ID_C
AND A.INST_SUB_ID_4_C=D4.INST_SUB_ID_C
AND B.INST_SUB_ID_4_C=D9.INST_SUB_ID_C
AND A.INST_SUB_ID_5_C=D5.INST_SUB_ID_C
AND B.INST_SUB_ID_5_C=D10.INST_SUB_ID_C
AND A.CRDT_ENHMT_SUB_C IN ('ISSR','OBLI', 'SCH', 'GUAR', 'GTD')
AND B.CRDT_ENHMT_SUB_C IN ('ISSR','OBLI', 'SCH', 'GUAR', 'GTD')
AND C.MATURITY_D > (SYSDATE)
AND (A.INST_SUB_ID_1_C=B.INST_SUB_ID_1_C
OR A.INST_SUB_ID_1_C=B.INST_SUB_ID_2_C
OR A.INST_SUB_ID_1_C=B.INST_SUB_ID_3_C
OR A.INST_SUB_ID_1_C=B.INST_SUB_ID_4_C
OR A.INST_SUB_ID_1_C=B.INST_SUB_ID_5_C
OR A.INST_SUB_ID_2_C=B.INST_SUB_ID_1_C
OR A.INST_SUB_ID_2_C=B.INST_SUB_ID_2_C
OR A.INST_SUB_ID_2_C=B.INST_SUB_ID_3_C
OR A.INST_SUB_ID_2_C=B.INST_SUB_ID_4_C
OR A.INST_SUB_ID_2_C=B.INST_SUB_ID_5_C
OR A.INST_SUB_ID_3_C=B.INST_SUB_ID_1_C
OR A.INST_SUB_ID_3_C=B.INST_SUB_ID_2_C
OR A.INST_SUB_ID_3_C=B.INST_SUB_ID_3_C
OR A.INST_SUB_ID_3_C=B.INST_SUB_ID_4_C
OR A.INST_SUB_ID_3_C=B.INST_SUB_ID_5_C
OR A.INST_SUB_ID_4_C=B.INST_SUB_ID_1_C
OR A.INST_SUB_ID_4_C=B.INST_SUB_ID_2_C
OR A.INST_SUB_ID_4_C=B.INST_SUB_ID_3_C
OR A.INST_SUB_ID_4_C=B.INST_SUB_ID_4_C
OR A.INST_SUB_ID_4_C=B.INST_SUB_ID_5_C
OR A.INST_SUB_ID_5_C=B.INST_SUB_ID_1_C
OR A.INST_SUB_ID_5_C=B.INST_SUB_ID_2_C
OR A.INST_SUB_ID_5_C=B.INST_SUB_ID_3_C
OR A.INST_SUB_ID_5_C=B.INST_SUB_ID_4_C
OR A.INST_SUB_ID_5_C=B.INST_SUB_ID_5_C)
AND A.CRDT_ENHMT_ID_C<>B.CRDT_ENHMT_ID_C
AND A.CRDT_ENHMT_EXP_C=B.CRDT_ENHMT_EXP_C
ORDER BY 1 ASC

DUPLICATE AO IN MB
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.MATURITY_D AS MTY_DATE, E.CRDT_ENHMT_TYPE_C AS ROLE_CODE, G.INST_N AS OBLIGOR, G.INST_CC6 AS CC6, COUNT(*) 
FROM KBS.TISSUING_REF B, KBS.TISSUE_REF A, KBS.TISSUER_REF D, KBS.TINST_REF G,
KBS.TCRDT_ENHMT_REF E, KBS.TCRDT_ENHMT_INST F, KBS.TISSUER_REF D1
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUER_ID_C=D.ISSUER_ID_C (+)
AND B.ISSUING_ID_C=E.ISSUING_ID_C (+)
AND E.CRDT_ENHMT_ID_C=F.CRDT_ENHMT_ID_C (+)
AND F.INST_ID_C=G.INST_ID_C (+)
AND G.INST_CC6 = D1.ISSUER_ID_C (+)
AND E.CRDT_ENHMT_TYPE_C IN ('ISSR','OBLI','SCH') 
GROUP BY CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C), A.MATURITY_D, E.CRDT_ENHMT_TYPE_C, G.INST_N, G.INST_CC6
HAVING COUNT(*)>1
ORDER BY 1,2 ASC NULLS LAST


GARY-DETROIT BKRTCY CUSIPS (TECHNICAL)
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, E.DATED_D AS DATED, C.MATURITY_D AS MATURITY, D.ISSUER_DESC_T AS ISSUER, E.ISSUING_CUSIP_T AS ISSUING_DESC,B.DEFAULT_TYPE_C AS DFLT_TYPE, B.DEFAULT_D AS DFLT_DATE 
FROM KBS.TFEATURE_XREF A, KBS.TDEFAULTS B, KBS.TISSUE_REF C, KBS.TISSUER_REF D, KBS.TISSUING_REF E
WHERE A.FEATURE_ID_C=B.FEATURE_ID_C
AND (A.ISSUER_ID_C=C.ISSUER_ID_C AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C)
AND A.ISSUER_ID_C=D.ISSUER_ID_C
AND C.ISSUING_ID_C=E.ISSUING_ID_C 
AND B.DEFAULT_TYPE_C = 'TDFL'
AND B.TECH_DFLT_REASON_C = 'BKRTCY'
AND D.ISSUER_DESC_T LIKE '%DETROIT%'


GARY-DETROIT BKRTCY CUSIPS (MONETARY)
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, E.DATED_D AS DATED, C.MATURITY_D AS MATURITY, D.ISSUER_DESC_T AS ISSUER, E.ISSUING_CUSIP_T AS ISSUING_DESC,B.DEFAULT_TYPE_C AS DFLT_TYPE, B.DEFAULT_D AS DFLT_DATE 
FROM KBS.TFEATURE_XREF A, KBS.TDEFAULTS B, KBS.TISSUE_REF C, KBS.TISSUER_REF D, KBS.TISSUING_REF E
WHERE A.FEATURE_ID_C=B.FEATURE_ID_C
AND (A.ISSUER_ID_C=C.ISSUER_ID_C AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C)
AND A.ISSUER_ID_C=D.ISSUER_ID_C
AND C.ISSUING_ID_C=E.ISSUING_ID_C 
AND B.DEFAULT_TYPE_C = 'DFLT'
AND D.ISSUER_DESC_T LIKE '%DETROIT%'


JANICE-INSURANCE QUERY
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.DATED_D AS DTD, A.MATURITY_D AS MTY_DATE, E.INST_N AS INSURANCE, C.PRIM_SECONDARY_C, C.COVERAGE_TYPE_C 
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, KBS.TCRDT_ENHMT_REF C, KBS.TCRDT_ENHMT_INST D, KBS.TINST_REF E
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C
AND C.CRDT_ENHMT_ID_C=D.CRDT_ENHMT_ID_C 
AND D.INST_ID_C=E.INST_ID_C
AND C.CRDT_ENHMT_TYPE_C = 'INSN'
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND NOT EXISTS (
SELECT DISTINCT A.ISSUING_ID_C 
FROM KBS.TCALLED_ISSUE X
WHERE A.ISSUER_ID_C=X.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=X.ISSUE_ALPHA_C
AND X.FULL_PART_CALL_C = 'FULL')
ORDER BY 1 ASC NULLS LAST


ALL CUSIPS INSURED BY "RA" RADIAN INSURANCE
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, B.ISSUING_ID_C, B.OFFERING_ID_C, B.DATED_D, C.PRIM_SECONDARY_C, B.ISSUING_CUSIP_T
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, KBS.TCRDT_ENHMT_REF C, KBS.TCRDT_ENHMT_INST D, KBS.TINST_REF E
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C
AND C.CRDT_ENHMT_ID_C=D.CRDT_ENHMT_ID_C 
AND D.INST_ID_C=E.INST_ID_C 
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND E. INST_ID_C = 308267


QC1141-INT_PAY_AT _MTY
SELECT DISTINCT A.CRF_CINS, A.ISIN, B.FIRSTCOUPONDATE, B.INTERESTPAYMENTFREQUENCY AS INT_PAY_FREQ, B.MATURITYDATE, B.INTERESTRATE, B.INTERESTBASIS, A.ENDDATE
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B
WHERE A.SECID=B.SECID
AND B.FIRSTCOUPONDATE = B.MATURITYDATE
AND B.MATURITYDATE > (SYSDATE)
AND A.CRF_CINS NOT LIKE '0%'
AND A.CRF_CINS NOT LIKE '1%'
AND A.CRF_CINS NOT LIKE '2%'
AND A.CRF_CINS NOT LIKE '3%'
AND A.CRF_CINS NOT LIKE '4%'
AND A.CRF_CINS NOT LIKE '5%'
AND A.CRF_CINS NOT LIKE '6%'
AND A.CRF_CINS NOT LIKE '7%'
AND A.CRF_CINS NOT LIKE '8%'
AND A.CRF_CINS NOT LIKE '9%'
AND A.ENDDATE IS NULL
AND B.INTERESTBASIS IN ('FR', 'SU', 'SD')
ORDER BY 1 ASC


QC1141 CHECK
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.*,A.COUPON_ORGL_P, A.OFFERING_YIELD_P, A.OFFERING_PRICE_P, C.OTL_TEXT_T 
FROM KBS.TISSUE_REF A, KBS.TINT_PAY_CYCLE B, KBS.TISSUING_OTL C
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C 
AND A.ISSUING_ID_C=C.ISSUING_ID_C
AND ((A.ISSUER_ID_C = 'A2742T' AND A.ISSUE_ALPHA_C = 'BX')
OR (A.ISSUER_ID_C = 'D57530' AND A.ISSUE_ALPHA_C = 'S3')
OR (A.ISSUER_ID_C = 'F1442C' AND A.ISSUE_ALPHA_C = 'LK')
OR (A.ISSUER_ID_C = 'G4364M' AND A.ISSUE_ALPHA_C = 'DX')
OR (A.ISSUER_ID_C = 'P34598' AND A.ISSUE_ALPHA_C = 'AJ')
OR (A.ISSUER_ID_C = 'A97947' AND A.ISSUE_ALPHA_C = 'NL')
OR (A.ISSUER_ID_C = 'A1001J' AND A.ISSUE_ALPHA_C = 'AP')
)

STEP CPN-TEST DATA
SELECT DISTINCT A.CRF_CINS, A.ISIN, B.ISSUEDATE, B.MATURITYDATE, B.INTERESTBASIS, C.EFFECTIVEDATE AS INTBC_EFFECTIVEDATE, D.EFFECTIVEDATE AS IRCHG_EFFECTIVEDATE, D.OLDINTERESTRATE, D.NEWINTERESTRATE, B.FIRSTCOUPONDATE, B.INTERESTPAYMENTFREQUENCY
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B, EDI.INTBC C, EDI.IRCHG D, KBS.TOFFERING_REF E, KBS.TISSUE_REF F
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID (+)
AND A.SECID=D.SECID (+)
AND ((SUBSTR(A.CRF_CINS,1,6) = F.ISSUER_ID_C)
AND (SUBSTR(A.CRF_CINS,7,2) = F.ISSUE_ALPHA_C))
AND E.OFFERING_ID_C=F.OFFERING_ID_C
AND E.EDI_DNP_ADDED_BY_C IS NULL
AND A.CRF_CINS NOT LIKE '0%'
AND A.CRF_CINS NOT LIKE '1%'
AND A.CRF_CINS NOT LIKE '2%'
AND A.CRF_CINS NOT LIKE '3%'
AND A.CRF_CINS NOT LIKE '4%'
AND A.CRF_CINS NOT LIKE '5%'
AND A.CRF_CINS NOT LIKE '6%'
AND A.CRF_CINS NOT LIKE '7%'
AND A.CRF_CINS NOT LIKE '8%'
AND A.CRF_CINS NOT LIKE '9%'
AND A.ENDDATE IS NULL
AND B.INTERESTBASIS IN ('SU','SD','SDZC','SUSD','SUZC','SUFR','SDFR','SDSU','SUSDSU', 'SDZC')
AND B.MATURITYDATE > (SYSDATE)
ORDER BY 2,9 ASC






SELECT DISTINCT D.FEED_ID_C, CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, C.CRDT_RATG_AGNCY_C, C.CRDT_RATE_TYPE_C, C.CRDT_RATE_C AS MB_RTG, D.LT_ISSUE_RATING AS FEED_RTG, TO_CHAR (D.LT_ISSUE_RAT_EFF_DT,'MM/DD/YYYY') AS FEED_EFF_DT, C.CRDT_RATG_EFF_D AS MB_EFF_DT, A.MATURITY_D, E.DEFAULT_TYPE_C, TO_CHAR (D.MODIFIED_Z,'MM/DD/YYYY') AS MODIFIED_Z 

FROM KBS.TISSUE_REF A, KBS.TISSUE_CRDT_RATING C, KBS.RATG_FITCH_FEED D, KBS.TDEFAULTS E, KBS.TFEATURE_REF F, KBS.TFEATURE_XREF G

WHERE A.ISSUE_ID_C=C.ISSUE_ID_C (+)
AND ((SUBSTR(D.CUSIP_IDENTIFIER,1,6) = A.ISSUER_ID_C)
AND (SUBSTR(D.CUSIP_IDENTIFIER,7,2) = A.ISSUE_ALPHA_C))
AND F.FEATURE_ID_C = E.FEATURE_ID_C (+)
AND G.FEATURE_ID_C = F.FEATURE_ID_C (+)
AND (A.ISSUER_ID_C = G.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C = G.ISSUE_ALPHA_C (+))
AND C.CRDT_RATG_AGNCY_C = 'FTH'
AND C.CRDT_RATE_TYPE_C = 'L'
AND D.LT_ISSUE_RATING <> C.CRDT_RATE_C







1.	WRITE A QUERY THAT WILL COMPARE CUSIPS AND/OR ISIN NUMBERS FROM ALL FILES RECEIVED FROM FITCH STARTING FROM JULY 12TH THROUGH TODAY AGAINST MAINTAIN BOND AND IDENTIFY THE RATINGS DIFFERENCES.
2.	IF A CUSIP APPEARS MORE THAN ONCE, THEN ONLY OUTPUT THE ONE WITH THE LATEST ISSUE_REC_CD_DT FROM THE FEED.  (THIS SHOULD GIVE US THE MOST RECENT RATING)
3.	DO NOT EXCLUDE MATURED CUSIPS THAT ARE IN DEFAULT. NOTE: WE IDENTIFY CUSIPS IN DEFAULT WERE DEFAULT TYPE = ‘DFLT’
4.	OUTPUT COLUMNS SHOULD INCLUDE: FEED ID, CUSIP, ISIN, RATING, EFFECTIVE DATE, MATURITY DATE, DEFAULT TYPE

THIS IS HOW WE IDENTIFY CUSIPS IN DEFAULT: DEFAULT_TYPE_C = 'DFLT' & CURRENT_D IS NULL
'

KBS.TDEFAULTS B, KBS.TFEATURE_REF C, KBS.TFEATURE_XREF D, KBS.TISSUING_REF E
WHERE A.ISSUE_ID_C = D.ISSUE_ID_C
AND C.FEATURE_ID_C = D.FEATURE_ID_C
AND B.FEATURE_ID_C = D.FEATURE_ID_C
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND B.DEFAULT_TYPE_C IN ('TDFL', 'DFLT')


SIFMA-CHECK
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.OFFERING_ID_C, C.INDEX_TYPE, C.INDEX_SUB_TYPE, A.COUPON_ORGL_P AS ISSUE_CPN, B.*
FROM KBS.TISSUE_REF A, KBS.TVARIABLE_SCHEDULE B, KBS.TINDEX_GROUPING C
WHERE (A.ISSUER_ID_C=B.ISSUER_ID_C AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C)
AND (A.ISSUER_ID_C=C.ISSUER_ID_C AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C)
AND ADJ_DT = TO_DATE('12/25/2014 00:00:00', 'MM/DD/YYYY HH24:MI:SS')
AND C.INDEX_TYPE IN ('SMSW', 'LIBR')
AND ((A.ISSUER_ID_C = '01030T' AND A.ISSUE_ALPHA_C = 'AH')
OR (A.ISSUER_ID_C = '01030T' AND A.ISSUE_ALPHA_C = 'AJ')
OR (A.ISSUER_ID_C = '011903' AND A.ISSUE_ALPHA_C = 'BJ')
)
 ORDER BY 18 DESC


GARY-MISSING OR UNUSUAL INDX RATE CUTOFF VALUES
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, D.INST_TYPE_C, A.OFFERING_ID_C, C.INDEX_TYPE, C.INDEX_SUB_TYPE, C.CUTOFF_FREQ_CD, C.CUTOFF_TIMEZONE_CD
FROM KBS.TISSUE_REF A, KBS.TINDEX_GROUPING C, KBS.TINST_REF D
WHERE (A.ISSUER_ID_C=C.ISSUER_ID_C AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C)
AND D.INST_ID_C=A.INST_ID_C
AND C.INDEX_TYPE = 'LIBR'
AND (C.CUTOFF_FREQ_CD IN ('00DY','01DY','02MO','03DY','04DY','05DY','06DY','06MO','07DY','08DY','09DY','10DY')
OR C.CUTOFF_FREQ_CD IS NULL) 
AND A.MATURITY_D > (SYSDATE)
AND NOT EXISTS (
SELECT DISTINCT ISSUER_ID_C, ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE 
WHERE ISSUER_ID_C=A.ISSUER_ID_C
AND ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND FULL_PART_CALL_C = 'FULL')
ORDER BY 1 ASC


SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP
FROM KBS.TISSUE_REF A, KBS.TOFFERING_REF B, KBS.TCUSIP_ISSUE F 
WHERE (A.ISSUER_ID_C=F.ISSUER_NUM AND A.ISSUE_ALPHA_C=F.ISSUE_NUM) 
AND F.ISSUE_TRANSXTION = 'D'
AND F.MODIFIED_Z BETWEEN TO_TIMESTAMP('12/20/2014 8:05:06.337488 AM','FMMMFM/FMDDFM/YYYY FMHH12FM:MI:SS.FF AM') AND TO_TIMESTAMP('1/7/2015 8:05:06.337488 PM','FMMMFM/FMDDFM/YYYY FMHH12FM:MI:SS.FF AM')
ORDER BY 1 ASC


ALL DEFAULTS FROM 2005-
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, E.DATED_D AS DATED_DATE, A.MATURITY_D AS MATURITY_DATE, B.DEFAULT_TYPE_C, B.TECH_DFLT_REASON_C AS TECH_DFLT_TYPE, B.DEFAULT_D AS DEFAULT_DATE, B.CURRENT_D AS CURE_DATE, A.ISSUE_ORGL_M AS ISSUE_AMOUNT 
FROM KBS.TISSUE_REF A, KBS.TDEFAULTS B, KBS.TFEATURE_REF C, KBS.TFEATURE_XREF D, KBS.TISSUING_REF E
WHERE A.ISSUE_ID_C = D.ISSUE_ID_C
AND C.FEATURE_ID_C = D.FEATURE_ID_C
AND B.FEATURE_ID_C = D.FEATURE_ID_C
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND B.DEFAULT_TYPE_C IN ('DFLT','TDFL')
AND B.DEFAULT_D IS NOT NULL
AND A.MATURITY_TYPE_C <> '*'
AND A.MATURITY_D > (SYSDATE)
AND B.DEFAULT_D > TO_DATE('01/01/2005','MM/DD/YYYY')
ORDER BY 6 ASC


PARTIAL CALLS WITH SAME DATE AS SINKING FUND DATES BUT AT DIFFERENT PRICE
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, F.DATED_D, A.MATURITY_D, E.CALL_D, C.CALL_PRICE_L, J.SF_SCHED_PRICE_P 
FROM KBS.TINST_REF B, KBS.TISSUE_REF A, KBS.TCALLED_ISSUE C, KBS.TISSUER_REF D, KBS.TCALLED_BOND E, KBS.TISSUING_REF F, KBS.TFEATURE_XREF G, KBS.TSINKING_FUND_REF H, KBS.TSINK_FUND_SCHED J, KBS.TINFO_SOURCE K
WHERE B.INST_ID_C=A.INST_ID_C
AND (A.ISSUER_ID_C=C.ISSUER_ID_C AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C)
AND B.INST_ID_C=D.INST_ID_C
AND A.ISSUING_ID_C=F.ISSUING_ID_C
AND C.FEATURE_ID_C=E.FEATURE_ID_C
AND (A.ISSUER_ID_C=G.ISSUER_ID_C AND A.ISSUE_ALPHA_C=G.ISSUE_ALPHA_C)
AND G.FEATURE_ID_C=J.FEATURE_ID_C
AND G.FEATURE_ID_C=H.FEATURE_ID_C
AND A.OFFERING_ID_C=K.OFFERING_ID_C
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND C.FULL_PART_CALL_C = 'PART'
AND E.CALL_D = J.SF_SCHED_D
AND C.CALL_PRICE_L <> J.SF_SCHED_PRICE_P
AND (C.CALL_PRICE_L-J.SF_SCHED_PRICE_P > .49
OR J.SF_SCHED_PRICE_P-C.CALL_PRICE_L > .49)
AND A.COUPON_ORGL_P > 0
AND H.SF_EXPIRATION_D IS NULL
AND K.USER_ID_C = 'EXPSF'
ORDER BY 4 DESC


SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, D.INST_TYPE_C, A.OFFERING_ID_C, E.USER_ID_C, E.ADDED_Z, C.INDEX_TYPE, C.INDEX_SUB_TYPE, C.CUTOFF_FREQ_CD, C.CUTOFF_TIMEZONE_CD, A.COUPON_ORGL_P AS ISSUE_CPN, 
B.ADJ_RATE, B.ADJ_DT, B.BEGIN_DT, B.END_DT, B.CALC_COUPON_I, B.UPDATED_COUPON_I, B.ADDED_BY_C, B.ADDED_Z, B.MODIFIED_BY_C, B.MODIFIED_Z
FROM KBS.TISSUE_REF A, KBS.TVARIABLE_SCHEDULE B, KBS.TINDEX_GROUPING C, KBS.TINST_REF D, KBS.TINFO_SOURCE E
WHERE (A.ISSUER_ID_C=B.ISSUER_ID_C AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C)
AND (A.ISSUER_ID_C=C.ISSUER_ID_C AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C)
AND D.INST_ID_C=A.INST_ID_C
AND A.OFFERING_ID_C=E.OFFERING_ID_C
AND B.ADJ_DT = TO_DATE('12/4/2014 00:00:00','MM/DD/YYYY HH24:MI:SS')
AND C.INDEX_TYPE IN ('SMSW', 'LIBR')
AND A.MATURITY_D > (SYSDATE)
AND (E.USER_ID_C = 'CALCCPN'
OR E.USER_ID_C = 'CLCCPN')
AND NOT EXISTS (
SELECT DISTINCT ISSUER_ID_C, ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE 
WHERE ISSUER_ID_C=A.ISSUER_ID_C
AND ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND FULL_PART_CALL_C = 'FULL')
ORDER BY 1 ASC



KRISTEN—ALL FUTURE DEFAULTS, PLUS SHOW IF 93 OTL AND/OR FULL CALL EXISTS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, E.DATED_D AS DATED_DATE, A.MATURITY_D AS MATURITY_DATE, B.DEFAULT_TYPE_C, B.TECH_DFLT_REASON_C AS TECH_DFLT_TYPE, B.DEFAULT_D AS DEFAULT_DATE, B.CURRENT_D AS CURE_DATE, A.ISSUE_ORGL_M AS ISSUE_AMOUNT, F.OTL_ID_C, G.FULL_PART_CALL_C 
FROM KBS.TISSUE_REF A, KBS.TDEFAULTS B, KBS.TFEATURE_REF C, KBS.TFEATURE_XREF D, KBS.TISSUING_REF E, KBS.TISSUING_OTL F, KBS.TCALLED_ISSUE G
WHERE A.ISSUE_ID_C = D.ISSUE_ID_C
AND C.FEATURE_ID_C = D.FEATURE_ID_C
AND B.FEATURE_ID_C = D.FEATURE_ID_C
AND A.ISSUING_ID_C=F.ISSUING_ID_C (+)
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND (A.ISSUER_ID_C=G.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=G.ISSUE_ALPHA_C (+))
AND B.DEFAULT_TYPE_C IN ('DFLT','TDFL')
AND B.DEFAULT_D IS NOT NULL
AND A.MATURITY_TYPE_C <> '*'
AND A.MATURITY_D > (SYSDATE)
AND B.DEFAULT_D > (SYSDATE)
ORDER BY 6 ASC





SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.FEATURE_ID_C, E.INST_TYPE_C, B.NOTFN_MIN_DAYS_Q AS MINIMUM_NOTIIFICATION, C.SCHEDULE_D AS BEGIN_DATE, B.SCHED_STOP_D AS END_DATE
FROM KBS.TISSUE_REF A, KBS.TSPEC_REDEM B, KBS.TSPEC_SCHEDULE C, KBS.TISSUE_REF D, KBS.TINST_REF E, KBS.TISSUING_REF F, KBS.TFEATURE_XREF G
WHERE G.FEATURE_ID_C=B.FEATURE_ID_C
AND G.FEATURE_ID_C=C.FEATURE_ID_C
AND G.ISSUER_ID_C=D.ISSUER_ID_C
AND G.ISSUE_ALPHA_C=D.ISSUE_ALPHA_C 
AND D.INST_ID_C=E.INST_ID_C
AND A.ISSUING_ID_C=F.ISSUING_ID_C
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND E.INST_TYPE_C IN ('CORP', 'FORN')
AND F.DATED_D BETWEEN TO_DATE('08/01/2014', 'MM/DD/YYYY') AND (SYSDATE)
AND C.SCHEDULE_D=F.DATED_D
AND B.SCHED_STOP_D IS NOT NULL



SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.CALL_D, C.FULL_PART_CALL_C, COUNT(*) DUPCOUNT 
FROM KBS.TISSUE_REF A,KBS.TCALLED_BOND B, KBS.TCALLED_ISSUE C
WHERE B.FEATURE_ID_C=C.FEATURE_ID_C
AND (A.ISSUER_ID_C=C.ISSUER_ID_C AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C)
AND C.FULL_PART_CALL_C= 'PART'
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
GROUP BY CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C), B.CALL_D, C.FULL_PART_CALL_C
HAVING COUNT(*) > 1


SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.CALL_D AS CALL_DATE, C.CALL_PRICE_L AS CALL_PRICE, C.FULL_PART_CALL_C, C.SOURCE_FUNDS_C AS SOURCE 
FROM KBS.TISSUE_REF A,KBS.TCALLED_BOND B, KBS.TCALLED_ISSUE C
WHERE B.FEATURE_ID_C=C.FEATURE_ID_C
AND (A.ISSUER_ID_C=C.ISSUER_ID_C AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C)
AND C.FULL_PART_CALL_C= 'PART'


SELECT DISTINCT CONCAT(ISSUER_ID_C, ISSUE_ALPHA_C) AS CUSIP, OFFERING_ID_C, 
  COUPON_ORGL_P, OFFERING_YIELD_P, OFFERING_PRICE_P
FROM KBS.TISSUE_REF
WHERE
(OFFERING_YIELD_P = COUPON_ORGL_P
 AND COUPON_ORGL_P > 0
 AND OFFERING_PRICE_P <> 100)
OR
((OFFERING_YIELD_P > COUPON_ORGL_P - 1.00)
 AND OFFERING_YIELD_P <> COUPON_ORGL_P
 AND COUPON_ORGL_P > 0
 AND OFFERING_PRICE_P = 100)
OR
((OFFERING_YIELD_P < COUPON_ORGL_P + 1.00)
 AND OFFERING_YIELD_P <> COUPON_ORGL_P
 AND COUPON_ORGL_P > 0
 AND OFFERING_PRICE_P = 100)



SELECT DISTINCT B.*, A.*
FROM KBS.TISSUER_REF A, KBS.TINST_REF B, KBS.TISSUE_REF C
WHERE A.INST_ID_C=B.INST_ID_C
AND C.INST_ID_C=B.INST_ID_C
AND B.INST_TYPE_C = 'CORP'
AND NOT EXISTS (
SELECT DISTINCT ISSUING_ID_C
FROM CVN.TCALL_DETAIL
WHERE ISSUING_ID_C=C.ISSUING_ID_C)


EDI/MB—EDI CALL AMOUNTS THAT ARE NOT EQUAL TO MB CALL AMOUNTS
SELECT DISTINCT A.CRF_CINS, A.ISIN, A.SECID, G.FEATURE_ID_C, B.ACTFLAG, B.REDEMDATE, H.CALL_D, B.PRICEASPERCENT, B.PREMIUMASPERCENT, B.REDEMPRICE, C.PARVALUE, B.REDEMTYPE, B.PARTFINAL, B.AMOUNTREDEEMED, G.CALLED_AMT_L, D.EFFECTIVEDATE, D.OLDOUTVALUE, D.NEWOUTVALUE 
FROM EDI.IDENTIFIER_XREF A, EDI.REDEM B, EDI.BOND C, EDI.BOCHG D , KBS.TOFFERING_REF E, KBS.TISSUE_REF F, KBS.TCALLED_ISSUE G, KBS.TCALLED_BOND H
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID (+)
AND A.SECID=D.SECID (+)
AND ((SUBSTR(A.CRF_CINS,1,6) = F.ISSUER_ID_C)
AND (SUBSTR(A.CRF_CINS,7,2) = F.ISSUE_ALPHA_C))
AND E.OFFERING_ID_C=F.OFFERING_ID_C
AND ((SUBSTR(A.CRF_CINS,1,6) = G.ISSUER_ID_C)
AND (SUBSTR(A.CRF_CINS,7,2) = G.ISSUE_ALPHA_C))
AND G.FEATURE_ID_C = H.FEATURE_ID_C
AND (B.REDEMDATE = H.CALL_D AND (B.AMOUNTREDEEMED * 1000000) <> G.CALLED_AMT_L)

SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.EDI_DNP_ADDED_Z AS DNP_ADDED, A.ISSUE_OTSD_M AS MB_OTSD_AMNT, D.OUTSTANDINGAMOUNT AS EDI_OTSD_AMNT 
FROM KBS.TISSUE_REF A, KBS.TOFFERING_REF B, EDI.IDENTIFIER_XREF C, EDI.BOND D
WHERE A.OFFERING_ID_C=B.OFFERING_ID_C
AND ((SUBSTR(C.CRF_CINS,1,6) = A.ISSUER_ID_C)
AND (SUBSTR(C.CRF_CINS,7,2) = A.ISSUE_ALPHA_C))
AND C.SECID=D.SECID
AND B.EDI_DNP_ADDED_Z IS NULL
AND A.ISSUE_OTSD_M <> D.OUTSTANDINGAMOUNT
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'


EDI-INTERESTBASIS= NULL, UNKNWN OTL ADDED
SELECT DISTINCT A.CRF_CINS, A.ISIN, A.SECID, B.*, D.OTL_TEXT_T
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B, KBS.TISSUE_REF C, KBS.TISSUING_OTL D
WHERE A.SECID=B.SECID
AND ((SUBSTR(A.CRF_CINS,1,6) = C.ISSUER_ID_C)
AND (SUBSTR(A.CRF_CINS,7,2) = C.ISSUE_ALPHA_C))
AND C.ISSUING_ID_C=D.ISSUING_ID_C
AND D.OTL_TEXT_T LIKE 'UNKNWN%'
AND B.INTERESTBASIS IS NULL
AND A.CRF_CINS NOT LIKE '0%'
AND A.CRF_CINS NOT LIKE '1%'
AND A.CRF_CINS NOT LIKE '2%'
AND A.CRF_CINS NOT LIKE '3%'
AND A.CRF_CINS NOT LIKE '4%'
AND A.CRF_CINS NOT LIKE '5%'
AND A.CRF_CINS NOT LIKE '6%'
AND A.CRF_CINS NOT LIKE '7%'
AND A.CRF_CINS NOT LIKE '8%'
AND A.CRF_CINS NOT LIKE '9%'


EDI-INTERESTBASIS <> NULL, 44 OTL ADDED



SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, B.*
FROM KBS.TISSUE_REF A, KBS.TISSUING_OTL B
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND EXISTS (
SELECT DISTINCT X.OFFERING_ID_C 
FROM KBS.TINFO_SOURCE X 
WHERE X.OFFERING_ID_C=A.OFFERING_ID_C 
AND X.INFO_SOURCE_C IN ('NIIDS','NIIDT')
)


TIMESTAMP QUERY
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, A.ADDED_Z AS ISSUE_ADDEDZ, A.ADDED_BY_C AS ISSUE_ADDED_BY, A.MODIFIED_Z AS ISSUE_MODIFIED_Z, A.MODIFIED_BY_C AS ISSUE_MODIFIED_BY, B.ADDED_Z AS OFFERING_ADDEDZ, B.ADDED_BY_C AS OFFERING_ADDED_BY, B.MODIFIED_Z AS OFFERING_MODIFIED_Z, B.MODIFIED_BY_C AS OFFERING_MODIFIED_BY,
C.ADDED_Z AS ISSUING_ADDEDZ, C.ADDED_BY_C AS ISSUING_ADDED_BY, C.MODIFIED_Z AS ISSUING_MODIFIED_Z, C.MODIFIED_BY_C AS ISSUING_MODIFIED_BY, D.ADDED_Z AS INT_PAY_CYCLE_ADDEDZ, D.ADDED_BY_C AS INT_PAY_CYCLE_ADDED_BY, D.MODIFIED_Z AS INT_PAY_CYCLE_MODIFIED_Z, D.MODIFIED_BY_C AS INT_PAY_CYCLE_MODIFIED_BY, E.ADDED_Z AS ISSUING_OTL_ADDEDZ, E.ADDED_BY_C AS ISSUING_OTL_ADDED_BY, E.MODIFIED_Z AS ISSUING_OTL_MODIFIED_Z, E.MODIFIED_BY_C AS ISSUING_OTL_MODIFIED_BY, F.ADDED_Z AS CRDT_ENHMT_ADDEDZ, F.ADDED_BY_C AS CRDT_ENHMT_ADDED_BY, F.MODIFIED_Z AS CRDT_ENHMT_MODIFIED_Z, F.MODIFIED_BY_C AS CRDT_ENHMT_MODIFIED_BY, G.ADDED_Z AS SINK_FUND_ADDEDZ, G.ADDED_BY_C AS SINK_FUND_ADDED_BY, G.MODIFIED_Z AS SINK_FUND_MODIFIED_Z, G.MODIFIED_BY_C AS SINK_FUND_MODIFIED_BY, H.ADDED_Z AS SPECIAL_ADDEDZ, H.ADDED_BY_C AS SPECIAL_ADDED_BY, H.MODIFIED_Z AS SPECIAL_MODIFIED_Z, H.MODIFIED_BY_C AS SPECIAL_MODIFIED_BY, J.ADDED_Z AS CALLED_BOND_ADDEDZ, J.ADDED_BY_C AS CALLED_BOND_ADDED_BY, J.MODIFIED_Z AS CALLED_BOND_MODIFIED_Z, J.MODIFIED_BY_C AS CALLED_BOND_MODIFIED_BY, K.ADDED_Z AS COMMENTS_ADDEDZ, K.ADDED_BY_C AS COMMENTS_ADDED_BY, K.MODIFIED_Z AS COMMENTS_MODIFIED_Z, K.MODIFIED_BY_C AS COMMENTS_MODIFIED_BY, L.ADDED_Z AS DEFAULTS_ADDEDZ, L.ADDED_BY_C AS DEFAULTS_ADDED_BY, L.MODIFIED_Z AS DEFAULTS_MODIFIED_Z, L.MODIFIED_BY_C AS DEFAULTS_MODIFIED_BY, M.ADDED_Z AS DISTRIBUTIONS_ADDEDZ, M.ADDED_BY_C AS DISTRIBUTIONS_ADDED_BY, M.MODIFIED_Z AS DISTRIBUTIONS_MODIFIED_Z, M.MODIFIED_BY_C AS DISTRIBUTIONS_MODIFIED_BY, N.ADDED_Z AS RATINGS_ADDEDZ, N.ADDED_BY_C AS RATINGS_ADDED_BY, N.MODIFIED_Z AS RATINGS_MODIFIED_Z, N.MODIFIED_BY_C AS RATINGS_MODIFIED_BY           
FROM KBS.TISSUE_REF A, KBS.TOFFERING_REF B, KBS.TISSUING_REF C, KBS.TINT_PAY_CYCLE D, KBS.TISSUING_OTL E, KBS.TCRDT_ENHMT_REF F, KBS.TSINKING_FUND_REF G, KBS.TFEATURE_XREF G1, KBS.TSPEC_REDEM H, KBS.TFEATURE_XREF H1, KBS.TCALLED_ISSUE J, KBS.TCOMMENTS K, KBS.TDEFAULTS L, KBS.TFEATURE_XREF L1, KBS.TDISTRIBUTIONS M, KBS.TFEATURE_XREF M1, KBS.TISSUE_CRDT_RATING N
WHERE A.OFFERING_ID_C=B.OFFERING_ID_C (+)
AND A.ISSUING_ID_C=C.ISSUING_ID_C (+)
AND A.ISSUING_ID_C=D.ISSUING_ID_C (+)
AND A.ISSUING_ID_C=E.ISSUING_ID_C (+)
AND A.ISSUING_ID_C=F.ISSUING_ID_C (+)
AND G1.FEATURE_ID_C=G.FEATURE_ID_C (+)
AND (A.ISSUER_ID_C=G1.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=G1.ISSUE_ALPHA_C (+))
AND H1.FEATURE_ID_C=H.FEATURE_ID_C (+)
AND (A.ISSUER_ID_C=H1.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=H1.ISSUE_ALPHA_C (+))
AND (A.ISSUER_ID_C=J.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=J.ISSUE_ALPHA_C (+))
AND A.OFFERING_ID_C=K.OFFERING_ID_C (+)
AND L1.FEATURE_ID_C=L.FEATURE_ID_C (+)
AND (A.ISSUER_ID_C=L1.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=L1.ISSUE_ALPHA_C (+))
AND M1.FEATURE_ID_C=M.FEATURE_ID_C (+)
AND (A.ISSUER_ID_C=M1.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=M1.ISSUE_ALPHA_C (+))
AND A.ISSUE_ID_C=N.ISSUE_ID_C (+)

AND CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) = '25256VAA'
ORDER BY 1 ASC


DISPLAY UW, BC, FA, PAY AGT, REG, AND TRUSTEE
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, D1.UNDWRTR_N AS UNDERWRITER, D2.UNDWRTR_N AS BOND_COUNSEL, D3.UNDWRTR_N AS FINL_ADVISOR, J1.ABA_N AS PAY_AGENT, J2.ABA_N AS REGISTRAR, J3.ABA_N AS TRUSTEE
FROM KBS.TISSUE_REF A, KBS.TOFFERING_REF B, KBS.TUNDERWRITER_REF D1, KBS.TUNDERWRITER_REF D2, KBS.TUNDERWRITER_REF D3, KBS.TABA_REF J1, KBS.TOFFERING_ABA K1, KBS.TABA_REF J2, KBS.TOFFERING_ABA K2, KBS.TABA_REF J3, KBS.TOFFERING_ABA K3
WHERE A.OFFERING_ID_C=B.OFFERING_ID_C
AND B.UNDWRTR_ID_C=D1.UNDWRTR_ID_C
AND B.BOND_COUNSEL_C=D2.UNDWRTR_ID_C
AND B.FISCL_ID_C=D3.UNDWRTR_ID_C
AND A.OFFERING_ID_C=K1.OFFERING_ID_C (+)
AND K1.ABA_OFFICE_ID_C=J1.ABA_OFFICE_ID_C (+)
AND K1.ABA_BRNCH_ID_C=J1.ABA_BRNCH_ID_C (+) 
AND A.OFFERING_ID_C=K2.OFFERING_ID_C (+) 
AND K2.ABA_OFFICE_ID_C=J2.ABA_OFFICE_ID_C (+)
AND K2.ABA_BRNCH_ID_C=J2.ABA_BRNCH_ID_C (+)
AND A.OFFERING_ID_C=K3.OFFERING_ID_C (+)
AND K3.ABA_OFFICE_ID_C=J3.ABA_OFFICE_ID_C (+)
AND K3.ABA_BRNCH_ID_C=J3.ABA_BRNCH_ID_C (+)
AND 'PAYAGENT' = K1.ABA_REL_TYPE_C (+)
AND 'REGISTRAR' = K2.ABA_REL_TYPE_C (+)
AND 'TRUSTEE' = K3.ABA_REL_TYPE_C (+)
AND CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) = '574157X7'


LIZ/SPENCER—COMPARING CORP CALL AND SPECIALS IN MB
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, G.ISSUER_DESC_T AS ISSUER, TO_CHAR(A.MATURITY_D, 'MM/DD/YY') AS MTY, C.CALL_TYPE_C AS CORP_CALL_TYPE, TO_CHAR(C.CALL_BEGIN_D, 'MM/DD/YY') AS CORP_CALL_DATE, C.CALL_BEGIN_PRICE_L AS CORP_CALL_PRICE, C.WHOLE_PART_FREQ_C AS CALL_FREQ, E.SPEC_TYPE_C AS SPEC_TYPE, TO_CHAR(F.SCHEDULE_D, 'MM/DD/YY') AS SPEC_DATE, E.PRICE_P AS SPEC_PRICE, E.FREQ_PERIOD_C AS SPEC_FREQ
FROM KBS.TISSUE_REF A, KBS.TINST_REF B, CVN.TCALL_DETAIL C, KBS.TFEATURE_XREF D, KBS.TSPEC_REDEM E, KBS.TSPEC_SCHEDULE F, KBS.TISSUER_REF G, KBS.TISSUING_REF H
WHERE A.INST_ID_C=B.INST_ID_C 
AND A.ISSUING_ID_C=C.ISSUING_ID_C (+)
AND (A.ISSUER_ID_C=D.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=D.ISSUE_ALPHA_C (+))
AND D.FEATURE_ID_C=E.FEATURE_ID_C (+)
AND D.FEATURE_ID_C=F.FEATURE_ID_C (+)
AND A.ISSUER_ID_C=G.ISSUER_ID_C
AND A.ISSUING_ID_C=H.ISSUING_ID_C
AND ((EXISTS (
SELECT DISTINCT X.ISSUING_ID_C
FROM CVN.TCALL_DETAIL X
WHERE X.ISSUING_ID_C=A.ISSUING_ID_C
AND X.CALL_TYPE_C <> 'NON'))
OR (EXISTS
(SELECT DISTINCT Y.FEATURE_ID_C
FROM KBS.TSPEC_REDEM Y
WHERE Y.FEATURE_ID_C=D.FEATURE_ID_C
)))
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND B.INST_TYPE_C = 'CORP'
AND C.CALL_BEGIN_D IN (SELECT DISTINCT MIN(CALL_BEGIN_D) FROM CVN.TCALL_DETAIL X WHERE X.ISSUING_ID_C=A.ISSUING_ID_C)
AND F.SCHEDULE_D IN (SELECT DISTINCT MIN(SCHEDULE_D) FROM KBS.TSPEC_SCHEDULE Z WHERE Z.FEATURE_ID_C=D.FEATURE_ID_C)
AND H.DATED_D BETWEEN TO_DATE('01/01/2009', 'MM/DD/YYYY') AND TO_DATE('05/01/2014','MM/DD/YYYY')

LIZ-CORP CALL DATE VERSUS DTD
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, G.ISSUER_DESC_T AS ISSUER, H.DATED_D AS DTD, C.CALL_TYPE_C AS CALL_TYPE, C.CALL_BEGIN_D AS CALL_DATE 
FROM KBS.TISSUE_REF A, KBS.TINST_REF B, CVN.TCALL_DETAIL C, KBS.TISSUER_REF G, KBS.TISSUING_REF H
WHERE A.INST_ID_C=B.INST_ID_C 
AND A.ISSUING_ID_C=C.ISSUING_ID_C (+)
AND A.ISSUER_ID_C=G.ISSUER_ID_C
AND A.ISSUING_ID_C=H.ISSUING_ID_C
AND EXISTS (
SELECT DISTINCT X.ISSUING_ID_C
FROM CVN.TCALL_DETAIL X
WHERE X.ISSUING_ID_C=A.ISSUING_ID_C
AND X.CALL_TYPE_C <> 'NON')
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND B.INST_TYPE_C = 'CORP'
AND H.DATED_D > TO_DATE('01/01/2014', 'MM/DD/YYYY')
ORDER BY 1 ASC


LIST OF ALL UNDERWRITERS IN MB
SELECT DISTINCT C.UNDWRTR_N AS UNDERWRITER
FROM KBS.TISSUE_REF A, KBS.TOFFERING_REF B, KBS.TUNDERWRITER_REF C, KBS.TINST_REF D 
WHERE A.OFFERING_ID_C=B.OFFERING_ID_C
AND B.UNDWRTR_ID_C=C.UNDWRTR_ID_C
AND A.INST_ID_C=D.INST_ID_C
AND D.INST_TYPE_C = 'MUNI'
AND A.MATURITY_D > (SYSDATE)
ORDER BY 1



SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP
FROM KBS.MSRBSH_TRANSACTION_DATA A, KBS.TINDEX_GROUPING B
WHERE (A.ISSUER_ID_C=B.ISSUER_ID_C AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C)
ORDER BY 1 ASC

SELECT DISTINCT A.CRF_CINS AS CINS, A.ISIN, E.ISSUERNAME AS ISSUER, B.ISSUEDATE, B.MATURITYDATE, C.FROMDATE, C.PRICEASPERCENT, C.MINNOTICEDAYS, C.MAXNOTICEDAYS 
FROM EDI.IDENTIFIER_XREF A, EDI.BOND B, EDI.CPOPT C, EDI.SCMST D, EDI.ISSUR E
WHERE A.SECID=B.SECID
AND A.SECID=C.SECID
AND A.SECID=D.SECID
AND D.ISSID=E.ISSID
AND B.MATURITYDATE > (SYSDATE)
AND C.CALLPUT='C'
AND C.MANDATORYOPTIONAL='O'
AND C.FROMDATE IN (SELECT DISTINCT MIN(FROMDATE) FROM EDI.CPOPT X WHERE X.SECID=A.SECID)
ORDER BY 1



SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, A.MATURITY_D, A.MATURITY_TYPE_C, B.ISSUE_TRANSXTION, B.MODIFIED_Z 
FROM KBS.TISSUE_REF A, KBS.TCUSIP_ISSUE B
WHERE (A.ISSUER_ID_C=B.ISSUER_NUM AND A.ISSUE_ALPHA_C=B.ISSUE_NUM)
AND A.MATURITY_TYPE_C <> '*'
AND B.ISSUE_TRANSXTION = 'W'
AND B.MODIFIED_Z IN (SELECT DISTINCT MAX(X.MODIFIED_Z) FROM KBS.TCUSIP_ISSUE X WHERE X.ISSUER_NUM=B.ISSUER_NUM AND X.ISSUE_NUM=B.ISSUE_NUM)


GARY-DEALS WITH OID
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, E.ISSUER_DESC_T AS ISSUER, TO_CHAR(C.SALE_NOTICE_D,'MM/DD/YY') AS AWARD_DATE, TO_CHAR(C.INITIAL_TRADE_D,'MM/DD/YY') AS EXEC_DATE, TO_CHAR(D.DATED_D,'MM/DD/YY') AS DTD, TO_CHAR(F.ADDED_Z,'MM/DD/YY') AS OID_ADDED, C.PRELIM_INFO_C AS PRELIM_FLAG, TO_CHAR(G.ADDED_Z,'MM/DD/YY') AS CHNG_TO_FINAL
FROM KBS.TISSUE_REF A, KBS.TINST_REF B, KBS.TOFFERING_REF C, KBS.TISSUING_REF D, KBS.TISSUER_REF E, KBS.TISSUING_OTL F, KBS.TINFO_SOURCE G
WHERE A.INST_ID_C=B.INST_ID_C
AND A.OFFERING_ID_C=C.OFFERING_ID_C
AND A.ISSUING_ID_C=D.ISSUING_ID_C
AND A.ISSUER_ID_C=E.ISSUER_ID_C
AND A.ISSUING_ID_C=F.ISSUING_ID_C
AND A.OFFERING_ID_C=G.OFFERING_ID_C
AND B.INST_TYPE_C= 'MUNI'
AND C.SALE_NOTICE_D > TO_DATE('04/15/2015', 'MM/DD/YYYY')
AND D.SECURITY_TYPE_C IN ('BOND','NOTE')
AND A.MATURITY_TYPE_C <> '*'
AND A.MATURITY_D > (SYSDATE)
AND NOT EXISTS (
SELECT DISTINCT ISSUER_ID_C, ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE 
WHERE ISSUER_ID_C=A.ISSUER_ID_C
AND ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND FULL_PART_CALL_C = 'FULL')
AND F.OTL_ID_C = '61' 
AND F.OTL_TEXT_T LIKE 'OID%'
AND G.INFO_DESC_T LIKE 'CHG2FINAL%'
ORDER BY 3 ASC


EDI-DOMICILE CODE (BY ISIN)
SELECT DISTINCT A.ISIN, B.COUNTRYOFINCORP
FROM EDI.SCMST A, EDI.ISSUR B
WHERE A.ISSID = B.ISSID
AND A.ISIN IN ()


MIKE HOZER-MISSING FRN CPNS
SELECT DISTINCT CONCAT(ISSUER_ID_C, ISSUE_ALPHA_C) AS CUSIP, SCHED_SEQ_ID_C, 
  TO_CHAR(ADJ_DT,'MM/DD/YY') AS ADJ_DATE, ADJ_RATE, TO_CHAR(BEGIN_DT,'MM/DD/YY') AS BEGIN_DATE, 
  TO_CHAR(END_DT,'MM/DD/YY') AS END_DATE, CALC_COUPON_I, UPDATED_COUPON_I, 
  ADDED_BY_C, ADDED_Z, MODIFIED_BY_C, 
  MODIFIED_Z
FROM KBS.TVARIABLE_SCHEDULE
WHERE
((ISSUER_ID_C = '012458' AND ISSUE_ALPHA_C = 'DL')
OR (ISSUER_ID_C = '02687Q' AND ISSUE_ALPHA_C = 'BG')
OR (ISSUER_ID_C = '02687Q' AND ISSUE_ALPHA_C = 'BX')
OR (ISSUER_ID_C = '02687Q' AND ISSUE_ALPHA_C = 'DC')
OR (ISSUER_ID_C = '03760A' AND ISSUE_ALPHA_C = 'AJ')
OR (ISSUER_ID_C = 'X7331A' AND ISSUE_ALPHA_C = 'KE'))
AND ADJ_DT < TO_DATE('05/15/15','MM/DD/YY')


DISPLAY CALL_PRICE_L WITH MORE THAN 5 DECIMALS
SELECT DISTINCT ISSUING_ID_C, ISSUER_ID_C, CALL_TYPE_C, 
  CALL_BEGIN_D, CALL_BEGIN_PRICE_L, CALL_END_D
FROM CVN.TCALL_DETAIL
WHERE FLOOR(CALL_BEGIN_PRICE_L*100000) <> CALL_BEGIN_PRICE_L*100000


LIZ-CUSIP, ISSUER, DESC, DTD, CPN, MTY, SEC TYPE 
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, D.ISSUER_DESC_T AS ISSUER, B.ISSUING_CUSIP_T AS ISSUING_DESC, B.DATED_D, A.COUPON_ORGL_P AS COUPON, A.MATURITY_D, B.SECURITY_TYPE_C AS SEC_TYPE
FROM KBS.TISSUING_REF B, KBS.TISSUE_REF A, KBS.TISSUER_REF D
WHERE B.ISSUING_ID_C=A.ISSUING_ID_C
AND A.ISSUER_ID_C=D.ISSUER_ID_C


CINS ONLY 
ISSUER_ID_C NOT LIKE '0%'
AND ISSUER_ID_C NOT LIKE '1%'
AND ISSUER_ID_C NOT LIKE '2%'
AND ISSUER_ID_C NOT LIKE '3%'
AND ISSUER_ID_C NOT LIKE '4%'
AND ISSUER_ID_C NOT LIKE '5%'
AND ISSUER_ID_C NOT LIKE '6%'
AND ISSUER_ID_C NOT LIKE '7%'
AND ISSUER_ID_C NOT LIKE '8%'
AND ISSUER_ID_C NOT LIKE '9%


DEPOSITOTY AGENT WHERE DOMICILE <> 'US'
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, E.INST_TYPE_C AS CUSIP_TYPE, E.COUNTRY_ID_C AS CUSIP_DOMICILE, B.ABA_REL_TYPE_C, C.ABA_N, D.COUNTRY_ID_C AS DEP_DOMICILE
FROM KBS.TISSUE_REF A, KBS.TOFFERING_ABA B, KBS.TABA_REF C, KBS.TINST_REF D, KBS.TINST_REF E
WHERE C.ABA_OFFICE_ID_C=B.ABA_OFFICE_ID_C
AND C.ABA_BRNCH_ID_C=B.ABA_BRNCH_ID_C
AND A.OFFERING_ID_C=B.OFFERING_ID_C
AND C.INST_ID_C=D.INST_ID_C
AND A.INST_ID_C=E.INST_ID_C
AND B.ABA_REL_TYPE_C = 'DEPOSAGENT'
AND C.ABA_N IS NOT NULL
AND D.COUNTRY_ID_C <> 'US'
AND D.COUNTRY_ID_C <> ' '


SP RATINGS-SP IS BLANK AND SPU EXISTS AS N/R
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.STATE_ID_C, C.CRDT_RATG_AGNCY_C, C.CRDT_RATE_C
FROM KBS.TISSUE_REF A, KBS.TINST_REF B, KBS.TISSUE_CRDT_RATING C
WHERE A.INST_ID_C=B.INST_ID_C
AND A.ISSUE_ID_C=C.ISSUE_ID_C (+)
AND C.CRDT_RATG_AGNCY_C IN ('SP','SPU') 

AND EXISTS(
SELECT DISTINCT 'SPU'
FROM KBS.TISSUE_REF A1, KBS.TISSUE_CRDT_RATING C1
WHERE A1.ISSUE_ID_C=C1.ISSUE_ID_C 
AND A1.MATURITY_D > (SYSDATE)
AND A1.MATURITY_TYPE_C <> '*'
AND C1.CRDT_RATG_AGNCY_C = 'SPU'
AND C1.CRDT_RATE_TYPE_C = 'L'
AND C1.CRDT_RATE_C = 'N/R'
AND A1.ISSUE_ID_C=A.ISSUE_ID_C)

AND NOT EXISTS (
SELECT DISTINCT 'SP' 
FROM KBS.TISSUE_CRDT_RATING SP 
WHERE SP.ISSUE_ID_C=A.ISSUE_ID_C 
AND SP.CRDT_RATG_AGNCY_C = 'SP')
ORDER BY 1,2 ASC, 4 DESC NULLS LAST


SP FEED-LATEST FEED
SELECT DISTINCT  CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, B.*
FROM KBS.TISSUE_REF A, KBS.RATG_SP_FEED B
WHERE (A.ISSUER_ID_C=B.ISSUER_ID_C AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C) 
AND B.FEED_ID_C IN (SELECT DISTINCT MAX(FEED_ID_C) FROM KBS.RATG_SP_FEED FEED WHERE FEED.ISSUER_ID_C=A.ISSUER_ID_C AND FEED.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C)
AND ((A.ISSUER_ID_C = '965000' AND…….


SP FEED-RATING GROUP CODE INCLUDES SPUR AND ICR_SCHOOL BUT NOT STANDARD
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, C.MAT_LT_RATG, C.RATING_GROUP_CODE
FROM KBS.TISSUE_REF A, KBS.TINST_REF B, KBS.RATG_SP_FEED C
WHERE A.INST_ID_C=B.INST_ID_C
AND A.ISSUER_ID_C=C.ISSUER_ID_C (+) 
AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C (+) 
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'

AND EXISTS(
SELECT DISTINCT 'SPUR'
FROM KBS.RATG_SP_FEED R1
WHERE R1.RATING_GROUP_CODE = 'SPUR'
AND A.ISSUER_ID_C=R1.ISSUER_ID_C 
AND A.ISSUE_ALPHA_C=R1.ISSUE_ALPHA_C)

AND EXISTS (
SELECT DISTINCT 'ICR' 
FROM KBS.RATG_SP_FEED R2
WHERE R2.RATING_GROUP_CODE = 'ICR_SCHOOL'
AND A.ISSUER_ID_C=R2.ISSUER_ID_C 
AND A.ISSUE_ALPHA_C=R2.ISSUE_ALPHA_C)

AND NOT EXISTS (
SELECT DISTINCT 'STD' 
FROM KBS.RATG_SP_FEED R3 
WHERE R3.RATING_GROUP_CODE = 'STANDARD'
AND A.ISSUER_ID_C=R3.ISSUER_ID_C 
AND A.ISSUE_ALPHA_C=R3.ISSUE_ALPHA_C )


TOBS________________________________
SELECT DISTINCT A.SECURITY_TYPE_C, H.*, K.*, L.* 
FROM KBS.TISSUING_REF A, KBS.TISSUE_REF B, KBS.RESIDUAL H, KBS.RESIDUAL_UNDLY_BOND J, KBS.RESIDUAL_AMORTIZATION K, KBS.RESIDUAL_UNDLY_BOND L 
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND (B.ISSUER_ID_C=H.ISSUER_ID_C (+) AND B.ISSUE_ALPHA_C=H.ISSUE_ALPHA_C (+) )
AND (B.ISSUER_ID_C=J.ISSUER_ID_C (+) AND B.ISSUE_ALPHA_C=J.ISSUE_ALPHA_C (+) )
AND (B.ISSUER_ID_C=K.ISSUER_ID_C (+) AND B.ISSUE_ALPHA_C=K.ISSUE_ALPHA_C (+) )
AND (B.ISSUER_ID_C=L.ISSUER_ID_C (+) AND B.ISSUE_ALPHA_C=L.ISSUE_ALPHA_C (+) )
AND B.MATURITY_TYPE_C <> '*'
AND B.MATURITY_D > (SYSDATE)
ORDER BY 2 ASC


CLEANUP-ISSUING SCREEN FILL IN MISSING DATA
SELECT DISTINCT A.OFFERING_ID_C, C.DATED_D, C.RECORD_DATE_Q, C.RECORD_DATE_C, 
  C.PAYMENT_FORM_C, C.CUR_ID_C, C.PAYMENT_OBLGN_C, 
  C.ACCRUAL_COUNT_C, B.*
FROM KBS.TISSUE_REF A, KBS.TINT_PAY_CYCLE B, KBS.TISSUING_REF C
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C
AND A.MATURITY_D > SYSDATE
AND (C.RECORD_DATE_Q = 0 
OR C.RECORD_DATE_C = '  '
OR C.PAYMENT_FORM_C = '  '
OR C.CUR_ID_C = '  '
OR C.PAYMENT_OBLGN_C = ' '
OR C.ACCRUAL_COUNT_C = '     ')

LIZ- UNDERWRITERS WHO ARE ALSO ISSUERS---U/W SHOULD BE DELETED
SELECT DISTINCT A.INST_ID_C, A.UNDWRTR_ID_C
FROM KBS.TUNDERWRITER_REF A, KBS.TISSUER_REF B
WHERE A.INST_ID_C=B.INST_ID_C


JANICE-DUPLICATE ABA AGENTS (BY CUSIP)
SELECT DISTINCT C.OFFERING_ID_C, C.REL_TYPE_C, C.INST_SUB_ID_C, B.INST_ID_C, B.INST_N
FROM KBS.TOFFERING_ABA C, KBS.TINST_REF B, KBS.TISSUE_REF A
WHERE C.INST_SUB_ID_C=B.INST_SUB_ID_C
AND C.OFFERING_ID_C=A.OFFERING_ID_C

AND ((A.ISSUER_ID_C = '009413' AND A.ISSUE_ALPHA_C = 'CF')
OR (A.ISSUER_ID_C = '009413' AND A.ISSUE_ALPHA_C = 'CG')
OR (A.ISSUER_ID_C = '009413' AND A.ISSUE_ALPHA_C = 'CH')
OR (A.ISSUER_ID_C = '009413' AND A.ISSUE_ALPHA_C = 'CJ')

)
ORDER BY 1,2,4 ASC NULLS LAST

LIZ- STATE CODES INCORRECT
SELECT DISTINCT A.INST_ID_C, A.INST_N, A.CITY_N, A.STATE_ID_C, A.COUNTRY_ID_C, B.ISSUER_ID_C, B.ISSUER_DESC_T
FROM KBS.TINST_REF A, KBS.TISSUER_REF B 
WHERE A.INST_ID_C=B.INST_ID_C (+)
AND A.STATE_ID_C NOT IN ('AL', 'AK', 'AZ', 'AR', 'CA', 'CO', 'CT', 'DE', 'DC', 'FL', 'GA', 'HI', 'ID', 'IL', 'IN', 'IA', 'KS', 'KY', 'LA', 'ME', 'MD', 'MA', 'MI', 'MN', 'MS', 'MO', 'MT', 'NE', 'NV', 'NH', 'NJ', 'NM', 'NY', 'NC', 'ND', 'OH', 'OK', 'OR', 'PA', 'RI', 'SC', 'SD', 'TN', 'TX', 'UT', 'VT', 'VA', 'WA', 'WV', 'WI', 'WY', 'CB', 'ON','BC','QC','AB','NS','PR', 'AS','GU','VI')
AND A.STATE_ID_C <> ' '
AND EXISTS (SELECT DISTINCT 'US' 
FROM KBS.TINST_REF
WHERE A.INST_ID_C=INST_ID_C
AND A.STATE_ID_C = 'US'
AND A.COUNTRY_ID_C = 'US')
ORDER BY 1 ASC NULLS LAST

FRN/STP FEATURE/SCHEDULE EXISTS WITHOUT FRN OTL
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, E.INST_TYPE_C, A.VARIABLE_TYPE_C AS TYPE, C.DATED_D, B.MATURITY_D, D.OTL_TEXT_T 
FROM KBS.TVARIABLE_FEATURE A, KBS.TISSUE_REF B, KBS.TISSUING_REF C, KBS.TISSUING_OTL D, KBS.TINST_REF E 
WHERE A.ISSUER_ID_C=B.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C
AND B.ISSUING_ID_C=C.ISSUING_ID_C
AND B.ISSUING_ID_C=D.ISSUING_ID_C
AND B.INST_ID_C=E.INST_ID_C
AND A.VARIABLE_TYPE_C IN ('FRN', 'STP')
AND D.OTL_ID_C='44'
AND (D.OTL_TEXT_T LIKE 'VAR-%'
OR D.OTL_TEXT_T LIKE 'ADJ-%')
AND B.MATURITY_D > (SYSDATE)
AND B.MATURITY_TYPE_C <> '*'


CUSIP- CUSIPS/ISSUES THAT WERE SENT IN THE FEED BUT ARE NOT IN MB
SELECT DISTINCT A.*
FROM KBS.TCUSIP_ISSUE A
WHERE A.ADDED_Z > TO_TIMESTAMP('07/10/2016','MM/DD/YYYY')
AND NOT EXISTS (SELECT DISTINCT 'CUSIP' FROM KBS.TISSUE_REF WHERE A.ISSUER_NUM=ISSUER_ID_C AND A.ISSUE_NUM=ISSUE_ALPHA_C)

CUSIP- CUSIPS/ISSUES SENT BUT WHERE THE ISSUER WAS NEVER SENT IN FEED
SELECT DISTINCT A.*
FROM KBS.TCUSIP_ISSUE A
WHERE A.ADDED_Z > TO_TIMESTAMP('07/10/2016','MM/DD/YYYY')
AND NOT EXISTS (SELECT DISTINCT 'ISSUER' FROM KBS.TISSUER_REF WHERE A.ISSUER_NUM=ISSUER_ID_C)

MB-COMMENT EXISTS (SINKING FUND EXISTS) BUT THERE IS NO SINKING FUND & OFST EXISTS
SELECT DISTINCT A.ISSUING_ID_C, A.OFFERING_ID_C, 
B.COMMENT_LINE_T, B.COMMENT_TYPE_I, B.TABLE_ABBRVN_C, C.DATED_D
FROM KBS.TISSUE_REF A, KBS.TCOMMENTS B, KBS.TISSUING_REF C
WHERE A.OFFERING_ID_C=B.OFFERING_ID_C
AND B.TABLE_PRIM_KEY_C = A.ISSUING_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C 
AND B.COMMENT_TYPE_I = 'E'
AND B.COMMENT_LINE_T LIKE '%SINKING FUND EXIST%'
AND A.MATURITY_D > (SYSDATE)
AND NOT EXISTS (SELECT DISTINCT X.FEATURE_ID_C
FROM KBS.TSINKING_FUND_REF X, KBS.TFEATURE_XREF Y
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND (A.ISSUER_ID_C=Y.ISSUER_ID_C AND A.ISSUE_ALPHA_C=Y.ISSUE_ALPHA_C))
AND EXISTS (
SELECT DISTINCT OFFERING_ID_C 
FROM KBS.TINFO_SOURCE C 
WHERE C.OFFERING_ID_C=A.OFFERING_ID_C 
AND C.INFO_SOURCE_C= 'OFST')
ORDER BY 6 DESC

MB-COMMENT EXIST (LOC EXISTS) BUT THERE IS NO LOC & OFST EXISTS
SELECT DISTINCT A.ISSUING_ID_C, A.OFFERING_ID_C, 
B.COMMENT_LINE_T, B.COMMENT_TYPE_I, B.TABLE_ABBRVN_C, C.DATED_D
FROM KBS.TISSUE_REF A, KBS.TCOMMENTS B, KBS.TISSUING_REF C
WHERE A.OFFERING_ID_C=B.OFFERING_ID_C
AND B.TABLE_PRIM_KEY_C = A.ISSUING_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C 
AND B.COMMENT_TYPE_I = 'E'
AND B.COMMENT_LINE_T LIKE '%LOC EXIST%'
AND A.MATURITY_D > (SYSDATE)
AND NOT EXISTS (SELECT DISTINCT ISSUING_ID_C
FROM KBS.TCRDT_ENHMT_REF 
WHERE ISSUING_ID_C=C.ISSUING_ID_C
AND CRDT_ENHMT_TYPE_C = 'LOC')
AND EXISTS (
SELECT DISTINCT OFFERING_ID_C 
FROM KBS.TINFO_SOURCE C 
WHERE C.OFFERING_ID_C=A.OFFERING_ID_C 
AND C.INFO_SOURCE_C= 'OFST')
ORDER BY 6 DESC

EDI-LOOKING UP ISINS IN EDI
SELECT DISTINCT A.ISIN, B.CRF_CINS, B.ENDDATE, A.ADDEDZ AS SCMST_ADDEDZ, B.ADDEDZ AS IDENT_XREF_ADDEDZ, C.* 
FROM EDI.SCMST A, EDI.IDENTIFIER_XREF B, EDI.REDEM C
WHERE A.SECID=B.SECID (+)
AND A.SECID=C.SECID (+)
AND A.ISIN = 'HU0000520705'

ALINA'S CUSIP QUERY
SELECT DISTINCT CONCAT(B.ISSUER_NUM, B.ISSUE_NUM) AS CUSIP, B.DOMICILE_CD, B.CURRENCY_CD, B.US_CFI_CD, A.MATURITY_DT 
FROM KBS.TCUSIP_ISSUE A, KBS.TCUSIP_ISSUE_ATTR B 
WHERE (A.ISSUER_NUM = B.ISSUER_NUM
AND A.ISSUE_NUM = B.ISSUE_NUM) 
AND B.CURRENCY_CD = 'CAD' 
AND A.MATURITY_DT >(SYSDATE+1) 
AND B.US_CFI_CD IS NOT NULL 
AND B.US_CFI_CD <> '   '
AND B.US_CFI_CD NOT LIKE 'U%' 
AND B.US_CFI_CD NOT LIKE 'E%'
AND A.FEED_ID_C IN (SELECT DISTINCT MAX(FEED_ID_C) FROM KBS.TCUSIP_ISSUE FEED WHERE FEED.ISSUER_NUM=A.ISSUER_NUM AND FEED.ISSUE_NUM=A.ISSUE_NUM)

UNRESOLVED ISIN QUERY
SELECT DISTINCT A.ISIN, TRUNC(A.ADDEDZ) AS ADDEDZ 
FROM EDI.SCMST A, EDI.BOND B
WHERE A.SECID=B.SECID
AND B.MATURITYDATE> (SYSDATE)
AND (NOT EXISTS (SELECT DISTINCT ISIN FROM EDI.IDENTIFIER_XREF WHERE A.ISIN=ISIN)
OR (EXISTS (SELECT DISTINCT ISIN FROM EDI.IDENTIFIER_XREF WHERE A.ISIN=ISIN AND ENDDATE IS NOT NULL)
  AND NOT EXISTS (SELECT DISTINCT ISIN FROM EDI.IDENTIFIER_XREF WHERE A.ISIN=ISIN AND ENDDATE IS NULL))) 
AND NOT EXISTS (SELECT DISTINCT SECID 
FROM EDI.REDEM 
WHERE SECID=A.SECID 
AND REDEMTYPE <> 'MAT'
AND PARTFINAL = 'F'
AND ACTFLAG <> 'D')
AND NOT EXISTS (SELECT DISTINCT SECID 
FROM EDI.ASSM 
WHERE SECID=A.SECID 
AND RESSECTYCD <> 'EQS')
AND NOT EXISTS (SELECT DISTINCT SECID 
FROM EDI.BOND 
WHERE SECID=A.SECID 
AND MATURITYBENCHMARK <> 'TEU')
AND A.ISIN NOT LIKE 'US0%'
AND A.ISIN NOT LIKE 'US1%'
AND A.ISIN NOT LIKE 'US2%'
AND A.ISIN NOT LIKE 'US3%'
AND A.ISIN NOT LIKE 'US4%'
AND A.ISIN NOT LIKE 'US5%'
AND A.ISIN NOT LIKE 'US6%'
AND A.ISIN NOT LIKE 'US7%'
AND A.ISIN NOT LIKE 'US8%'
AND A.ISIN NOT LIKE 'US9%'
AND A.ISIN NOT LIKE 'CA0%'
AND A.ISIN NOT LIKE 'CA1%'
AND A.ISIN NOT LIKE 'CA2%'
AND A.ISIN NOT LIKE 'CA3%'
AND A.ISIN NOT LIKE 'CA4%'
AND A.ISIN NOT LIKE 'CA5%'
AND A.ISIN NOT LIKE 'CA6%'
AND A.ISIN NOT LIKE 'CA7%'
AND A.ISIN NOT LIKE 'CA8%'
AND A.ISIN NOT LIKE 'CA9%'
ORDER BY 2 ASC NULLS LAST

MB-WINDOW CALLS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, B.*
FROM KBS.TISSUE_REF A, KBS.TISSUING_OTL B
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND B.OTL_ID_C = '48'
AND B.OTL_TEXT_T LIKE '%;NONC%'
AND A.MATURITY_D > (SYSDATE)









SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP
FROM KBS.TISSUE_REF A
WHERE EXISTS (SELECT DISTINCT 'SPECIAL'
FROM KBS.TFEATURE_XREF A, KBS.TSPEC_REDEM B
WHERE A.FEATURE_ID_C=B.FEATURE_ID_C
AND (A.ISSUER_ID_C=ISSUER_ID_C AND A.ISSUE_ALPHA_C=ISSUE_ALPHA_C) )

AND EXISTS (SELECT DISTINCT 'SF'
FROM KBS.TFEATURE_XREF A, KBS.TSINKING_FUND_REF B
WHERE A.FEATURE_ID_C=B.FEATURE_ID_C
AND (A.ISSUER_ID_C=ISSUER_ID_C AND A.ISSUE_ALPHA_C=ISSUE_ALPHA_C) )

AND EXISTS (SELECT DISTINCT 'PUT' 
FROM KBS.TISSUING_OTL 
WHERE A.ISSUING_ID_C=ISSUING_ID_C 
AND OTL_ID_C='43')



HILLARY-MCKINSEY LIST
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, D.DATED_D AS ISSUE_DATE, A.ISSUE_ORGL_M AS ISSUE_AMOUNT, E.ISSUER_DESC_T AS ISSUER, D.PURP_CLASS_C AS INDUSTRY_CLASS, D.PURP_SUB_CLASS_C AS INDUSTRY_SUBCLASS, C1.CRDT_RATE_C AS MDY_RTG, C2.CRDT_RATE_C AS SP_RTG, C3.CRDT_RATE_C AS FTH_RTG, B.COUNTRY_ID_C AS DOMICILE, A.OFFERING_YIELD_P AS YIELD
FROM KBS.TISSUE_REF A, KBS.TINST_REF B, KBS.TISSUE_CRDT_RATING C1, KBS.TISSUE_CRDT_RATING C2, KBS.TISSUE_CRDT_RATING C3, KBS.TISSUING_REF D, KBS.TISSUER_REF E 
WHERE A.INST_ID_C=B.INST_ID_C
AND A.ISSUE_ID_C=C1.ISSUE_ID_C (+)
AND A.ISSUE_ID_C=C2.ISSUE_ID_C (+)
AND A.ISSUE_ID_C=C3.ISSUE_ID_C (+)
AND A.ISSUING_ID_C=D.ISSUING_ID_C
AND A.ISSUER_ID_C=E.ISSUER_ID_C
AND B.INST_TYPE_C IN ('CORP','FORN')
AND E.ISSUER_DESC_T NOT LIKE '% CLO %'
AND E.ISSUER_DESC_T NOT LIKE '% CMO %'
AND D.DATED_D BETWEEN TO_DATE('06/01/2016','MM/DD/YYYY') AND TO_DATE('06/30/2016','MM/DD/YYYY')
AND D.SECURITY_TYPE_C NOT IN ('ABS','MBS','RMIC','PASS','POOL','CMO')
AND 'MDY' = C1.CRDT_RATG_AGNCY_C (+)
AND 'L' = C1.CRDT_RATE_TYPE_C (+)
AND 'SP' = C2.CRDT_RATG_AGNCY_C (+)
AND 'L' = C2.CRDT_RATE_TYPE_C (+)
AND 'FTH' = C3.CRDT_RATG_AGNCY_C (+)
AND 'L' = C3.CRDT_RATE_TYPE_C (+)


GARY-ISSR/OBLI UPDATED BY MANILA 
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.ISIN, D.ISSUER_DESC_T AS ISSUER, B.DATED_D AS DATED_DATE, A.MATURITY_D AS MTY_DATE, B.SECURITY_TYPE_C AS SEC_TYPE, A.MKT_OF_ISSUANCE, E.CRDT_ENHMT_TYPE_C AS ROLE_CODE, G.INST_N AS OBLIGOR, E.ADDED_BY_C, E.ADDED_Z 
FROM KBS.TISSUING_REF B, KBS.TISSUE_REF A, KBS.TISSUER_REF D, KBS.TINST_REF G, KBS.TCRDT_ENHMT_REF E, KBS.TCRDT_ENHMT_INST F, KBS.TINST_REF H
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUER_ID_C=D.ISSUER_ID_C (+)
AND B.ISSUING_ID_C=E.ISSUING_ID_C (+)
AND E.CRDT_ENHMT_ID_C=F.CRDT_ENHMT_ID_C (+)
AND F.INST_ID_C=G.INST_ID_C (+)
AND H.INST_ID_C=A.INST_ID_C
AND H.INST_TYPE_C = 'FORN'
AND E.CRDT_ENHMT_TYPE_C IN ('ISSR','OBLI')
AND (E.ADDED_BY_C LIKE 'KI71%' OR E.ADDED_BY_C LIKE 'KI72%' OR E.ADDED_BY_C LIKE 'KI73%' OR E.ADDED_BY_C LIKE 'KI8%') 
AND E.ADDED_Z BETWEEN TO_TIMESTAMP('09/01/2016','MM/DD/YYYY') AND TO_TIMESTAMP('09/15/2016','MM/DD/YYYY') 
ORDER BY 11 DESC

BLANK SECURITY TYPE (EQUITY CUSIPS AND NO ISUR RATINGS)
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.CUSIP_DERVN_I, B.ISSUING_ID_C, A.OFFERING_ID_C, C.INST_TYPE_C, D.ISSUER_DESC_T AS ISSUER, B.ISSUING_CUSIP_T AS ISSUING_DESC, B.SECURITY_TYPE_C, B.PURP_TYPE_C, B.PURP_CLASS_C, B.PURP_SUB_CLASS_C, A.ADDED_Z, A.ADDED_BY_C 
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, KBS.TINST_REF C, KBS.TISSUER_REF D
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.INST_ID_C=C.INST_ID_C
AND A.ISSUER_ID_C=D.ISSUER_ID_C
AND B.SECURITY_TYPE_C = '  '
AND SUBSTR(A.ISSUE_ALPHA_C,1,1) IN ('0','1','2','3','4','5','6','7','8','9')
AND SUBSTR(A.ISSUE_ALPHA_C,2,1) IN ('0','1','2','3','4','5','6','7','8','9')
AND A.MATURITY_D > (SYSDATE)

AND NOT EXISTS(
SELECT DISTINCT 'RATG'
FROM KBS.TISSUE_CRDT_RATING
WHERE A.ISSUE_ID_C=ISSUE_ID_C (+)
AND CRDT_RATG_RESN_C = 'ISUR')
AND NOT EXISTS (SELECT DISTINCT A.ISSUER_ID_C, A.ISSUE_ALPHA_C 
FROM KBS.TFEATURE_XREF X, KBS.TDEFAULTS Y
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND (X.ISSUER_ID_C=A.ISSUER_ID_C AND X.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C))
ORDER BY 3 ASC, 13 DESC NULLS LAST



AND((SUBSTR(A.ISSUE_ALPHA_C,1,1) = '0') 
OR (SUBSTR(A.ISSUE_ALPHA_C,1,1) = '1')
OR (SUBSTR(A.ISSUE_ALPHA_C,1,1) = '2')
OR (SUBSTR(A.ISSUE_ALPHA_C,1,1) = '3')
OR (SUBSTR(A.ISSUE_ALPHA_C,1,1) = '4')
OR (SUBSTR(A.ISSUE_ALPHA_C,1,1) = '5')
OR (SUBSTR(A.ISSUE_ALPHA_C,1,1) = '6')
OR (SUBSTR(A.ISSUE_ALPHA_C,1,1) = '7')
OR (SUBSTR(A.ISSUE_ALPHA_C,1,1) = '8')
OR (SUBSTR(A.ISSUE_ALPHA_C,1,1) = '9'))
AND((SUBSTR(A.ISSUE_ALPHA_C,2,1) = '0') 
OR (SUBSTR(A.ISSUE_ALPHA_C,2,1) = '1')
OR (SUBSTR(A.ISSUE_ALPHA_C,2,1) = '2')
OR (SUBSTR(A.ISSUE_ALPHA_C,2,1) = '3')
OR (SUBSTR(A.ISSUE_ALPHA_C,2,1) = '4')
OR (SUBSTR(A.ISSUE_ALPHA_C,2,1) = '5')
OR (SUBSTR(A.ISSUE_ALPHA_C,2,1) = '6')
OR (SUBSTR(A.ISSUE_ALPHA_C,2,1) = '7')
OR (SUBSTR(A.ISSUE_ALPHA_C,2,1) = '8')
OR (SUBSTR(A.ISSUE_ALPHA_C,2,1) = '9'))

BEFORE DELETING CUSIP FROM MB, MAKE SURE THEY DON'T HAVE ANY DATA THAT NEEDS TO BE DELETED FIRST
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, B.ISSUING_ID_C AS OTL, C.ISSUE_ID_C AS RTGS, D.OFFERING_ID_C AS COMMENTS
FROM KBS.TISSUE_REF A, KBS.TISSUING_OTL B, KBS.TISSUE_CRDT_RATING C, KBS.TCOMMENTS D
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C (+)
AND A.ISSUE_ID_C=C.ISSUE_ID_C (+)
AND A.OFFERING_ID_C=D.OFFERING_ID_C (+) 
AND (EXISTS (
SELECT DISTINCT ISSUING_ID_C
FROM KBS.TISSUING_OTL
WHERE A.ISSUING_ID_C=ISSUING_ID_C)
OR EXISTS (SELECT DISTINCT ISSUE_ID_C
FROM KBS.TISSUE_CRDT_RATING
WHERE A.ISSUE_ID_C=ISSUE_ID_C)
OR EXISTS (
SELECT DISTINCT ISSUING_ID_C
FROM KBS.TCRDT_ENHMT_REF
WHERE A.ISSUING_ID_C=ISSUING_ID_C)
OR EXISTS (
SELECT DISTINCT OFFERING_ID_C
FROM KBS.TCOMMENTS
WHERE A.OFFERING_ID_C=OFFERING_ID_C
AND COMMENT_TYPE_I = 'E')
)
OR EXISTS (SELECT DISTINCT A.ISSUER_ID_C, A.ISSUE_ALPHA_C 
FROM KBS.TFEATURE_XREF X, KBS.TDEFAULTS Y
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND (X.ISSUER_ID_C=A.ISSUER_ID_C AND X.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C)
)

AND…..



SYNC PROJ

MB-MATURED DEFAULTED ISSUE COMPARISON
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, A.INST_ID_C, A.ISSUE_ID_C, A.OFFERING_ID_C, A.ISSUING_ID_C, Y.DEFAULT_TYPE_C, TO_CHAR(Y.DEFAULT_D,'MM/DD/YYYY') AS DEFAULT_D 
FROM KBS.TISSUE_REF A, KBS.TFEATURE_XREF X, KBS.TDEFAULTS Y
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND (X.ISSUER_ID_C=A.ISSUER_ID_C AND X.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C)
AND A.MATURITY_D < (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND Y.DEFAULT_TYPE_C = 'DFLT'
AND Y.CURRENT_D IS NULL
AND Y.DEFAULT_D IN (SELECT DISTINCT MAX(M.DEFAULT_D) FROM KBS.TDEFAULTS M, KBS.TFEATURE_XREF N WHERE M.FEATURE_ID_C=N.FEATURE_ID_C AND N.ISSUER_ID_C=A.ISSUER_ID_C AND N.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C)
ORDER BY 1 ASC NULLS LAST



SDM-MATURED DEFAULTED ISSUE COMPARISON
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, TO_CHAR(A.INST_SUB_ID_C,'000000') AS INST_SUB_ID_C, A.ISSUE_ID_C, A.OFFERING_ID_C, A.ISSUING_ID_C, Y.DEFAULT_TYPE_C, TO_CHAR(Y.DEFAULT_D,'MM/DD/YYYY') AS DEFAULT_D 
FROM KBS.TISSUE_REF A, KBS.TDEFAULTS Y
WHERE (Y.ISSUER_ID_C=A.ISSUER_ID_C AND Y.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C)
AND A.MATURITY_D < (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND Y.DEFAULT_TYPE_C = 'DFLT'
AND Y.CURRENT_D IS NULL
AND Y.DEFAULT_D IN (SELECT DISTINCT MAX(DEFAULT_D) FROM KBS.TDEFAULTS WHERE ISSUER_ID_C=A.ISSUER_ID_C AND ISSUE_ALPHA_C=A.ISSUE_ALPHA_C)
ORDER BY 1 ASC NULLS LAST

MB-NON-MATURED CUSIPS DOWNLOAD
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, TO_CHAR(A.MATURITY_D,'MM/DD/YYYY') AS MTY_DATE, A.INST_ID_C, A.ISSUE_ID_C, A.OFFERING_ID_C, A.ISSUING_ID_C 
FROM KBS.TISSUE_REF A
WHERE A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND (A.ISSUER_ID_C LIKE '00%')
ORDER BY 1 ASC

SDM-NON-MATURED CUSIPS DOWNLOAD
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, TO_CHAR(A.MATURITY_D,'MM/DD/YYYY') AS MTY_DATE , TO_CHAR(A.INST_SUB_ID_C,'000000') AS INST_SUB_ID_C, A.ISSUE_ID_C, A.OFFERING_ID_C, A.ISSUING_ID_C 
FROM KBS.TISSUE_REF A
WHERE A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND (A.ISSUER_ID_C LIKE '00%')
ORDER BY 1 ASC

LIEZL-CHECKING ISINS AGAINSTR EDI FEED
SELECT DISTINCT  A.ISIN, A.CRF_CINS AS CINS, TO_CHAR(C.ISSUEDATE,'MM/DD/YYYY') AS DATED_DATE, TO_CHAR(C.MATURITYDATE,'MM/DD/YYYY') AS MTY_DATE, TO_CHAR(C.INTERESTRATE, '99.999') AS COUPON, C.INTERESTACCRUALCONVENTION AS DAY_COUNT, TO_CHAR(C.FIRSTCOUPONDATE,'MM/DD/YYYY') AS FC_DATE, C.INTERESTPAYMENTFREQUENCY AS FC_FREQ, C.ISSUEAMOUNT AS ISSUE_AMOUNT_MM, C.OUTSTANDINGAMOUNT AS OTSD_AMNT_MM, C.DENOMINATION1 AS DENOM, C.ISSUECURRENCY AS CURRENCY, C.BONDTYPE AS TYPE, D.CALLPUT AS CALL_PUT, TO_CHAR(D.FROMDATE,'MM/DD/YYYY') AS CALL_BEGIN_DATE, TO_CHAR(D.TODATE,'MM/DD/YYYY') AS CALL_END_DATE, TO_CHAR(D.CPPRICEASPERCENT,'99.999') AS CALL_PRICE, D.MINNOTICEDAYS AS MIN_NOTIF, D.MAXNOTICEDAYS AS MAX_NOTIF, D.CPTYPE AS CALL_FREQ_TYPE, F.EDI_DNP_ADDED_Z AS EDI_DNP 
FROM EDI.IDENTIFIER_XREF A, EDI.SCMST B, EDI.BOND C, EDI.CPOPT D, KBS.TISSUE_REF E, KBS.TOFFERING_REF F 
WHERE A.ISIN=B.ISIN
AND A.SECID=C.SECID (+)
AND C.SECID=D.SECID (+)
AND A.ENDDATE IS NULL 
AND ((SUBSTR(A.CRF_CINS,1,6) = E.ISSUER_ID_C)
AND (SUBSTR(A.CRF_CINS,7,2) = E.ISSUE_ALPHA_C))
AND E.OFFERING_ID_C=F.OFFERING_ID_C 
AND ()
ORDER BY 1,15 ASC

RATINGS COMPARISON REPORT (MB ONLY)
SELECT DISTINCT A.ISSUER_ID_C, A.ISSUE_ALPHA_C, A.ISSUE_ID_C, A.OFFERING_ID_C, A.ISSUING_ID_C, B. CRDT_RATG_AGNCY_C, B.CRDT_RATE_TYPE_C, B.CRDT_RATE_C, B.ADDED_BY_C AS RATG_ADDED_BY, B.ADDED_Z AS RATG_ADDED_Z, B.MODIFIED_BY_C AS RATG_MOD_BY, B.MODIFIED_Z AS RATG_MOD_Z, C.LUW_INPROG_BY_C, C.LUW_INPROG_Z, C.LUW_LAST_MOD_BY_C, C.LUW_LAST_MOD_Z, C.LUW_COMPLETED_BY_C, C.LUW_COMPLETED_Z FROM KBS.TISSUE_REF A, KBS.TISSUE_CRDT_RATING B, KBS.TOFFERING_LUW_HIST C
WHERE A.ISSUE_ID_C=B.ISSUE_ID_C
AND A.OFFERING_ID_C=C.OFFERING_ID_C
AND (
(ISSUER_ID_C = '234839' AND ISSUE_ALPHA_C = 'NZ')
OR (ISSUER_ID_C = '88033U' AND ISSUE_ALPHA_C = 'JH')
OR (ISSUER_ID_C = '882762' AND ISSUE_ALPHA_C = 'DL')
)
ORDER BY 1,2 ASC NULLS LAST

ISSUERS WHERE THE ISSUER NAME <> INST NAME (SINGLE ISSUERS PER INST ONLY)
SELECT DISTINCT B.ISSUER_ID_C, A.INST_ID_C, A.INST_N AS INST_NAME, SUBSTR(B.ISSUER_DESC_T,1,60) AS ISSUER_NAME
FROM KBS.TINST_REF A, KBS.TISSUER_REF B
WHERE A.INST_ID_C=B.INST_ID_C
AND TRIM(A.INST_N) <> TRIM(SUBSTR(B.ISSUER_DESC_T,1,60))
AND EXISTS (
SELECT DISTINCT ISSR.INST_ID_C,COUNT(*) 
FROM KBS.TISSUER_REF ISSR, KBS.TINST_REF INST
WHERE ISSR.INST_ID_C = INST.INST_ID_C
AND ISSR.INST_ID_C=A.INST_ID_C
AND INST.INST_TYPE_C <> 'MUNI' 
GROUP BY ISSR.INST_ID_C 
HAVING COUNT(*)=1
)
ORDER BY 1 ASC NULLS LAST

GARY-MUNI DEALS ISSUED BETWEEN XX/XX/XXXX AND XX/XX/XXXX
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, KBS.TINST_REF C
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.INST_ID_C=C.INST_ID_C
AND C.INST_TYPE_C = 'MUNI'
AND B.DATED_D BETWEEN TO_DATE('06/30/2016','MM/DD/YYYY') AND TO_DATE('09/30/2016','MM/DD/YYYY')

GARY-MUNI DEAL DEFAULTS BETWEEN XX/XX/XXXX AND XX/XX/XXXX
SELECT DISTINCT A.OFFERING_ID_C
FROM KBS.TISSUE_REF A, KBS.TDEFAULTS B, KBS.TFEATURE_REF C, KBS.TFEATURE_XREF D, KBS.TISSUING_REF E, KBS.TINST_REF F
WHERE A.ISSUE_ID_C = D.ISSUE_ID_C
AND C.FEATURE_ID_C = D.FEATURE_ID_C
AND B.FEATURE_ID_C = D.FEATURE_ID_C
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND A.INST_ID_C=F.INST_ID_C
AND F.INST_TYPE_C = 'MUNI'
AND B.DEFAULT_TYPE_C = 'DFLT'
AND B.DEFAULT_D BETWEEN TO_DATE('06/30/2016','MM/DD/YYYY') AND TO_DATE('09/30/2016','MM/DD/YYYY')

48 CALL OTL WITH MULTIPLE LINES / ROWS
SELECT DISTINCT ISSUING_ID_C,COUNT(*) 
FROM KBS.TISSUING_OTL
WHERE OTL_ID_C = '48' 
GROUP BY ISSUING_ID_C 
HAVING COUNT(*)>1
 ORDER BY 2 DESC NULLS LAST

IPD-CUSIPS WITH SPECIFIC AWARD/SALE DATE
SELECT DISTINCT A.CUSIP9, A.OFFR_SALE_DATE
FROM MASTER_REF.SPSE_OFFERINGREC_OF A, MASTER_REF.SPSE_CUSIPREC_QS B
Where A.CUSIP9=B.CUSIP9
AND A.OFFR_INSTITUTION_TYPE = 'MUNI'
AND (A.OFFR_SALE_DATE = to_date('01/03/2017','mm/dd/yyyy')
ORDER BY 2,1 ASC NULLS LAST


MB-CUSIPS WITH SPECIFIC AWARD/SALE DATE
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, B.SALE_NOTICE_D
FROM KBS.TISSUE_REF A, KBS.TOFFERING_REF B, KBS.TINST_REF C
Where A.OFFERING_ID_C=B.OFFERING_ID_C
AND A.INST_ID_C=C.INST_ID_C
AND C.INST_TYPE_C = 'MUNI'
AND (B.SALE_NOTICE_D = to_date('01/11/2017','mm/dd/yyyy'))
order by 2,1 asc


GARY-FORN CUSIPS WITH DECLINING CALLS AND DATED AFTER 1/1/15, TOUCHED BY KI 7XX OR 8XX
SELECT DISTINCT C.ISSUER_DESC_T AS ISSUER, D.ISSUING_CUSIP_T AS ISSUING_DESC, A.ISIN, CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CINS, D.DATED_D, A.MATURITY_D
FROM KBS.TISSUE_REF A, KBS.TINST_REF B, KBS.TISSUER_REF C, KBS.TISSUING_REF D, CVN.TCALL_DETAIL E
WHERE B.INST_ID_C=A.INST_ID_C
AND B.INST_ID_C=C.INST_ID_C
AND A.ISSUING_ID_C=D.ISSUING_ID_C
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND B.INST_TYPE_C = 'FORN'
AND A.MATURITY_D > (SYSDATE)
AND E.CALL_TYPE_C = 'DEC'
AND D.DATED_D > TO_DATE('01/01/2015','MM/DD/YYYY')


MB-7 MAIN FIELDS + UNDERWRITER AND NIIDS/DALCMP FEED INFO SOURCE DATA
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.OFFERING_ID_C AS OFFERING, E.ISSUING_CUSIP_T AS ISS_DESC, TO_CHAR(A.COUPON_ORGL_P,'99.999') AS COUPON, A.MATURITY_D AS MATURITY, B.PAYMENT_FIRST_D AS FC_DATE, B.FREQ_PERIOD_C AS INT_PAY_FREQ, C.OTL_TEXT_T AS CALL_OTL, D1.CRDT_RATE_C AS MDY_RATING, D1.CRDT_RATE_TYPE_C AS MDY_TYPE, D2.CRDT_RATE_C AS SP_RATING, D2.CRDT_RATE_TYPE_C AS SP_TYPE, D3.CRDT_RATE_C AS FTH_RATING, D3.CRDT_RATE_TYPE_C AS FTH_TYPE, E.ACCRUAL_COUNT_C AS DAY_COUNT, A.INT_MULT_DENOM_3_M AS DENOM, A.ISSUE_ORGL_M AS ISSUE_AMNT, A.ISSUE_OTSD_M AS OUTSTANDING_AMNT, F.UNDWRTR_N AS UNDERWRITER, G.SALE_NOTICE_D AS SALE_DATE, G.INITIAL_TRADE_D AS INITIAL_TRADE_DATE, H.USER_ID_C AS SOURCE
FROM KBS.TISSUE_REF A, KBS.TINT_PAY_CYCLE B, KBS.TISSUING_OTL C, KBS.TISSUE_CRDT_RATING D1, KBS.TISSUE_CRDT_RATING D2, KBS.TISSUE_CRDT_RATING D3, KBS.TISSUING_REF E, KBS.TUNDERWRITER_REF F, KBS.TOFFERING_REF G, KBS.TINFO_SOURCE H
WHERE A.ISSUING_ID_C = B.ISSUING_ID_C (+)
AND A.ISSUING_ID_C = C.ISSUING_ID_C (+)
AND A.ISSUE_ID_C=D1.ISSUE_ID_C (+)
AND A.ISSUE_ID_C=D2.ISSUE_ID_C (+)
AND A.ISSUE_ID_C=D3.ISSUE_ID_C (+)
AND A.ISSUING_ID_C=E.ISSUING_ID_C (+)
AND A.OFFERING_ID_C=G.OFFERING_ID_C
AND F.UNDWRTR_ID_C=G.UNDWRTR_ID_C
AND A.OFFERING_ID_C=H.OFFERING_ID_C (+)
AND '48' = C.OTL_ID_C (+)
AND 'MDY' = D1.CRDT_RATG_AGNCY_C (+)
AND 'SP'= D2.CRDT_RATG_AGNCY_C (+)
AND 'FTH'= D3.CRDT_RATG_AGNCY_C (+)
AND ('NIIDS' = H.USER_ID_C (+)
OR 'DALCOM'= H.USER_ID_C (+))
AND ((A.issuer_id_c = '023015' and A.issue_alpha_c = 'WN')
OR (A.issuer_id_c = '023015' and A.issue_alpha_c = 'WP')
OR (A.issuer_id_c = '023015' and A.issue_alpha_c = 'WQ')
…..
)
ORDER BY 1 ASC NULLS LAST



SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.OFFERING_ID_C AS OFFERING, G.OFFERING_TYPE_C, E.ISSUING_CUSIP_T AS ISS_DESC, TO_CHAR(A.COUPON_ORGL_P,'99.999') AS COUPON, A.MATURITY_D AS MATURITY, B.PAYMENT_FIRST_D AS FC_DATE, B.FREQ_PERIOD_C AS INT_PAY_FREQ, C.OTL_TEXT_T AS CALL_OTL, D1.CRDT_RATE_C AS MDY_RATING, D2.CRDT_RATE_C AS SP_RATING, D3.CRDT_RATE_C AS FTH_RATING, E.ACCRUAL_COUNT_C AS DAY_COUNT, A.INT_MULT_DENOM_3_M AS DENOM, A.ISSUE_ORGL_M AS ISSUE_AMNT, A.ISSUE_OTSD_M AS OUTSTANDING_AMNT, F.UNDWRTR_N AS UNDERWRITER, G.SALE_NOTICE_D AS SALE_DATE, G.INITIAL_TRADE_D AS INITIAL_TRADE_DATE, H.INFO_SOURCE_C AS SOURCE_CODE, H.USER_ID_C AS KI_NUMBER, H.INFO_DESC_T AS SOURCE_TEXT
FROM KBS.TISSUE_REF A, KBS.TINT_PAY_CYCLE B, KBS.TISSUING_OTL C, KBS.TISSUE_CRDT_RATING D1, KBS.TISSUE_CRDT_RATING D2, KBS.TISSUE_CRDT_RATING D3, KBS.TISSUING_REF E, KBS.TUNDERWRITER_REF F, KBS.TOFFERING_REF G, KBS.TINFO_SOURCE H
WHERE A.ISSUING_ID_C = B.ISSUING_ID_C (+)
AND A.ISSUING_ID_C = C.ISSUING_ID_C (+)
AND A.ISSUE_ID_C=D1.ISSUE_ID_C (+)
AND A.ISSUE_ID_C=D2.ISSUE_ID_C (+)
AND A.ISSUE_ID_C=D3.ISSUE_ID_C (+)
AND A.ISSUING_ID_C=E.ISSUING_ID_C (+)
AND A.OFFERING_ID_C=G.OFFERING_ID_C
AND F.UNDWRTR_ID_C=G.UNDWRTR_ID_C
AND A.OFFERING_ID_C=H.OFFERING_ID_C (+)
AND '48' = C.OTL_ID_C (+)
AND 'MDY' = D1.CRDT_RATG_AGNCY_C (+)
AND 'SP'= D2.CRDT_RATG_AGNCY_C (+)
AND 'FTH'= D3.CRDT_RATG_AGNCY_C (+)
AND H.USER_ID_C LIKE 'KI%'
AND ((A.issuer_id_c = '013493' and A.issue_alpha_c = 'GY')
OR (A.issuer_id_c = '013493' and A.issue_alpha_c = 'GZ')
OR (A.issuer_id_c = '013493' and A.issue_alpha_c = 'HA')
……
)
ORDER BY 1 ASC NULLS LAST



MB-7 MAIN FIELDS + SEC TYPE/PURP/CLASS/SUBCL, UNDERWRITER AND NIIDS/DALCMP FEED INFO SOURCE DATA
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.OFFERING_ID_C AS OFFERING, E.ISSUING_CUSIP_T AS ISS_DESC, E.DATED_D, E.SECURITY_TYPE_C, E.PURP_TYPE_C, E.PURP_CLASS_C, E.PURP_SUB_CLASS_C, SUBSTR(J.OTL_TEXT_T,1,3) AS VAR_TYPE, SUBSTR(K.OTL_TEXT_T,1,3) AS ZERO_TYPE, TO_CHAR(A.COUPON_ORGL_P,'99.999') AS COUPON, A.MATURITY_D AS MATURITY, B.PAYMENT_FIRST_D AS FC_DATE, B.FREQ_PERIOD_C AS INT_PAY_FREQ, C.OTL_TEXT_T AS CALL_OTL, D1.CRDT_RATE_C AS MDY_RATING, D1.CRDT_RATE_TYPE_C AS MDY_TYPE, D2.CRDT_RATE_C AS SP_RATING, D2.CRDT_RATE_TYPE_C AS SP_TYPE, D3.CRDT_RATE_C AS FTH_RATING, D3.CRDT_RATE_TYPE_C AS FTH_TYPE, E.ACCRUAL_COUNT_C AS DAY_COUNT, A.INT_MULT_DENOM_3_M AS DENOM, A.ISSUE_ORGL_M AS ISSUE_AMNT, A.ISSUE_OTSD_M AS OUTSTANDING_AMNT, F.UNDWRTR_N AS UNDERWRITER, G.SALE_NOTICE_D AS SALE_DATE, G.INITIAL_TRADE_D AS INITIAL_TRADE_DATE, H.USER_ID_C AS SOURCE, TO_CHAR (H.ADDED_Z,'MM/DD/YYYY HH:MI AM') AS INITIAL_UPDATE_TIME, TO_CHAR (G.SALE_NOTICE_D,'MM/DD/YYYY') AS AWARD_DATE, TO_CHAR (G.SALE_NOTICE_Z,'HH:MI:SS AM') AS AWARD_TIME, TO_CHAR (G. SD_RCVD_MODIFIED_Z,'MM/DD/YYYY') AS FIRST_EXECUTION_DATE, TO_CHAR (G. SUBMISSION_TIME_Z,'HH:MI:SS AM') AS FIRST_EXECUTION_TIME 
FROM KBS.TISSUE_REF A, KBS.TINT_PAY_CYCLE B, KBS.TISSUING_OTL C, KBS.TISSUE_CRDT_RATING D1, KBS.TISSUE_CRDT_RATING D2, KBS.TISSUE_CRDT_RATING D3, KBS.TISSUING_REF E, KBS.TUNDERWRITER_REF F, KBS.TOFFERING_REF G, KBS.TINFO_SOURCE H, KBS.TISSUING_OTL J, KBS.TISSUING_OTL K
WHERE A.ISSUING_ID_C = B.ISSUING_ID_C (+)
AND A.ISSUING_ID_C = C.ISSUING_ID_C (+)
AND A.ISSUE_ID_C=D1.ISSUE_ID_C (+)
AND A.ISSUE_ID_C=D2.ISSUE_ID_C (+)
AND A.ISSUE_ID_C=D3.ISSUE_ID_C (+)
AND A.ISSUING_ID_C=E.ISSUING_ID_C (+)
AND A.OFFERING_ID_C=G.OFFERING_ID_C
AND F.UNDWRTR_ID_C=G.UNDWRTR_ID_C
AND A.OFFERING_ID_C=H.OFFERING_ID_C (+)
AND A.ISSUING_ID_C = J.ISSUING_ID_C (+)
AND A.ISSUING_ID_C = K.ISSUING_ID_C (+) 
AND '48' = C.OTL_ID_C (+)
AND '44' = J.OTL_ID_C (+)
AND '61' = K.OTL_ID_C (+)
AND 'MDY' = D1.CRDT_RATG_AGNCY_C (+)
AND 'SP'= D2.CRDT_RATG_AGNCY_C (+)
AND 'FTH'= D3.CRDT_RATG_AGNCY_C (+)
AND ('NIIDS' = H.USER_ID_C (+)
OR 'DALCOM'= H.USER_ID_C (+))

--AND H.ADDED_Z IN (SELECT DISTINCT MIN(ADDED_Z) FROM KBS.TINFO_SOURCE X WHERE X.OFFERING_ID_C=A.OFFERING_ID_C)

AND ((A.issuer_id_c = '528815' and A.issue_alpha_c = 'DT')
OR (A.issuer_id_c = '528815' and A.issue_alpha_c = 'DU')
OR (A.issuer_id_c = '528815' and A.issue_alpha_c = 'DV')







SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, A.ISSUE_ID_C, A.OFFERING_ID_C AS ISSUE_OFFERING, B.OFFERING_ID_C AS ISSUING_OFFERING, C.OFFERING_ID_C AS OFFERING_OFFERING, A.ISSUING_ID_C AS ISSUE_ISSUING, B. ISSUING_ID_C ASISSUING_ISSUING, D.ISSUING_ID_C AS PREF_ISSUING

FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, KBS.TOFFERING_REF C, KBS.TPREREFUNDED_REF D, KBS.TINT_PAY_CYCLE E, 

WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.OFFERING_ID_C=C.OFFERING_ID_C
AND A.ISSUING_ID_C=D.ISSUING_ID_C (+)
AND A.ISSUING_ID_C=


SPENCE-EDI DNP QUERY
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, E.SECURITY_TYPE_C, E.DATED_D, TO_CHAR(A.COUPON_ORGL_P,'99.999') AS COUPON, A.MATURITY_D AS MATURITY, A.CUR_ORGL_ID_C AS CURRENCY, G.OFFERING_ORGL_M AS ORGL_AMNT, A.ISSUE_ORGL_M AS MATURITY_AMNT, B.ACCRUAL_FIRST_D AS ACCRUAL_FIRST_D, B.PAYMENT_FIRST_D AS FC_DATE, E.SECURITY_CLASS_C AS SECURED_CLASS, E.ASSET_CLAIM_C, G.EDI_DNP_ADDED_Z, G.EDI_DNP_ADDED_BY_C
FROM KBS.TISSUE_REF A, KBS.TINT_PAY_CYCLE B, KBS.TISSUING_REF E, KBS.TOFFERING_REF G, KBS.TINST_REF L
WHERE A.ISSUING_ID_C = B.ISSUING_ID_C (+)
AND A.ISSUING_ID_C=E.ISSUING_ID_C (+)
AND A.OFFERING_ID_C=G.OFFERING_ID_C
AND A.INST_ID_C=L.INST_ID_C
AND G.EDI_DNP_ADDED_Z IS NOT NULL
AND L.INST_TYPE_C = 'FORN'
AND (E.SECURITY_TYPE_C = '  '
OR E.DATED_D IS NULL
OR A.COUPON_ORGL_P IS NULL
OR A.MATURITY_D IS NULL
OR A.CUR_ORGL_ID_C = '  '
OR G.OFFERING_ORGL_M = 0
OR A.ISSUE_ORGL_M = 0
OR B.ACCRUAL_FIRST_D IS NULL
OR B.PAYMENT_FIRST_D IS NULL
OR E.SECURITY_CLASS_C = ' '
OR E.ASSET_CLAIM_C = ' ')
AND G.EDI_DNP_ADDED_Z > TO_TIMESTAMP ('01/01/2017','MM/DD/YYYY')
AND G.EDI_DNP_ADDED_BY_C IN ('KI717','KI728','KI801','KI803','KI811','KI821','KI710','KI712','KI713','KI714','KI715','KI716','KI718','KI719','KI721','KI722','KI723','KI724','KI725','KI726','KI727','KI730','KI732','KI733','KI734','KI804','KI808','KI809','KI810','KI814','KI815','KI816','KI817','KI819','KI720','KI820')

ALINA-ALL ACTIVE SIFMA CUSIPS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP
FROM KBS.TINDEX_GROUPING A, KBS.TVARIABLE_FEATURE C, KBS.TISSUE_REF D
WHERE A.ISSUER_ID_C=C.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C
AND A.ISSUER_ID_C=D.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=D.ISSUE_ALPHA_C
AND A.INDEX_TYPE = 'SMSW'
AND D.MATURITY_D > (SYSDATE)
AND D.MATURITY_TYPE_C <> '*'
AND NOT EXISTS (SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X, KBS.TCALLED_BOND Y 
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND X.ISSUER_ID_C=D.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=D.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND Y.CALL_D < (SYSDATE))



HILLARY-CITI AO QUERY (MB)
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, E.CRDT_ENHMT_TYPE_C AS ROLE_CODE, G.INST_N AS OBLIGOR, B.PURP_CLASS_C AS CLASS, K.PAYMENT_FIRST_D AS FC_DATE, K.FREQ_PERIOD_C AS INT_PAY_FREQ
FROM KBS.TISSUING_REF B, KBS.TISSUE_REF A, KBS.TISSUER_REF D, KBS.TINST_REF G,
KBS.TCRDT_ENHMT_REF E, KBS.TCRDT_ENHMT_INST F, KBS.TISSUER_REF D1, KBS.TINT_PAY_CYCLE K
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUER_ID_C=D.ISSUER_ID_C (+)
AND B.ISSUING_ID_C=E.ISSUING_ID_C (+)
AND E.CRDT_ENHMT_ID_C=F.CRDT_ENHMT_ID_C (+)
AND F.INST_ID_C=G.INST_ID_C (+)
AND B.ISSUING_ID_C=K.ISSUING_ID_C
AND G.INST_CC6 = D1.ISSUER_ID_C (+)
AND 'BPA' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'CLC' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'CLL' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'GIC' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'INSN' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'LIQF' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'LOC' <> E.CRDT_ENHMT_TYPE_C (+)
AND 'SLC' <> E.CRDT_ENHMT_TYPE_C (+) 
AND 'SYB' <> E.CRDT_ENHMT_TYPE_C (+)
AND (E.CRDT_ENHMT_TYPE_C = '  '
OR B.PURP_CLASS_C = '  '
OR K.PAYMENT_FIRST_D IS NULL 
OR K.FREQ_PERIOD_C = '  ')
AND K.FREQ_PERIOD_C <> 'MAT'

HILLARY-PURP CLASS QUERY (MB)
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, B.PURP_CLASS_C
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C

HILLARY-INT PAY DATA MISSING (MB)
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.PAYMENT_FIRST_D AS FC_DATE, A.COUPON_RATE_P AS CPN
FROM KBS.TISSUING_REF B, KBS.TISSUE_REF A
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND (B.PAYMENT_FIRST_D IS NULL 
OR A.COUPON_RATE_P IS NULL
OR A.COUPON_RATE_P = 0)


MB-JANICE-FC DATE EQUALS DTD (ACTIVE CUSIOS ONLY)
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.OFFERING_ID_C, A.ISSUING_ID_C, C.DATED_D AS DTD, B.PAYMENT_FIRST_D AS FC_DATE
FROM KBS.TISSUE_REF A, KBS.TINT_PAY_CYCLE B, KBS.TISSUING_REF C
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C
AND C.DATED_D = B.PAYMENT_FIRST_D
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND NOT EXISTS (SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X, KBS.TCALLED_BOND Y 
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND X.ISSUER_ID_C=A.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND Y.CALL_D < (SYSDATE))
ORDER BY 1 ASC NULLS LAST



ALINA-ACTIVE ZEROS (MB)
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, SUBSTR(B.OTL_TEXT_T,1,3) AS TYPE, TO_CHAR(A.COUPON_ORGL_P, '99.999') AS COUPON, TO_CHAR(D.DATED_D,'MM/DD/YYYY') AS DATED_DATE,
TO_CHAR(A.MATURITY_D,'MM/DD/YYYY') AS MTY_DATE, TO_CHAR(A.OFFERING_YIELD_P, '99.999') AS YIELD, TO_CHAR(A.OFFERING_PRICE_P, '999.999') AS PRICE,
TO_CHAR(A.COMPOUND_YIELD_P, '99.999') AS COMPOUNDING_YIELD
FROM KBS.TISSUE_REF A, KBS.TISSUING_OTL B, KBS.TINST_REF C, KBS.TISSUING_REF D
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.INST_ID_C=C.INST_ID_C
AND A.ISSUING_ID_C=D.ISSUING_ID_C
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND C.INST_TYPE_C = 'MUNI'
AND NOT EXISTS (SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X, KBS.TCALLED_BOND Y 
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND X.ISSUER_ID_C=A.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND Y.CALL_D < (SYSDATE))
AND (B.OTL_TEXT_T LIKE 'CPA%'
OR B.OTL_TEXT_T LIKE 'ZER%'
OR B.OTL_TEXT_T LIKE 'DFD%'
OR B.OTL_TEXT_T LIKE 'CMP%'
OR B.OTL_TEXT_T LIKE 'CAC%'
OR B.OTL_TEXT_T LIKE 'TAP%')


ALINA-ACTIVE CCA'S (MB)
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, SUBSTR(B.OTL_TEXT_T,1,3) AS TYPE, TO_CHAR(A.COUPON_ORGL_P, '99.999') AS COUPON, TO_CHAR(D.DATED_D,'MM/DD/YYYY') AS DATED_DATE,
TO_CHAR(A.MATURITY_D,'MM/DD/YYYY') AS MTY_DATE, TO_CHAR(A.OFFERING_YIELD_P, '99.999') AS YIELD, TO_CHAR(A.OFFERING_PRICE_P, '999.999') AS PRICE,
TO_CHAR(A.COMPOUND_YIELD_P, '99.999') AS COMPOUNDING_YIELD, TO_DATE(SUBSTR(B.OTL_TEXT_T,18,6),'MMDDYY') AS CONVERSION_DATE,
CONCAT(SUBSTR(B.OTL_TEXT_T,37,2), SUBSTR(E.OTL_TEXT_T,1,4)) AS CONVERSION_CPN
FROM KBS.TISSUE_REF A, KBS.TISSUING_OTL B, KBS.TINST_REF C, KBS.TISSUING_REF D, KBS.TISSUING_OTL E
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.INST_ID_C=C.INST_ID_C
AND A.ISSUING_ID_C=D.ISSUING_ID_C
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND C.INST_TYPE_C = 'MUNI'
AND B.OTL_ID_C= '61'
AND E.OTL_LINE_NUMBER_C = B.OTL_LINE_NUMBER_C + 1
AND NOT EXISTS (SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X, KBS.TCALLED_BOND Y 
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND X.ISSUER_ID_C=A.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND Y.CALL_D < (SYSDATE))
AND B.OTL_TEXT_T LIKE 'CCA%'
ORDER BY 1 ASC NULLS LAST

HILLARY-JAPAN-CORE ATTRBUTES
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, M.SALE_NOTICE_D AS SALE_DATE, A.COUPON_ORGL_P AS COUPON, A.OFFERING_PRICE_P AS ISSUE_PRICE, A.ISSUE_ORGL_M AS ISSUE_AMNT, A.ISSUE_OTSD_M AS OUTSTANDING_AMNT, E.INCOME_TAX_I AS TAXABLE, D1.CRDT_RATE_C AS MDY_RATING, D2.CRDT_RATE_C AS SP_RATING, D3.CRDT_RATE_C AS FTH_RATING, A.UNIT_DENOM_1_M AS INITIAL_DENOM, A.INT_MULT_DENOM_3_M AS INCREMENTAL_DENOM, G.FULL_PART_CALL_C AS FULL_PART_CALL, F.CALL_D AS CALL_DATE, G.CALL_PRICE_L, E.DATED_D AS ISSUE_DATE, A.MATURITY_D AS MATURITY, B.ACCRUAL_FIRST_D AS ACCRUAL_DATE, E.ACCRUAL_COUNT_C AS DAY_COUNT, B.PAYMENT_FIRST_D AS FIRST_CPN_DATE, B.FREQ_PERIOD_C AS INT_PAY_FREQ, B.BUS_DAY_ADJUST_C AS BIZ_DAY_ADJUST, SUBSTR(C1.OTL_TEXT_T,1,3) AS FLOATING_RATE_TYPE, J.SF_TYPE_C AS SINK_FUND_TYPE, J.SF_BEGIN_D AS SF_START_DATE, SUBSTR(C2.OTL_TEXT_T,1,4) PUT_TYPE, L.CALL_TYPE_C AS OPTL_CALL_TYPE, N.CONV_BEGIN_D AS CONVERTIBLE_BEGIN_DATE, N.CONV_PRICE_P AS CONV_PRICE 
FROM KBS.TISSUE_REF A, KBS.TINT_PAY_CYCLE B, KBS.TISSUING_OTL C1, KBS.TISSUING_OTL C2, KBS.TISSUE_CRDT_RATING D1, KBS.TISSUE_CRDT_RATING D2, KBS.TISSUE_CRDT_RATING D3, KBS.TISSUING_REF E, KBS.TCALLED_BOND F, KBS.TCALLED_ISSUE G, KBS.TINDEX_GROUPING H, KBS.TSINKING_FUND_REF J, KBS.TFEATURE_XREF K, CVN.TCALL_DETAIL L, KBS.TOFFERING_REF M, KBS.TCONVERTIBLE_REF N, KBS.TFEATURE_XREF P
WHERE A.ISSUING_ID_C = B.ISSUING_ID_C (+)
AND A.ISSUING_ID_C=C1.ISSUING_ID_C (+)
AND A.ISSUING_ID_C=C2.ISSUING_ID_C (+)
AND A.ISSUE_ID_C=D1.ISSUE_ID_C (+)
AND A.ISSUE_ID_C=D2.ISSUE_ID_C (+)
AND A.ISSUE_ID_C=D3.ISSUE_ID_C (+)
AND A.ISSUING_ID_C=E.ISSUING_ID_C (+)
AND (A.ISSUER_ID_C=G.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=G.ISSUE_ALPHA_C (+))
AND G.FEATURE_ID_C=F.FEATURE_ID_C (+)
AND (A.ISSUER_ID_C=H.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=H.ISSUE_ALPHA_C (+))
AND K.FEATURE_ID_C=J.FEATURE_ID_C (+)
AND (A.ISSUER_ID_C=K.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=K.ISSUE_ALPHA_C (+))
AND A.ISSUING_ID_C=L.ISSUING_ID_C (+)
AND A.OFFERING_ID_C=M.OFFERING_ID_C
AND P.FEATURE_ID_C=N.FEATURE_ID_C (+)
AND (A.ISSUER_ID_C=P.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=P.ISSUE_ALPHA_C (+))
AND '44'= C1.OTL_ID_C (+)
AND '43'= C2.OTL_ID_C (+)
AND 'MDY' = D1.CRDT_RATG_AGNCY_C (+)
AND 'SP'= D2.CRDT_RATG_AGNCY_C (+)
AND 'FTH'= D3.CRDT_RATG_AGNCY_C (+)


SDM-ALINA-VARIOUS FIELDS IN TISSUE/TISSUING
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, B.PAYMENT_FIRST_D AS FIRST_CPN_DATE, A.MATURITY_D AS MTY_DATE, B.ACCRUAL_COUNT_C AS DAY_COUNT, A.DATED_D AS DATED_DATE, A.INTEREST_TYPE_C AS COUPON_TYPE, A.ZERO_TYPE_C, B.CUR_INT_I AS CURRENT_INT_IND, A.COUPON_RATE_P, B.INCOME_TAX_I AS FEDERAL_TAXABLE, B.AMT_TAX_I, B.BANK_QUALIFIED_I, B.REGISTRTION_TYPE_C AS BOND_FORM, B.STATE_TAX_I, B.FREQ_PER_OCCUR_1_Q AS INT_PAY_1ST_FIELD, B.FREQ_PERIOD_1_C AS INT_PAY_FREQ_2ND_FIELD, B.FREQ_1_Q AS INT_PAY_3RD_FIELD, B.FREQ_DAY_1_C AS INT_PAY_4TH_FIELD, B.BUS_DAY_ADJUST_1_C AS BUS_DAY_CONVENTION, A.OFFERING_ID_C, A.ISSUE_ORGL_L AS ISSUE_AMNT, A.INSURANCE_I, A.OFFERING_PRICE_P, A.OFFERING_YIELD_P, B.SECURITY_CLASS_C, B.ASSET_CLAIM_C, B.SETTLMNT_D, A.SPECIAL_I, D.SPEC_TYPE_C AS SPECIAL_TYPE, A.SINKING_FUND_C, C.SINK_TYPE_C AS SF_TYPE, A.CALL_TYPE_C, A.PUT_TYPE_C, B.ISSUING_CUSIP_T, A.PURP_TYPE_C, A.PURP_CLASS_C, A.PURP_SUB_CLASS_C, A.SECURITY_TYPE_C, B.OFFERING_TYPE_C, A.ISSUE_DENOM_1_L, A.ISSUE_DENOM_2_L, A.ISSUE_DENOM_3_L, A.ISSUE_DENOM_4_L, A.LOC_I, A.GUARANTOR_I, G1.INST_N AS UNDERWRITER, G2.INST_N AS BOND_COUNSEL, G3.INST_N AS FINL_ADVISOR, G4.INST_N AS PAY_AGENT, G5.INST_N AS REGISTRAR, G6.INST_N AS TRUSTEE
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, KBS.TSINKING_FUND C, KBS.TSPECIAL_SCHEDULE D, KBS.TFEATURE_XREF E, KBS.TOFFERING_ABA F1, KBS.TOFFERING_ABA F2, KBS.TOFFERING_ABA F3, KBS.TINST_REF G1, KBS.TINST_REF G2, KBS.TINST_REF G3, KBS.TINST_REF G4, KBS.TINST_REF G5, KBS.TINST_REF G6
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C (+)
AND E.FEATURE_ID_C=D.FEATURE_ID_C (+)
AND (A.ISSUER_ID_C=E.ISSUER_ID_C (+)
AND A.ISSUE_ALPHA_C=E.ISSUE_ALPHA_C (+))
AND A.OFFERING_ID_C=F1.OFFERING_ID_C (+)
AND A.OFFERING_ID_C=F2.OFFERING_ID_C (+)
AND A.OFFERING_ID_C=F3.OFFERING_ID_C (+)
AND 'PAY'= F1.REL_TYPE_C (+)
AND 'ABA'= F1.INST_CATEGORY_C (+)
AND 'REG' = F2.REL_TYPE_C (+)
AND 'ABA' = F2.INST_CATEGORY_C (+)
AND 'TRST'= F3.REL_TYPE_C (+)
AND 'ABA' = F3.INST_CATEGORY_C (+)
AND B.UNDWRTR_SUB_ID_C = G1.INST_SUB_ID_C (+)
AND B.UNDWRTR_INST_CAT_C = 'UNDW'
AND G1.INST_CATEGORY_C = 'UNDW'
AND B.BOND_CNSL_SUB_ID_C = G2.INST_SUB_ID_C (+)
AND B.BOND_INST_CAT_C = 'UNDW'
AND G2.INST_CATEGORY_C = 'UNDW'
AND B.FISCL_SUB_ID_C = G3.INST_SUB_ID_C (+)
AND B.FISCL_INST_CAT_C = 'UNDW'
AND G3.INST_CATEGORY_C = 'UNDW'
AND F1.INST_SUB_ID_C=G4.INST_SUB_ID_C (+)
AND F2.INST_SUB_ID_C=G5.INST_SUB_ID_C (+)
AND F3.INST_SUB_ID_C=G6.INST_SUB_ID_C (+)

AND ((A.issuer_id_c = '00037N' and A.issue_alpha_c = 'KW')
OR (A.issuer_id_c = '00037N' and A.issue_alpha_c = 'NA')
OR (A.issuer_id_c = '003102' and A.issue_alpha_c = 'AA')…




SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, B.PAYMENT_FIRST_D AS FIRST_CPN_DATE, A.MATURITY_D AS MTY_DATE, B.ACCRUAL_COUNT_C AS DAY_COUNT, A.DATED_D AS DATED_DATE, A.INTEREST_TYPE_C AS COUPON_TYPE, A.COUPON_RATE_P, B.INCOME_TAX_I AS FEDERAL_TAXABLE, B.AMT_TAX_I, B.BANK_QUALIFIED_I, B.REGISTRTION_TYPE_C AS BOND_FORM, B.STATE_TAX_I, B.FREQ_PER_OCCUR_1_Q AS INT_PAY_1ST_FIELD, B.FREQ_PERIOD_1_C AS INT_PAY_FREQ_2ND_FIELD, B.FREQ_1_Q AS INT_PAY_3RD_FIELD, B.FREQ_DAY_1_C AS INT_PAY_4TH_FIELD, B.BUS_DAY_ADJUST_1_C AS BUS_DAY_CONVENTION, A.OFFERING_ID_C, A.ISSUE_ORGL_L AS ISSUE_AMNT, A.INSURANCE_I, A.OFFERING_PRICE_P, A.OFFERING_YIELD_P, B.SECURITY_CLASS_C, B.ASSET_CLAIM_C, B.SETTLMNT_D, A.SPECIAL_I, D.SPEC_TYPE_C AS SPECIAL_TYPE, A.SINKING_FUND_C, C.SINK_TYPE_C AS SF_TYPE, A.CALL_TYPE_C, A.PUT_TYPE_C, B.ISSUING_CUSIP_T, A.PURP_TYPE_C, A.PURP_CLASS_C, A.PURP_SUB_CLASS_C, A.SECURITY_TYPE_C, B.OFFERING_TYPE_C, A.ZERO_TYPE_C, A.ISSUE_DENOM_1_L, A.ISSUE_DENOM_2_L, A.ISSUE_DENOM_3_L, A.ISSUE_DENOM_4_L, A.LOC_I, A.GUARANTOR_I, G1.INST_N AS UNDERWRITER, G2.INST_N AS BOND_COUNSEL, G3.INST_N AS FINL_ADVISOR
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, KBS.TSINKING_FUND C, KBS.TSPECIAL_SCHEDULE D, KBS.TFEATURE_XREF E, KBS.TINST_REF G1, KBS.TINST_REF G2, KBS.TINST_REF G3
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C (+)
AND E.FEATURE_ID_C=D.FEATURE_ID_C (+)
AND (A.ISSUER_ID_C=E.ISSUER_ID_C (+)
AND A.ISSUE_ALPHA_C=E.ISSUE_ALPHA_C (+))
AND B.UNDWRTR_SUB_ID_C = G1.INST_SUB_ID_C (+)
AND B.UNDWRTR_INST_CAT_C = 'UNDW'
AND G1.INST_CATEGORY_C = 'UNDW'
AND B.BOND_CNSL_SUB_ID_C = G2.INST_SUB_ID_C (+)
AND B.BOND_INST_CAT_C = 'UNDW'
AND G2.INST_CATEGORY_C = 'UNDW'
AND B.FISCL_SUB_ID_C = G3.INST_SUB_ID_C (+)
AND B.FISCL_INST_CAT_C = 'UNDW'
AND G3.INST_CATEGORY_C = 'UNDW'


HILLARY-IDC CUSIPS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.OFFERING_ID_C AS OFFERING, E.ISSUING_CUSIP_T AS ISS_DESC, E.DATED_D, E.SECURITY_TYPE_C, E.PURP_TYPE_C, E.PURP_CLASS_C, E.PURP_SUB_CLASS_C, TO_CHAR(A.COUPON_ORGL_P,'99.999') AS COUPON, A.MATURITY_D AS MATURITY, B.PAYMENT_FIRST_D AS FC_DATE, B.FREQ_PERIOD_C AS INT_PAY_FREQ, C.OTL_TEXT_T AS CALL_OTL, D1.CRDT_RATE_C AS MDY_RATING, D1.CRDT_RATE_TYPE_C AS MDY_TYPE, D2.CRDT_RATE_C AS SP_RATING, D2.CRDT_RATE_TYPE_C AS SP_TYPE, D3.CRDT_RATE_C AS FTH_RATING, D3.CRDT_RATE_TYPE_C AS FTH_TYPE, E.ACCRUAL_COUNT_C AS DAY_COUNT, A.INT_MULT_DENOM_3_M AS DENOM, A.ISSUE_ORGL_M AS ISSUE_AMNT, A.ISSUE_OTSD_M AS OUTSTANDING_AMNT, F.UNDWRTR_N AS UNDERWRITER, G.SALE_NOTICE_D AS SALE_DATE, G.INITIAL_TRADE_D AS INITIAL_TRADE_DATE, TO_CHAR (G.SALE_NOTICE_D,'MM/DD/YYYY') AS AWARD_DATE, TO_CHAR (G.SALE_NOTICE_Z,'HH:MI:SS AM') AS AWARD_TIME, TO_CHAR (G. SD_RCVD_MODIFIED_Z,'MM/DD/YYYY') AS FIRST_EXECUTION_DATE, TO_CHAR (G. SUBMISSION_TIME_Z,'HH:MI:SS AM') AS FIRST_EXECUTION_TIME
FROM KBS.TISSUE_REF A, KBS.TINT_PAY_CYCLE B, KBS.TISSUING_OTL C, KBS.TISSUE_CRDT_RATING D1, KBS.TISSUE_CRDT_RATING D2, KBS.TISSUE_CRDT_RATING D3, KBS.TISSUING_REF E, KBS.TUNDERWRITER_REF F, KBS.TOFFERING_REF G
WHERE A.ISSUING_ID_C = B.ISSUING_ID_C (+)
AND A.ISSUING_ID_C = C.ISSUING_ID_C (+)
AND A.ISSUE_ID_C=D1.ISSUE_ID_C (+)
AND A.ISSUE_ID_C=D2.ISSUE_ID_C (+)
AND A.ISSUE_ID_C=D3.ISSUE_ID_C (+)
AND A.ISSUING_ID_C=E.ISSUING_ID_C (+)
AND A.OFFERING_ID_C=G.OFFERING_ID_C
AND F.UNDWRTR_ID_C=G.UNDWRTR_ID_C 
AND '48' = C.OTL_ID_C (+)
AND 'MDY' = D1.CRDT_RATG_AGNCY_C (+)
AND 'SP'= D2.CRDT_RATG_AGNCY_C (+)
AND 'FTH'= D3.CRDT_RATG_AGNCY_C (+)
AND 48=C.OTL_ID_C (+)



COMMENT_TYPE_I = 'E'
 AND (COMMENT_LINE_T LIKE '%SINKING FUND EXISTS%'
 OR COMMENT_LINE_T LIKE '%LOC EXISTS%')



IPD-FULL BUILD OUT QUERY
SELECT DISTINCT A.CUSIP9, A.QSIP_ISSUER_DESC, A.QSIP_DATED_DATE, A.QSIP_MATURITY_DATE, A.QSIP_ISSUING_DESC, B.CALL_FIRST_TYPE, C.OFFR_SECURITY_TYPE, C.OFFR_SALE_DATE, C.OFFR_SALE_STATUS, C.OFFR_SETTLEMENT_DATE, C.OFFR_SETTLEMENT_STATUS, D.AO_TYPE, D.AO_ENHANCER_NAME, 
FROM MASTER_REF.SPSE_CUSIPREC_QS A, SPSE_CALLREC_CA B, SPSE_OFFERINGREC_OF C, 
WHERE A.CUSIP9=B.CUSIP9 (+)
AND A.CUSIP9=C.CUSIP9 (+)
AND A.CUSIP9=D.CUSIP9 (+)

MB-VARIOUS FIELDS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.MATURITY_D AS MATURITY, F.SALE_NOTICE_D, F.SALE_STATUS_C, F.SETTLMNT_D, F.SETTLMNT_STATUS_C, E.SECURITY_TYPE_C, A.COUPON_ORGL_P AS COUPON, A.OFFERING_PRICE_P AS ISSUE_PRICE, A.ISSUE_ORGL_M AS ISSUE_AMNT, A.ISSUE_OTSD_M AS OUTSTANDING_AMNT, D1.CRDT_RATE_C AS MDY_RATING, D2.CRDT_RATE_C AS SP_RATING, D3.CRDT_RATE_C AS FTH_RATING, A.UNIT_DENOM_1_M AS INITIAL_DENOM, A.INT_MULT_DENOM_3_M AS INCREMENTAL_DENOM
FROM KBS.TISSUE_REF A, KBS.TINT_PAY_CYCLE B, KBS.TISSUING_OTL C, KBS.TISSUE_CRDT_RATING D1, KBS.TISSUE_CRDT_RATING D2, KBS.TISSUE_CRDT_RATING D3, KBS.TISSUING_REF E, KBS.TOFFERING_REF F
WHERE A.ISSUING_ID_C = B.ISSUING_ID_C (+)
AND A.ISSUING_ID_C = C.ISSUING_ID_C (+)
AND A.ISSUE_ID_C=D1.ISSUE_ID_C (+)
AND A.ISSUE_ID_C=D2.ISSUE_ID_C (+)
AND A.ISSUE_ID_C=D3.ISSUE_ID_C (+)
AND A.ISSUING_ID_C=E.ISSUING_ID_C (+)
AND A.OFFERING_ID_C=F.OFFERING_ID_C
AND '48' = C.OTL_ID_C (+)
AND 'MDY' = D1.CRDT_RATG_AGNCY_C (+)
AND 'SP'= D2.CRDT_RATG_AGNCY_C (+)
AND 'FTH'= D3.CRDT_RATG_AGNCY_C (+)


MB-LIST OF CUSIPS WITH SPECIFIC CLASS AND INST TYPE
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, C.INST_TYPE_C, B.PURP_TYPE_C, B.PURP_CLASS_C, B.PURP_SUB_CLASS_C, D.ISSUER_DESC_T AS ISSUER, B.ISSUING_CUSIP_T AS ISSUING_DESC
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, KBS.TINST_REF C, KBS.TISSUER_REF D
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.INST_ID_C=C.INST_ID_C
AND A.ISSUER_ID_C=D.ISSUER_ID_C
AND C.INST_TYPE_C = 'MUNI'
AND B.PURP_CLASS_C in ('AGYG','BANK','IND')
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
ORDER BY 4 ASC


MB-ALL 3 CURENCY FIELDS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.CUR_ORGL_ID_C AS ISSUE_CURRENCY, D.CUR_ID_C AS ISSUING_CURRENCY, B.CUR_ORGL_ID_C AS OFFERING_CURRENCY 
FROM KBS.TISSUE_REF A, KBS.TOFFERING_REF B, KBS.TINT_PAY_CYCLE C, KBS.TISSUING_REF D
WHERE A.OFFERING_ID_C=B.OFFERING_ID_C (+)
AND A.ISSUING_ID_C=C.ISSUING_ID_C (+)
AND A.ISSUING_ID_C=D.ISSUING_ID_C (+)


b.MODIFIED_Z BETWEEN TO_TIMESTAMP('2/1/2017 1:00:00.000000 AM','fmMMfm/fmDDfm/YYYY fmHH12fm:MI:SS.FF AM') AND TO_TIMESTAMP('2/28/2017 10:00:00.000000 PM','fmMMfm/fmDDfm/YYYY fmHH12fm:MI:SS.FF AM'))
AND (b.modified_by_c = 'KI713'
or b.modified_by_c = 'KI714'
or b.modified_by_c = 'KI715'
or b.modified_by_c = 'KI716'
or b.modified_by_c = 'KI718'
or b.modified_by_c = 'KI719'
or b.modified_by_c = 'KI720'
or b.modified_by_c = 'KI721'
or b.modified_by_c = 'KI722'
or b.modified_by_c = 'KI723'
or b.modified_by_c = 'KI724'
or b.modified_by_c = 'KI725'
or b.modified_by_c = 'KI726'
or b.modified_by_c = 'KI727'
or b.modified_by_c = 'KI728'
or b.modified_by_c = 'KI730'
or b.modified_by_c = 'KI732'
or b.modified_by_c = 'KI733'
or b.modified_by_c = 'KI734'
or b.modified_by_c = 'KI735'
or b.modified_by_c = 'KI804'
or b.modified_by_c = 'KI808'
or b.modified_by_c = 'KI809'
or b.modified_by_c = 'KI810'
or b.modified_by_c = 'KI814'
or b.modified_by_c = 'KI815'
or b.modified_by_c = 'KI816'
or b.modified_by_c = 'KI817'
or b.modified_by_c = 'KI819'
or b.modified_by_c = 'KI820')


GARY-MB-EDI ONLY CUSIPS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP , B.ADDED_Z 
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND EXISTS (
SELECT DISTINCT OFFERING_ID_C 
FROM KBS.TINFO_SOURCE C 
WHERE C.OFFERING_ID_C=A.OFFERING_ID_C 
AND C.USER_ID_C= 'EDI'
)
AND NOT EXISTS (
SELECT DISTINCT OFFERING_ID_C 
FROM KBS.TINFO_SOURCE C 
WHERE C.OFFERING_ID_C=A.OFFERING_ID_C 
AND C.USER_ID_C LIKE 'KI%'
)
AND A.ADDED_Z BETWEEN TO_DATE('04/05/2017 01:00 AM', 'MM/DD/YYYY HH:MI PM') AND TO_DATE('04/05/2017 11:00 PM', 'MM/DD/YYYY HH:MI AM')


MB-HIGHEST OTL LINE NUMBER (MAX)
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, A.OFFERING_ID_C, A.ISSUING_ID_C, B.OTL_ID_C, B.OTL_TEXT_T
FROM KBS.TISSUE_REF A, KBS.TISSUING_OTL B
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C (+)
AND B.OTL_ID_C IN (SELECT DISTINCT MAX(OTL_ID_C) FROM KBS.TISSUING_OTL CALL WHERE CALL.ISSUING_ID_C=A.ISSUING_ID_C)
ORDER BY 1 ASC


SDM-MELISSA-CUSIPS WITH SALE DATE OF XX/XX/XXXX
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, A.OFFERING_ID_C, C.INST_TYPE_C, B.*
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, KBS.TISSUER_REF C
Where A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUER_ID_C=C.ISSUER_ID_C
AND B.SALE_NOTICE_D = to_date('04/05/2017','mm/dd/yyyy')
AND C.INST_TYPE_C = 'MUNI'
AND B.ISSUING_CUSIP_T NOT LIKE '%COML PAPER%'
ORDER BY 1 ASC NULLS LAST

MB-MELISSA-TIMESTAMPS FOR TISSUE AND CALL OTL
SELECT DISTINCT A.OFFERING_ID_C, TO_CHAR(A.ADDED_Z, 'MM-DD-YYYY HH:MI AM') AS COUPON_TIMESTAMP, TO_CHAR(B.ADDED_Z, 'MM-DD-YYYY HH:MI AM') AS CALL_TIMESTAMP 
FROM KBS.TISSUE_REF A, KBS.TISSUING_OTL B
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C (+)
AND A.ADDED_Z IN (SELECT DISTINCT MIN(ADDED_Z) FROM KBS.TISSUE_REF COUPON WHERE COUPON.ISSUE_ID_C=A.ISSUE_ID_C)
AND B.ADDED_Z IN (SELECT DISTINCT MIN(ADDED_Z) FROM KBS.TISSUING_OTL CALL WHERE CALL.ISSUING_ID_C=A.ISSUING_ID_C)
AND '48'= B.OTL_ID_C (+)

LIZ/JANICE-MB-MUNI CUSIPS-PARTIAL CALLS WITHOUT AMOUNTS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, C.CALL_D, B.FULL_PART_CALL_C, B.CALL_PRICE_L, B.CALLED_AMT_L, C.DOC_PREFIX_ID_C, C.DOCUMENT_ID_C, C.DOC_CK_DIGIT_C
FROM KBS.TISSUE_REF A, KBS.TCALLED_ISSUE B, KBS.TCALLED_BOND C, KBS.TINST_REF D
Where (A.ISSUER_ID_C=B.ISSUER_ID_C AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C) 
AND B.FEATURE_ID_C=C.FEATURE_ID_C
AND A.INST_ID_C=D.INST_ID_C
AND D.INST_TYPE_C = 'MUNI'
AND B.FULL_PART_CALL_C = 'PART'
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND B.CALLED_AMT_L IS NULL 
AND C.DOCUMENT_ID_C IS NOT NULL
AND NOT EXISTS (SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X, KBS.TCALLED_BOND Y 
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND X.ISSUER_ID_C=A.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND Y.CALL_D < (SYSDATE))
ORDER BY 1 ASC NULLS LAST


Dalcomp feed
SELECT DISTINCT B.*, C.*
FROM KBS.TISSUE_REF A, KBS.TCRDT_ENHMT_REF B, KBS.TINFO_SOURCE C 
Where A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.OFFERING_ID_C=C.OFFERING_ID_C
AND B.CRDT_ENHMT_TYPE_C = 'SCH'
AND B.ADDED_BY_C LIKE 'DALCOM%'
AND C.USER_ID_C = 'DALCOM'  
AND ROWNUM < 100
 ORDER BY 41 DESC NULLS LAST


MB-ALINA-PUT INFO 
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, SUBSTR(B.OTL_TEXT_T,1,4) AS PUT_TYPE, to_date(SUBSTR(B.OTL_TEXT_T,5,6),'mm/dd/yy') AS PUT_DATE, SUBSTR(B.OTL_TEXT_T,12,3) AS PUT_PRICE, SUBSTR(B.OTL_TEXT_T,17,3) AS PUT_FREQ, SUBSTR(B.OTL_TEXT_T,25,7) AS PUT_NOTIF, SUBSTR(B.OTL_TEXT_T,32,1) AS PUT_BDHLDR_CMMIT
FROM KBS.TISSUING_OTL B, KBS.TISSUE_REF A
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND B.OTL_ID_C = '43'
AND B.OTL_TEXT_T LIKE 'PUT%'




SELECT DISTINCT A.CUSIP, B.DATED_DATE, C.*
FROM O_MUNI$Xref$Instrument A
JOIN O_MUNI$RefData$Instrument B on A.ENTITY_ID=B.ENTITY_ID
JOIN O_MUNI$RefData$Issue C on A.ENTITY_ID=C.ENTITY_ID 
WHERE CUSIP LIKE '64966E%'
AND B.DATED_DATE > '01/01/2016'


SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, A.ISSUING_ID_C, B.CALL_BEGIN_D, B.CALL_BEGIN_PRICE_L, B.CALL_FREQ_INC_C
FROM KBS.TISSUE_REF A, CVN.TCALL_DETAIL B, KBS.TINDEX_GROUPING C, KBS.TVARIABLE_FEATURE D
Where A.ISSUING_ID_C=B.ISSUING_ID_C
AND (A.ISSUER_ID_C=C.ISSUER_ID_C AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C)
AND (A.ISSUER_ID_C=D.ISSUER_ID_C AND A.ISSUE_ALPHA_C=D.ISSUE_ALPHA_C)
AND D.VARIABLE_TYPE_C = 'FRN'
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
OR ((A.issuer_id_c = '78010U' and A.issue_alpha_c = 'CT')
OR (A.issuer_id_c = '48126N' and A.issue_alpha_c = '5V')
)
ORDER BY 1 ASC NULLS LAST


Corp call issue—query isn't helpful since issue correct in mbui, only broken in extract
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, C.DATED_D, A.MATURITY_D, E.WHOLE_PART_FREQ_C, B.CALL_D, B.CALL_PRICE_L, B.CALL_BEGIN_D, B.CALL_END_D, B.ADDED_Z
FROM KBS.TISSUE_REF A, CVN.TCALL_SCHEDULE B, KBS.TISSUING_REF C, KBS.TVARIABLE_FEATURE D, CVN.TCALL_DETAIL E
Where A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND (A.ISSUER_ID_C=D.ISSUER_ID_C AND A.ISSUE_ALPHA_C=D.ISSUE_ALPHA_C)
AND B.CALL_D < (SYSDATE-360)
AND C.DATED_D > TO_DATE('01/01/2008','MM/DD/YYYY')
AND A.MATURITY_D < TO_DATE('01/01/2030','MM/DD/YYYY')
and a.maturity_d > (sysdate)
and a.maturity_type_c <> '*'
 ORDER BY 9 DESC, 5 ASC NULLS LAST


SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.FEATURE_ID_C, B.FULL_PART_CALL_C, C.CALL_D, B.CALL_PRICE_L, B.CALLED_AMT_L
FROM KBS.TISSUE_REF A, KBS.TCALLED_ISSUE B, KBS.TCALLED_BOND C
WHERE A.ISSUER_ID_C=B.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C (+)
AND B.FEATURE_ID_C=C.FEATURE_ID_C (+)


JOHN-DAY OF MONTH ACCRUAL DATE <> DAY OF MONTH PAYMENT
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, L.ACCRUAL_FIRST_D, L.PAYMENT_FIRST_D, L.FREQ_PER_OCCUR_Q, L.FREQ_PERIOD_C, L.FREQ_Q, L.FREQ_DAY_C 
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF C, KBS.TINT_PAY_CYCLE L, KBS.TINST_REF M 
WHERE A.ISSUING_ID_C=C.ISSUING_ID_C (+)
AND A.ISSUING_ID_C=L.ISSUING_ID_C (+)
AND A.INST_ID_C=M.INST_ID_C
AND M.INST_TYPE_C = 'MUNI'
--AND L.FREQ_PERIOD_C = 'MO'
AND L.FREQ_Q = 1
AND L.FREQ_DAY_C = 'BUS'
AND SUBSTR(TO_CHAR(L.ACCRUAL_FIRST_D,'MM/DD/YYYY'),4,2) <> '01'
AND SUBSTR(TO_CHAR(L.PAYMENT_FIRST_D,'MM/DD/YYYY'),4,2) = '01' 
AND NOT EXISTS (SELECT DISTINCT 'CALL' 
FROM KBS.TISSUING_OTL 
WHERE ISSUING_ID_C=A.ISSUING_ID_C 
AND OTL_ID_C='44')
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
ORDER BY 2 DESC NULLS LAST

ALINA-MB-ALL ACTIVE CHURCH BONDS (6/9/17)
SELECT DISTINCT A.ISSUER_ID_C, A.ISSUE_ALPHA_C, C.INST_TYPE_C, C.INST_N
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, KBS.TINST_REF C
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.INST_ID_C=C.INST_ID_C
AND B.PURP_CLASS_C= 'CHUR'
AND A.MATURITY_D > SYSDATE
AND A.MATURITY_TYPE_C <> '*'
ORDER BY 1 ASC NULLS LAST

MIKE
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, B.INST_TYPE_C, C.*
FROM KBS.TISSUE_REF A, KBS.TINST_REF B, KBS.TINFO_SOURCE C
WHERE A.INST_ID_C=B.INST_ID_C
AND A.OFFERING_ID_C=C.OFFERING_ID_C
AND B.INST_TYPE_C IN ('MUNI','CORP','GOVT')
AND C.ADDED_Z IN (SELECT DISTINCT MAX(X.ADDED_Z) FROM KBS.TINFO_SOURCE X WHERE X.OFFERING_ID_C=A.OFFERING_ID_C)
AND ((A.issuer_id_c = '30382L' and A.issue_alpha_c = 'BX')


ALL ACTIVE CUSIPS IN MB WITH MBIA/NO INSURANCE
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, B.DATED_D, A.MATURITY_D, A1.INST_TYPE_C, E.INST_ID_C, E.INST_N, F1.CRDT_RATE_C AS SP, F1.CRDT_RATG_EFF_D AS RTG_DATE, F2.CRDT_RATE_C AS SPU, F2.CRDT_RATG_EFF_D AS RTG_DATE, F3.CRDT_RATE_C AS SPE, F3.CRDT_RATG_EFF_D AS RTG_DATE
FROM KBS.TISSUE_REF A, KBS.TINST_REF A1, KBS.TISSUING_REF B, KBS.TISSUER_REF B2, KBS.TCRDT_ENHMT_REF C, KBS.TCRDT_ENHMT_INST D, KBS.TINST_REF E, KBS.TISSUE_CRDT_RATING F1, KBS.TISSUE_CRDT_RATING F2, KBS.TISSUE_CRDT_RATING F3
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.INST_ID_C=A1.INST_ID_C
AND A.ISSUER_ID_C=B2.ISSUER_ID_C
AND B2.ISSUER_DESC_T NOT LIKE 'ADAMSVILLE%'
AND A.ISSUING_ID_C=C.ISSUING_ID_C
AND C.CRDT_ENHMT_ID_C=D.CRDT_ENHMT_ID_C 
AND D.INST_ID_C=E.INST_ID_C 
AND A.ISSUE_ID_C=F1.ISSUE_ID_C (+)
AND A.ISSUE_ID_C=F2.ISSUE_ID_C (+)
AND A.ISSUE_ID_C=F3.ISSUE_ID_C (+)
AND 'SP' = F1.CRDT_RATG_AGNCY_C (+)
AND 'L' = F1.CRDT_RATE_TYPE_C (+)
AND 'SPU' = F2.CRDT_RATG_AGNCY_C (+)
AND 'L' = F2.CRDT_RATE_TYPE_C (+)
AND 'SPE' = F3.CRDT_RATG_AGNCY_C (+)
AND 'L' = F3.CRDT_RATE_TYPE_C (+)
AND A.MATURITY_D > TO_DATE('06/26/2017','MM/DD/YYYY')
AND A.MATURITY_TYPE_C <> '*'AND E.INST_ID_C IN (118594,484187)
AND NOT EXISTS (SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X, KBS.TCALLED_BOND Y 
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND X.ISSUER_ID_C=A.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND Y.CALL_D < TO_DATE('06/27/2017','MM/DD/YYYY'))
ORDER BY 1 ASC

SP FEED RECEIVED FOR MBIA/NP CUSIPS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, B.DATED_D, A.MATURITY_D, A1.INST_TYPE_C, E.INST_ID_C, E.INST_N, SP.MAT_LT_RATG AS FEED_RTG, SP.MAT_LT_RATG_DT AS FEED RTG_DATE
FROM KBS.TISSUE_REF A, KBS.TINST_REF A1, KBS.TISSUING_REF B, KBS.TCRDT_ENHMT_REF C, KBS.TCRDT_ENHMT_INST D, KBS.TINST_REF E, VDLCUSIP.RATG_SPPF_XF_FEED SP
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.INST_ID_C=A1.INST_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C
AND C.CRDT_ENHMT_ID_C=D.CRDT_ENHMT_ID_C 
AND D.INST_ID_C=E.INST_ID_C 
AND A.MATURITY_D > TO_DATE('06/26/2017','MM/DD/YYYY') 
AND A.MATURITY_TYPE_C <> '*'
AND E.INST_ID_C IN (118594,484187)
AND (A.ISSUER_ID_C = SP.ISSUER_ID_C (+)
AND A.ISSUE_ALPHA_C = SP.ISSUE_ALPHA_C (+))
AND SP.MAT_LT_RATG_DT IN (SELECT DISTINCT MAX(MAT_LT_RATG_DT) FROM VDLCUSIP.RATG_SPPF_XF_FEED FEED WHERE FEED.ISSUER_ID_C=A.ISSUER_ID_C AND FEED.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C)
AND NOT EXISTS (SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X, KBS.TCALLED_BOND Y 
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND X.ISSUER_ID_C=A.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND Y.CALL_D < TO_DATE('06/27/2017','MM/DD/YYYY'))
ORDER BY 8 DESC NULLS LAST


MB-FORN OFFERINGS WITH MULTIPLE CINS (SHOULD BE 1 PER OFFERING)
SELECT DISTINCT A.OFFERING_ID_C 
FROM KBS.TISSUE_REF A, KBS.TISSUE_REF A1, KBS.TINST_REF C, KBS.TISSUER_REF D
WHERE A.INST_ID_C = C.INST_ID_C
AND A1.INST_ID_C=C.INST_ID_C
AND A.ISSUER_ID_C=D.ISSUER_ID_C
AND D.ISSUER_DESC_T NOT LIKE 'ADAMSVILLE%'
AND A.OFFERING_ID_C=A1.OFFERING_ID_C
AND A.ISSUE_ALPHA_C<>A1.ISSUE_ALPHA_C
AND A.MATURITY_D > SYSDATE
AND A1.MATURITY_D > SYSDATE
AND C.INST_TYPE_C ='FORN'

MB-FORN ISSUINGS WITH MULTIPLE CINS (SHOULD BE 1 PER ISSUING)
SELECT DISTINCT A.ISSUING_ID_C 
FROM KBS.TISSUE_REF A, KBS.TISSUE_REF A1, KBS.TINST_REF C, KBS.TISSUER_REF D
WHERE A.INST_ID_C=C.INST_ID_C
AND A1.INST_ID_C=C.INST_ID_C
AND A.ISSUER_ID_C=D.ISSUER_ID_C
AND D.ISSUER_DESC_T NOT LIKE 'ADAMSVILLE%'
AND A.ISSUING_ID_C=A1.ISSUING_ID_C
AND A.ISSUE_ALPHA_C<>A1.ISSUE_ALPHA_C
AND A.MATURITY_D > SYSDATE
AND A1.MATURITY_D > SYSDATE
AND C.INST_TYPE_C ='FORN'


HILLARY-MB-MUNIS WITH DATED DTAE <> 1/15/30/SETTLE DATE
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, B.DATED_D, E.ACCRUAL_FIRST_D, C.SETTLMNT_D, C.SETTLMNT_STATUS_C, A.ISSUING_ID_C, A.MATURITY_D
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, KBS.TOFFERING_REF C, KBS.TINST_REF D , KBS.TINT_PAY_CYCLE E   
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.OFFERING_ID_C=C.OFFERING_ID_C
AND A.INST_ID_C=D.INST_ID_C
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND SUBSTR(TO_CHAR(B.DATED_D,'MM/DD/YYYY'),4,2) <> '01'
AND SUBSTR(TO_CHAR(B.DATED_D,'MM/DD/YYYY'),4,2) <> '15'
AND SUBSTR(TO_CHAR(B.DATED_D,'MM/DD/YYYY'),4,2) <> '30'
AND SUBSTR(TO_CHAR(B.DATED_D,'MM/DD/YYYY'),4,2) <> SUBSTR(TO_CHAR(C.SETTLMNT_D,'MM/DD/YYYY'),4,2)
AND D.INST_TYPE_C = 'MUNI'
AND A.MATURITY_D > SYSDATE 
AND A.MATURITY_TYPE_C <> '*'
AND NOT EXISTS (SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X, KBS.TCALLED_BOND Y 
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND X.ISSUER_ID_C=A.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND Y.CALL_D < SYSDATE)

JOHN-NIIDS COUNTS
SELECT DISTINCT SENT_DATE
FROM KBS.TNIIDS_FEED
Where
CPN_TP = 'FRN'
AND SENT_DATE > TO_DATE('07/12/2016','MM/DD/YYYY')
 ORDER BY 1 ASC NULLS LAST

HILLARY-MIN DENOM
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, D.INST_TYPE_C, A.MIN_TRDE_DENOM_2_M
FROM KBS.TISSUE_REF A, KBS.TOFFERING_REF C, KBS.TINST_REF D
WHERE C.OFFERING_ID_C = A.OFFERING_ID_C
AND A.INST_ID_C=D.INST_ID_C


MIKE FLANIGAN-VARIOUS T&C'S
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, D.DATED_D, A.MATURITY_D, SUBSTR(F.OTL_TEXT_T,1,3) AS VAR, (SUBSTR(F.OTL_TEXT_T,5,6) AS RESET_DAY, SUBSTR(F.OTL_TEXT_T,12,2) AS VAR_FREQ, D.MUNI_TAX_I AS GO_INDICATOR, B.INST_N AS SECONDARY_INSUR, D.AMT_TAX_I AS AMT, TO_DATE(SUBSTR(H1.OTL_TEXT_T,18,6),'MM/DD/YY') AS CONVERSION_DATE, CONCAT(SUBSTR(H1.OTL_TEXT_T,37,2),SUBSTR(H2.OTL_TEXT_T,1,3)) AS CONVERSION_RATE, K.INDEX_TYPE AS BENCHMARK  
FROM KBS.TISSUE_REF A, KBS.TINST_REF B, KBS.TOFFERING_REF C, KBS.TISSUING_REF D, KBS.TISSUING_OTL F, KBS.TCRDT_ENHMT_REF G1, KBS.TCRDT_ENHMT_INST G2, KBS.TISSUING_OTL H1, KBS.TISSUING_OTL H2, KBS.TINDEX_GROUPING K
WHERE A.OFFERING_ID_C=C.OFFERING_ID_C (+)
AND A.ISSUING_ID_C=D.ISSUING_ID_C (+)
AND A.ISSUING_ID_C=F.ISSUING_ID_C (+)
AND A.ISSUING_ID_C=G1.ISSUING_ID_C (+)
AND G1.CRDT_ENHMT_ID_C=G2.CRDT_ENHMT_ID_C (+)
AND G2.INST_ID_C=B.INST_ID_C (+)
AND A.ISSUING_ID_C=H1.ISSUING_ID_C (+)
AND H1.ISSUING_ID_C=H2.ISSUING_ID_C (+)
AND A.ISSUER_ID_C =K.ISSUER_ID_C (+)
AND A.ISSUE_ALPHA_C=K.ISSUE_ALPHA_C (+)
AND '44'=F.OTL_ID_C (+)
AND 'VAR'= SUBSTR(F.OTL_TEXT_T(+),1,3)
AND 'INSN'=G1.CRDT_ENHMT_TYPE_C (+)
AND 'S'= G1.PRIM_SECONDARY_C (+)
AND '61'=H1.OTL_ID_C (+)
AND 'CCA'=SUBSTR(H1.OTL_TEXT_T(+),1,3)
AND '61'=H2.OTL_ID_C (+)
AND H1.OTL_LINE_NUMBER_C < H2.OTL_LINE_NUMBER_C(+)


TEST CUSIP FOR OTSD AMNT UAT
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, A.MATURITY_D, A.COUPON_ORGL_P, A.ISSUE_ORGL_M, A.PRIN_INIT_I, B.*
FROM KBS.TISSUE_REF A, KBS.OUTSTANDING_AMT_SCHEDULE B, KBS.TINST_REF C
WHERE A.ISSUER_ID_C=B.ISSUER_ID_C (+)
AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C (+)
AND A.INST_ID_C=C.INST_ID_C
AND C.INST_TYPE_C = 'MUNI'
AND A.MATURITY_D > SYSDATE
AND A.MATURITY_TYPE_C <> '*'
AND A.ISSUER_ID_C NOT LIKE '0%'
AND A.ISSUER_ID_C NOT LIKE '1%'
AND A.ISSUER_ID_C NOT LIKE '3%'
--AND A.COUPON_ORGL_P = 0
--AND A.PRIN_INIT_I='O'
AND ROWNUM <= 50000


HILLARY-CRDT ENHMT ID'S (MB)
SELECT DISTINCT concat(a.issuer_id_c,a.issue_alpha_c) as cusip, a.maturity_d, a.offering_id_c, b.crdt_enhmt_id_c, b.* 
FROM kbs.tissue_ref a, KBS.TCRDT_ENHMT_REF b
Where a.issuing_id_c=b.issuing_id_c
--and a.maturity_d > sysdate


HILLARY-PAC BONDS (2 QUERIES)
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, C.ISSUING_CUSIP_T, A.OFFERING_ID_C, A.ISSUING_ID_C, D.COMMENT_LINE_T  
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF C, KBS.TCOMMENTS D 
WHERE A.ISSUING_ID_C=C.ISSUING_ID_C
AND A.OFFERING_ID_C=D.OFFERING_ID_C (+)
AND D.TABLE_PRIM_KEY_C=A.ISSUING_ID_C
AND (C.ISSUING_CUSIP_T LIKE 'PAC%'
OR D.COMMENT_LINE_T  LIKE '%-PAC%'
OR D.COMMENT_LINE_T  LIKE '% PAC%')
AND D.COMMENT_LINE_T  NOT LIKE '%MIC-PAC%'
AND D.COMMENT_LINE_T  NOT LIKE '%PACK%'
AND D.COMMENT_LINE_T  NOT LIKE '%PACE%'
AND D.COMMENT_LINE_T  NOT LIKE '%PACI%'
AND D.COMMENT_LINE_T  NOT LIKE '%PACL%'
AND D.COMMENT_LINE_T  NOT LIKE '%APAC%'
AND D.COMMENT_LINE_T  NOT LIKE '%PACC%'
AND D.COMMENT_LINE_T  NOT LIKE '%PACT%'
AND D.COMMENT_LINE_T  NOT LIKE '%PACO%'
AND D.COMMENT_LINE_T  NOT LIKE '%PAC GAS%'
AND D.COMMENT_LINE_T  NOT LIKE '%PAC PKG%'
AND D.COMMENT_LINE_T  NOT LIKE '%ASIA PAC%'
AND D.COMMENT_LINE_T  NOT LIKE '%PAC COR%'
AND D.COMMENT_LINE_T  NOT LIKE '%PAC PWR%'
AND D.COMMENT_LINE_T  NOT LIKE '%UNION PAC%'
AND D.COMMENT_TYPE_I = 'E'
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
ORDER BY 1 ASC NULLS LAST

AND PUT TOGETHER WITH THIS QUERY:

SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, C.ISSUING_CUSIP_T, A.OFFERING_ID_C, A.ISSUING_ID_C
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF C, KBS.TCOMMENTS D 
WHERE A.ISSUING_ID_C=C.ISSUING_ID_C
AND A.OFFERING_ID_C=D.OFFERING_ID_C (+)
AND D.TABLE_PRIM_KEY_C=A.ISSUING_ID_C
AND (C.ISSUING_CUSIP_T LIKE 'PAC%'
OR C.ISSUING_CUSIP_T LIKE '%-PAC%'
OR C.ISSUING_CUSIP_T LIKE '% PAC%')
AND C.ISSUING_CUSIP_T NOT LIKE '%MIC-PAC%'
AND C.ISSUING_CUSIP_T NOT LIKE '%PACK%'
AND C.ISSUING_CUSIP_T NOT LIKE '%PACE%'
AND C.ISSUING_CUSIP_T NOT LIKE '%PACI%'
AND C.ISSUING_CUSIP_T NOT LIKE '%PACL%'
AND C.ISSUING_CUSIP_T NOT LIKE '%APAC%'
AND C.ISSUING_CUSIP_T NOT LIKE '%PACC%'
AND C.ISSUING_CUSIP_T NOT LIKE '%PACT%'
AND C.ISSUING_CUSIP_T NOT LIKE '%PACO%'
AND C.ISSUING_CUSIP_T NOT LIKE '%PAC GAS%'
AND C.ISSUING_CUSIP_T NOT LIKE '%PAC PKG%'
AND C.ISSUING_CUSIP_T NOT LIKE '%ASIA PAC%'
AND C.ISSUING_CUSIP_T NOT LIKE '%PAC COR%'
AND C.ISSUING_CUSIP_T NOT LIKE '%PAC PWR%'
AND C.ISSUING_CUSIP_T NOT LIKE '%UNION PAC%'
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
ORDER BY 1 ASC NULLS LAST


JOHN-LIBOR/SIFMA EXAMPLES
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, D.INST_TYPE_C, A.OFFERING_ID_C, C.INDEX_TYPE, C.INDEX_SUB_TYPE, C.CUTOFF_FREQ_CD, C.CUTOFF_TIMEZONE_CD, E.FREQ_PERIOD_C AS FREQ, A.COUPON_ORGL_P AS ISSUE_CPN, B.ADJ_RATE, B.ADJ_DT, B.BEGIN_DT, B.END_DT, B.CALC_COUPON_I, B.UPDATED_COUPON_I, B.ADDED_BY_C, B.ADDED_Z, B.MODIFIED_BY_C, B.MODIFIED_Z
FROM KBS.TISSUE_REF A, KBS.TVARIABLE_SCHEDULE B, KBS.TINDEX_GROUPING C, KBS.TINST_REF D, KBS.TVARIABLE_FEATURE E
WHERE (A.ISSUER_ID_C=B.ISSUER_ID_C AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C)
AND (A.ISSUER_ID_C=C.ISSUER_ID_C AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C)
AND D.INST_ID_C=A.INST_ID_C
AND (A.ISSUER_ID_C=E.ISSUER_ID_C AND A.ISSUE_ALPHA_C=E.ISSUE_ALPHA_C)
AND B.ADJ_DT BETWEEN TO_DATE(08/09/2017','MM/DD/YYYY') AND TO_DATE('08/10/2017','MM/DD/YYYY')
AND D.INST_TYPE_C = 'MUNI'
AND C.INDEX_TYPE IN ('LIBR', 'SMSW')
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND NOT EXISTS (
SELECT DISTINCT ISSUER_ID_C, ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE 
WHERE ISSUER_ID_C=A.ISSUER_ID_C
AND ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND FULL_PART_CALL_C = 'FULL')
ORDER BY 1 ASC

JOHN-SIFMA/LIBOR EXAMPLES
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, D.OFFERING_ID_C, A.INDEX_TYPE, A.INDEX_SUB_TYPE, A.SPREAD_PLUSMINUS_I, A.SPREAD_INT_RATE, A.SPREAD_BASIS_PTS, A.CUTOFF_FREQ_CD, B.ADJ_DT, C.FREQ_PERIOD_C, A.MODIFIED_BY_C
FROM KBS.TINDEX_GROUPING A, KBS.TVARIABLE_SCHEDULE B, KBS.TVARIABLE_FEATURE C, KBS.TISSUE_REF D, KBS.TINST_REF E
WHERE A.ISSUER_ID_C=B.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C
AND A.ISSUER_ID_C=C.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C
AND A.ISSUER_ID_C=D.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=D.ISSUE_ALPHA_C
AND D.INST_ID_C=E.INST_ID_C
AND D.MATURITY_D > (SYSDATE)
AND D.MATURITY_TYPE_C <> '*'
AND E.INST_TYPE_C = 'MUNI'
AND A.INDEX_TYPE = 'LIBR'
AND B.ADJ_DT BETWEEN TO_DATE('08/14/2017', 'MM/DD/YYYY') AND TO_DATE('08/21/2017', 'MM/DD/YYYY')
AND NOT EXISTS (SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X, KBS.TCALLED_BOND Y 
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND X.ISSUER_ID_C=D.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=D.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND Y.CALL_D < (SYSDATE))
AND ROWNUM<501
ORDER BY 9 ASC NULLS LAST

MB-ALINA-ABA LIST (ABA'S ON ALL ACTIVE MUNI BONDS)
SELECT DISTINCT C.ABA_N AS ABA, C.CITY_N, C.STATE_ID_C
FROM KBS.TISSUING_REF A, KBS.TISSUE_REF B, KBS.TISSUER_REF D, KBS.TINST_REF G1, KBS.TABA_REF C, KBS.TOFFERING_ABA K
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND B.ISSUER_ID_C=D.ISSUER_ID_C 
AND B.INST_ID_C=G1.INST_ID_C
AND B.OFFERING_ID_C=K.OFFERING_ID_C
AND C.ABA_OFFICE_ID_C=K. ABA_OFFICE_ID_C
AND C.ABA_BRNCH_ID_C=K. ABA_BRNCH_ID_C
AND G1.INST_TYPE_C = 'MUNI'
AND B.MATURITY_D > (SYSDATE)
AND B.MATURITY_TYPE_C <> '*'
AND NOT EXISTS (SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X, KBS.TCALLED_BOND Y 
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND X.ISSUER_ID_C=B.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND Y.CALL_D < (SYSDATE))
ORDER BY 1 ASC


SDM-ABA LIST
SELECT DISTINCT D.INST_N, D.CITY_N, D.STATE_ID_C, D.INST_CATEGORY_C, D.INST_SUB_ID_C, D.INST_CC6
FROM KBS.TISSUE_REF A, KBS.TISSUER_REF B, KBS.TOFFERING_ABA C, KBS.TINST_REF D 
WHERE A.ISSUER_ID_C=B.ISSUER_ID_C 
AND A.OFFERING_ID_C=C.OFFERING_ID_C
AND C.INST_SUB_ID_C=D.INST_SUB_ID_C
AND D.INST_CATEGORY_C = 'ABA'
AND B.INST_TYPE_C = 'MUNI'
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND NOT EXISTS (SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X 
WHERE X.ISSUER_ID_C=A.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND X.CALL_D < (SYSDATE))
ORDER BY 1 ASC




SDM-ALL SCH/INSR FOR ACTIVE MUNIS
SELECT DISTINCT A.CRDT_ENHMT_TYPE_C, A.CRDT_ENHMT_SUB_C, INST_SUB_ID_1_C AS INST_SUB_ID_C, B.INST_N, B.CITY_N, B.STATE_ID_C, B.INST_CC6, E.INST_N, E.CITY_N, E.STATE_ID_C 
FROM KBS.TCRDT_ENHMT_REF A, KBS.TINST_REF B, KBS.TISSUER_REF B1, KBS.TISSUE_REF C, KBS.TISSUER_REF D, KBS.TINST_REF E
Where A.INST_SUB_ID_1_C=B.INST_ID_C
AND B1.ISSUER_ID_C=C.ISSUER_ID_C
AND A.ISSUE_ID_C=C.ISSUE_ID_C
AND B.INST_CC6=D.ISSUER_ID_C
AND D.INST_SUB_ID_C=E.INST_SUB_ID_C
AND E.INST_CATEGORY_C = 'ISUR'
AND (A.CRDT_ENHMT_SUB_C = 'SCH'
OR A.CRDT_ENHMT_TYPE_C = 'INSR')
AND B1.INST_TYPE_C = 'MUNI'
AND C.MATURITY_D > (SYSDATE)
AND C.MATURITY_TYPE_C <> '*'
AND NOT EXISTS (SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X 
WHERE X.ISSUER_ID_C=C.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND X.CALL_D < (SYSDATE))
ORDER BY 1 ASC

JOHN-LIBOR CUSIP ADJ 8/15/17
SELECT DISTINCT A.*, B.*, C.*
FROM KBS.TVARIABLE_SCHEDULE A, KBS.TINDEX_GROUPING B, KBS.TISSUE_REF C
Where A.ISSUER_ID_C=B.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C
AND A.ISSUER_ID_C=C.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C
AND ((A.issuer_id_c = '20775C' and A.issue_alpha_c = 'TB')
OR (A.issuer_id_c = '54241A' and A.issue_alpha_c = 'BA')
OR (A.issuer_id_c = '54241A' and A.issue_alpha_c = 'BB')
OR (A.issuer_id_c = '54241A' and A.issue_alpha_c = 'BC')
OR (A.issuer_id_c = '54241A' and A.issue_alpha_c = 'BD')
OR (A.issuer_id_c = '913366' and A.issue_alpha_c = 'BT')
OR (A.issuer_id_c = '913366' and A.issue_alpha_c = 'BU')
OR (A.issuer_id_c = '913366' and A.issue_alpha_c = 'BV')
OR (A.issuer_id_c = '913366' and A.issue_alpha_c = 'BW')
OR (A.issuer_id_c = '20775B' and A.issue_alpha_c = 'R9')
OR (A.issuer_id_c = '20775B' and A.issue_alpha_c = 'S2')
OR (A.issuer_id_c = '20775B' and A.issue_alpha_c = 'S3')
OR (A.issuer_id_c = '20775B' and A.issue_alpha_c = 'S4')
OR (A.issuer_id_c = '59447T' and A.issue_alpha_c = 'DB')
OR (A.issuer_id_c = '59447T' and A.issue_alpha_c = 'DC'))
 AND A.ADJ_DT = TO_DATE('08/15/2017','MM/DD/YYYY')
ORDER BY 5 ASC NULLS LAST

ALINA-ACTIVE "SPI' SPECIALS
SELECT DISTINCT CONCAT(C.ISSUER_ID_C, C.ISSUE_ALPHA_C) AS CUSIP, B.SPEC_TYPE_C, a.*
FROM KBS.TSPEC_SCHEDULE A, KBS.TSPEC_REDEM B, KBS.TISSUE_REF C, KBS.TFEATURE_XREF D , KBS.TINST_REF E
WHERE B.FEATURE_ID_C=a.FEATURE_ID_C
and B.FEATURE_ID_C=D.FEATURE_ID_C
AND C.ISSUER_ID_C=D.ISSUER_ID_C
AND C.ISSUE_ALPHA_C=D.ISSUE_ALPHA_C
AND C.INST_ID_C=E.INST_ID_C
AND E.INST_TYPE_C = 'MUNI'
AND B.SPEC_TYPE_C = 'SPI'
AND C.MATURITY_D > (SYSDATE)
AND C.MATURITY_TYPE_C <> '*'
AND NOT EXISTS (SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X, KBS.TCALLED_BOND Y 
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND X.ISSUER_ID_C=C.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND Y.CALL_D < (SYSDATE))


DEVELOPER-NIIDS TABLE
SELECT DISTINCT Z.NIIDS_VALUE AS CUSIP, x.niids_key, x.niids_value AS RMKTG, y.niids_value AS SNKGFNDFLAG
FROM NIIDS_DETAIL X, NIIDS_DETAIL Y, NIIDS_DETAIL Z
WHERE X.NIIDS_KEY=Y.NIIDS_KEY
AND Z.TAG = 'CUSIP'
AND Y.NIIDS_KEY = Z.NIIDS_KEY
AND X.TAG = 'Rmktg'
AND X.NIIDS_VALUE = 'N'
AND Y.TAG = 'SnkgFndFlagYN'
AND Y.NIIDS_VALUE = 'N'


MB-NIIDS TABLE
SELECT DISTINCT B.SECURITY_KEY, B.CPN_TP, B.FRST_RESET_DT, C.INT_RATE_RESET_FQ, C.INT_RATE_RESET_NB 
FROM KBS.TISSUE_REF A, KBS.TNIIDS_FEED B, KBS.TNIIDS_DATA C
WHERE A.ISSUER_ID_C=SUBSTR(B.SECURITY_KEY,1,6)
AND A.ISSUE_ALPHA_C=SUBSTR(B.SECURITY_KEY,7,2) 
AND B.FEED_ID_C=C.FEED_ID_C
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND B.CPN_TP IN ('VARB','AUCT','INDX')
AND B.FRST_RESET_DT IS NOT NULL

MB-NIIDS TESTING
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, B.FRST_CPN_DT, B.SCTY_ELGBLTY_STS, B.OID_P, B.OID_YLD, B.CPN_RATE, B.BANK_QLFD, B.ZERO_CPN_IND, B.CPTL_APRCTN_IND, B.CDT_NHNCMNT, B.MTRTY_PRIN_AMT, TO_CHAR((B.MTRTY_PRIN_AMT/5000),'00000.00'), A.CDT_NHM_CMNT_TP, A.CDT_NHM_NM, B.DATED_DT, B.MATURITY_DT, B.SERIAL_TERM, B.RULE_144A_IND, B.SCTY_STS, B.FRML_AWRD_DT, B.FRML_AWRD_TM, A.*, B.* 
FROM KBS.TNIIDS_DATA A, KBS.TNIIDS_FEED B
Where A.FEED_ID_C=B.FEED_ID_C AND A.ISSUER_ID_C=B.ISSUER_ID_C AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C
AND B.MATURITY_DT > SYSDATE
--AND (B.ZERO_CPN_IND = 'Y'
--OR B.CPTL_APRCTN_IND = 'Y')
--AND SUBSTR(B.MTRTY_PRIN_AMT,-3,3) = '000'
--AND B.OID_P>0
--AND B.OID_YLD>0 
--AND B.CPN_RATE=0
AND B.FRML_AWRD_DT > (SYSDATE-90)
AND ROWNUM < 1000
ORDER BY 9,10 ASC


HILLARY-EGYPT EDI BONDS
SELECT DISTINCT  A.ISIN, B.ISSUERNAME, C.ISSUEDATE, C.INTERESTRATE, C.MATURITYDATE, D.PARTFINAL, D.REDEMDATE
FROM EDI.SCMST A,EDI.ISSUR B, EDI.BOND C, EDI.REDEM D
WHERE A.ISSID=B.ISSID (+)
AND A.SECID=C.SECID (+)
AND A.SECID=D.SECID (+)
AND 'F'= D.PARTFINAL (+)
--AND (C.MATURITYDATE <= SYSDATE
--OR (D.PARTFINAL = 'F' AND D.REDEMDATE <= SYSDATE))
AND B.CNTRYOFINCORP = 'EG'
AND A.ISIN IS NOT NULL


ALINA-EDI-CORPORATE ACTIONS (FULL LIST)
SELECT DISTINCT A.ISIN, A.SECID, B.ISSUEDATE, B.MATURITYDATE, C.REDEMTYPE, C.REDEMDATE, C.REDEMPRICE, C.*
FROM EDI.SCMST A, EDI.BOND B, EDI.REDEM C
Where A.SECID=B.SECID
AND B.SECID=C.SECID
AND C.REDEMDATE IS NOT NULL
AND C.REDEMTYPE <> 'MAT'
AND C.REDEMTYPE <> 'BB'
AND C.REDEMTYPE <> 'AMT'
AND C.ACTFLAG <> 'D'
AND B.MATURITYDATE > SYSDATE




Editor
SELECT DISTINCT CONCAT(C.ISSUER_ID_C,C.ISSUE_ALPHA_C) AS CUSIP, C.DATED_D as SDM_DTD, E.DATED_DATE AS PRD_DTD, C.MATURITY_D AS SDM_MTY, E.MATURITY_DATE AS PRD_MTY, a.CALL_D AS SDM_CALL_DATE, A.CALL_PRICE_P, A.FREQ_PERIOD_C, D.CALL_DATE AS PRD_CALL_DATE, D.CALL_PRICE AS CALL_PRICE, E.IN_WHOLE_CALL_FREQUENCY_CODE 
FROM KBSPROD.TCALL_SCHEDULE A, KBSPROD.TISSUE_REF C, PRD.CALL_DATA D, PRD.ISSUE E
WHERE A.ISSUING_ID_C=C.ISSUING_ID_C
AND C.ISSUER_ID_C=D.ISSUER_ID (+)
AND C.ISSUE_ALPHA_C=D.ISSUE_ALPHA (+)
AND C.ISSUER_ID_C=E.ISSUER_ID (+)
AND C.ISSUE_ALPHA_C=E.ISSUE_ALPHA (+)
AND A.CALL_D> SYSDATE
AND D.CALL_DATE> SYSDATE 
AND A.ISSUING_ID_C=1620725
ORDER BY 4,7,10 asc


SELECT DISTINCT OWNER, TABLE_NAME, COLUMN_NAME FROM ALL_TAB_COLUMNS WHERE OWNER IN ('PRD','KBS','KBSPROD') AND COLUMN_NAME LIKE '%FREQ%' 


SELECT DISTINCT NEXT_CALL_DATE, NEXT_PAR_CALL_PRICE, IN_WHOLE_CALL_FREQUENCY_CODE
FROM PRD.ISSUE 
WHERE CONCAT(ISSUER_ID,ISSUE_ALPHA) = '01030PFQ'


JOHN-SF TYPES
SELECT DISTINCT A.FEATURE_ID_C, CONCAT(C.ISSUER_ID_C, C.ISSUE_ALPHA_C) AS CUSIP, D.* 
FROM KBS.TFEATURE_REF B, KBS.TFEATURE_XREF A, KBS.TISSUE_REF C, KBS.TSINKING_FUND_REF D, KBS.TINST_REF E
WHERE A.FEATURE_ID_C=B.FEATURE_ID_C
AND A.ISSUE_ID_C=C.ISSUE_ID_C
AND A.FEATURE_ID_C=D.FEATURE_ID_C
AND C.INST_ID_C=E.INST_ID_C
AND D.SF_BEGIN_D IS NOT NULL
AND D.SF_TYPE_C IN ('SF', 'AR', 'ER', 'IP') 
AND E.INST_TYPE_C = 'MUNI'
AND C.MATURITY_D > (SYSDATE)
AND C.MATURITY_TYPE_C <> '*'
AND NOT EXISTS (SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X, KBS.TCALLED_BOND Y 
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND X.ISSUER_ID_C=C.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND Y.CALL_D < (SYSDATE))


JOHN-ISRAEL ESCROW
SELECT DISTINCT A.FEATURE_ID_C, CONCAT(C.ISSUER_ID_C, C.ISSUE_ALPHA_C) AS CUSIP, F.ESCROW_TYPE_1_C
FROM KBS.TFEATURE_REF A, KBS.TFEATURE_XREF B, KBS.TISSUE_REF C, KBS.TSINKING_FUND_REF D, KBS.TINST_REF E, KBS.TPREREFUNDED_REF F
WHERE A.FEATURE_ID_C=B.FEATURE_ID_C
AND B.ISSUE_ID_C=C.ISSUE_ID_C
AND A.FEATURE_ID_C=D.FEATURE_ID_C
AND C.INST_ID_C=E.INST_ID_C
AND C.ISSUING_ID_C=F.ISSUING_ID_C
AND E.INST_TYPE_C = 'MUNI'
AND C.MATURITY_D > (SYSDATE)
AND C.MATURITY_TYPE_C <> '*'
AND NOT EXISTS (SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X, KBS.TCALLED_BOND Y 
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND X.ISSUER_ID_C=C.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND Y.CALL_D < (SYSDATE))
AND F.ESCROW_TYPE_1_C = 'ISRL'


JOHN-CRDT ENH
SELECT DISTINCT CONCAT(C.ISSUER_ID_C, C.ISSUE_ALPHA_C) AS CUSIP, E2.INST_N
FROM KBS.TFEATURE_REF A, KBS.TFEATURE_XREF B, KBS.TISSUE_REF C, KBS.TSINKING_FUND_REF D, KBS.TINST_REF E, KBS.TINST_REF E2, KBS.TCRDT_ENHMT_INST F, KBS.TCRDT_ENHMT_REF G
WHERE A.FEATURE_ID_C=B.FEATURE_ID_C
AND B.ISSUE_ID_C=C.ISSUE_ID_C
AND A.FEATURE_ID_C=D.FEATURE_ID_C
AND C.INST_ID_C=E.INST_ID_C
AND E2.INST_ID_C=F.INST_ID_C
AND F.CRDT_ENHMT_ID_C=G.CRDT_ENHMT_ID_C
AND C.ISSUING_ID_C=G.ISSUING_ID_C 
AND E.INST_TYPE_C = 'MUNI'
AND C.MATURITY_D > (SYSDATE)
AND C.MATURITY_TYPE_C <> '*'
AND NOT EXISTS (SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X, KBS.TCALLED_BOND Y 
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND X.ISSUER_ID_C=C.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND Y.CALL_D < (SYSDATE))
AND E2.INST_N LIKE 'CALIF%TEACH%'




JOHN-CONDITIONAL PUTS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, B.OTL_TEXT_T 
FROM KBS.TISSUE_REF A, KBS.TISSUING_OTL B, KBS.TINST_REF C
Where A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.INST_ID_C=C.INST_ID_C
AND C.INST_TYPE_C= 'MUNI'
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND NOT EXISTS (SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X, KBS.TCALLED_BOND Y 
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND X.ISSUER_ID_C=A.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND Y.CALL_D < (SYSDATE))

AND (B.OTL_TEXT_T LIKE '%/0000%'
OR B.OTL_TEXT_T LIKE '%/0004%'
OR B.OTL_TEXT_T LIKE '%/0007%')
AND B.OTL_TEXT_T NOT LIKE 'PUT%'
AND B.OTL_ID_C = '43'


LIBOR-SIFMA UAT
SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, C.INDEX_TYPE, C.INDEX_SUB_TYPE, B.ADJ_DT, B.ADJ_RATE, C.PERCENT_OF_INDEX, C.SPREAD_PLUSMINUS_I, C.SPREAD_INT_RATE, C.SPREAD_BASIS_PTS, C.CUTOFF_FREQ_CD, C.CUTOFF_TIMEZONE_CD, E.FREQ_PERIOD_C AS FREQ, B.BEGIN_DT, B.END_DT, B.CALC_COUPON_I, B.UPDATED_COUPON_I, B.ADDED_Z, B.MODIFIED_Z
FROM KBS.TISSUE_REF A, KBS.TVARIABLE_SCHEDULE B, KBS.TINDEX_GROUPING C, KBS.TINST_REF D, KBS.TVARIABLE_FEATURE E
WHERE (A.ISSUER_ID_C=B.ISSUER_ID_C AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C)
AND (A.ISSUER_ID_C=C.ISSUER_ID_C AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C)
AND D.INST_ID_C=A.INST_ID_C
AND (A.ISSUER_ID_C=E.ISSUER_ID_C AND A.ISSUE_ALPHA_C=E.ISSUE_ALPHA_C)
AND B.ADJ_DT BETWEEN TO_DATE('08/31/2017','MM/DD/YYYY') AND TO_DATE('09/04/2017','MM/DD/YYYY')
AND D.INST_TYPE_C = 'MUNI'
AND C.INDEX_TYPE IN ('SMSW', 'LIBR')
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND NOT EXISTS (
SELECT DISTINCT ISSUER_ID_C, ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE 
WHERE ISSUER_ID_C=A.ISSUER_ID_C
AND ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND FULL_PART_CALL_C = 'FULL')
AND ((A.issuer_id_c = '00844X' and A.issue_alpha_c = 'CL')
OR (A.issuer_id_c = '011839' and A.issue_alpha_c = 'DE')
OR (A.issuer_id_c = '041438' and A.issue_alpha_c = 'FH')
OR (A.issuer_id_c = '13034A' and A.issue_alpha_c = 'SW')
OR (A.issuer_id_c = '154871' and A.issue_alpha_c = 'AN')
OR (A.issuer_id_c = '917436' and A.issue_alpha_c = '3B')
OR (A.issuer_id_c = '032557' and A.issue_alpha_c = 'BZ')
OR (A.issuer_id_c = '032557' and A.issue_alpha_c = 'CA')
OR (A.issuer_id_c = '040507' and A.issue_alpha_c = 'ND')
OR (A.issuer_id_c = '040507' and A.issue_alpha_c = 'NE')
OR (A.issuer_id_c = '040507' and A.issue_alpha_c = 'NF')
OR (A.issuer_id_c = '708792' and A.issue_alpha_c = '7Z')
)
 ORDER BY 4,3,1 ASC


ALINA-COMPARING CUSIP FEED TIMING AGAINST MB
SELECT DISTINCT CONCAT(A.ISSUER_NUM,A.ISSUE_NUM) AS CUSIP, A.ADDED_Z AS CUSIP_FEED, B.ADDED_Z AS MB, (A.ADDED_Z-B.ADDED_Z) AS DIFFERENCE
FROM KBS.TCUSIP_ISSUE A, KBS.TISSUE_REF B
Where A.ISSUER_NUM=B.ISSUER_ID_C
AND A.ISSUE_NUM=B.ISSUE_ALPHA_C
AND A.ADDED_BY_C = 'CUSIPNOW'
AND A.FEED_ID_C IN (SELECT DISTINCT MIN(FEED_ID_C) FROM KBS.TCUSIP_ISSUE FEED WHERE FEED.ISSUER_NUM=B.ISSUER_ID_C AND FEED.ISSUE_NUM=B.ISSUE_ALPHA_C)
AND A.DATED_DT > (SYSDATE-30)


SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, A.ISSUE_DENOM_1_L, A.ISSUE_DENOM_2_L, A.ISSUE_DENOM_3_L, A.ISSUE_DENOM_4_L
FROM KBS.TISSUE_REF A, KBS.TISSUER_REF B
WHERE A.ISSUER_ID_C=B.ISSUER_ID_C
AND B.INST_TYPE_C = 'MUNI'
AND A.ISSUE_DENOM_1_L >0
AND A.ISSUE_DENOM_2_L >0
AND A.ISSUE_DENOM_3_L >0
and A.ISSUE_DENOM_1_L <> A.ISSUE_DENOM_2_L
and A.ISSUE_DENOM_1_L <> A.ISSUE_DENOM_3_L
AND A.MATURITY_D > SYSDATE
ORDER BY 1 ASC





JIRA
SELECT DISTINCT A.ISSUER_ID_C||A.ISSUE_ALPHA_C AS CUSIP, C.VARIABLE_RATE_CEILING, B.INT_RATE_CAP
FROM KBS.TISSUE_REF A, KBS.TINDEX_GROUPING B, PRD.ISSUE C, KBS.TINST_REF D
WHERE A.ISSUER_ID_C=B.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C  
AND A.ISSUER_ID_C=C.ISSUER_ID
AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA
AND A.INST_ID_C=D.INST_ID_C
AND D.INST_TYPE_C = 'MUNI'
AND (C.VARIABLE_RATE_CEILING IS NOT NULL
OR B.INT_RATE_CAP IS NOT NULL
OR C.VARIABLE_RATE_CEILING >0
OR B.INT_RATE_CAP >0) 
AND C.VARIABLE_RATE_CEILING <> B.INT_RATE_CAP
AND ((A.issuer_id_c = '00037C' and A.issue_alpha_c = 'GL')
OR (A.issuer_id_c = '00037C' and A.issue_alpha_c = 'GM')
OR (A.issuer_id_c = '00037C' and A.issue_alpha_c = 'GP')
OR (A.issuer_id_c = '00037C' and A.issue_alpha_c = 'GQ')
OR (A.issuer_id_c = '00037C' and A.issue_alpha_c = 'GR'))


DPI-96
SELECT DISTINCT C.ISSUER_ID||C.ISSUE_ALPHA AS CUSIP, B.SPEC_TYPE_C, C.EXTRAORDINARY_REDEM_FLAG, D.EXTRAORDINARY_MAKE_WHOLE_CALL, D.MAKE_WHOLE_CALL 
FROM KBS.TFEATURE_XREF A, KBS.TSPECIAL_SCHEDULE B, PRD.ISSUE C, PRD.ISSUE_ADDL_INFO D
WHERE A.FEATURE_ID_C=B.FEATURE_ID_C
AND A.ISSUER_ID_C=C.ISSUER_ID
AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA
AND A.ISSUER_ID_C=D.ISSUER_ID
AND A.ISSUE_ALPHA_C=D.ISSUE_ALPHA
AND (D.EXTRAORDINARY_MAKE_WHOLE_CALL = 'Y'
OR D.MAKE_WHOLE_CALL = 'Y')

DPI-50
SELECT DISTINCT A.ISSUER_ID_C||A.ISSUE_ALPHA_C AS CUSIP, C.ESCROW_TYPE, D.ESCROW_TYPE_1_C, D.ESCROW_PCT_1_P
FROM PRD.ISSUE C, PRD.SE_SOURCE B, KBS.TISSUE_REF A, KBS.TPREREFUNDED_REF D
Where C.ISSUER_ID=B.ISSUER_ID (+)
AND C.ISSUE_ALPHA=B.ISSUE_ALPHA (+)
AND C.ISSUER_ID=A.ISSUER_ID_C (+)
AND C.ISSUE_ALPHA=A.ISSUE_ALPHA_C (+)
AND A.ISSUING_ID_C=D.ISSUING_ID_C (+)
AND C.ESCROW_TYPE <> ' '
AND D.ESCROW_TYPE_1_C IS NULL

DPI-63
SELECT DISTINCT A.ISSUER_ID||A.ISSUE_ALPHA AS CUSIP, B.SE_SOURCE_TYPE, A.SECURITY_TYPE, D.MUNI_TAX_I
FROM PRD.ISSUE A, PRD.SE_SOURCE B, KBS.TISSUE_REF C, KBS.TISSUING_REF D
Where A.ISSUER_ID=B.ISSUER_ID
AND A.ISSUE_ALPHA=B.ISSUE_ALPHA
AND A.ISSUER_ID=C.ISSUER_ID_C
AND A.ISSUE_ALPHA=C.ISSUE_ALPHA_C
AND C.ISSUING_ID_C=D.ISSUING_ID_C
AND D.MUNI_TAX_I = ' '


DPI-109
SELECT DISTINCT A.ISSUER_ID_C||A.ISSUE_ALPHA_C AS CUSIP, B.INT_PAY_TYPE_C, C.COUPON_TYPE, C.CONVERSION_DATE, B.CUR_INT_I, B.CUR_INT_D  
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, PRD.ISSUE C
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C (+)
AND A.ISSUER_ID_C=C.ISSUER_ID (+)
AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA (+)
AND C.COUPON_TYPE IN ('C','D')
--AND D.INT_PAY_TYPE_C<> 'AC'


DPI-127
SELECT DISTINCT A.ISSUER_ID_C||A.ISSUE_ALPHA_C AS CUSIP, A.MATURITY_D, A.CALL_TYPE_C, C.CALL_DATE, C.FILEUPDATEDATE AS CALL_DATA_FILE
FROM PRD.CALL_DATA C, KBS.TISSUE_REF A
Where A.ISSUER_ID_C=C.ISSUER_ID (+)
AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA (+)
AND A.CALL_TYPE_C = 'NONC'
and c.call_date is not null 
and C.CALL_DATE <= A.MATURITY_D
AND ((A.issuer_id_c = '068746' and A.issue_alpha_c = 'HM')
OR (A.issuer_id_c = '104745' and A.issue_alpha_c = 'HX')
OR (A.issuer_id_c = '10620N' and A.issue_alpha_c = 'BX')
OR (A.issuer_id_c = '112543' and A.issue_alpha_c = 'AW')
OR (A.issuer_id_c = '13032L' and A.issue_alpha_c = 'AJ'))
ORDER BY 1,4 ASC


DPI-111
SELECT DISTINCT A.ISSUER_ID_C||A.ISSUE_ALPHA_C AS CUSIP, A.PRICE_CALC_C, C.CALLS_CAV_FLAG, B.CAV_FLAG, A.FEATURE_ID_C, B.FILEUPDATEDATE, C.FILEUPDATEDATE 
FROM PRD.ISSUE C, PRD.SE_SPECIAL_CALL_DETAIL B, KBS.TFEATURE_XREF A, KBS.TINST_REF D
Where C.ISSUER_ID=B.ISSUER_ID (+)
AND C.ISSUE_ALPHA=B.ISSUE_ALPHA (+)
AND C.ISSUER_ID=A.ISSUER_ID_C (+)
AND C.ISSUE_ALPHA=A.ISSUE_ALPHA_C (+)
AND A.INST_ID_C=D.INST_ID_C
AND D.INST_TYPE_C = 'MUNI'
AND B.CAV_FLAG = 'Y'
AND A.PRICE_CALC_C <> 'CAV'
AND ((A.issuer_id_c = '802576' and A.issue_alpha_c = 'AQ')
OR (A.issuer_id_c = '802576' and A.issue_alpha_c = 'AR')
OR (A.issuer_id_c = '802576' and A.issue_alpha_c = 'AT')
OR (A.issuer_id_c = '802576' and A.issue_alpha_c = 'AS')
OR (A.issuer_id_c = '802576' and A.issue_alpha_c = 'AU')
)
ORDER BY 1 ASC


DPI-138
SELECT DISTINCT A.ISSUER_ID||A.ISSUE_ALPHA,A.CALL_TYPE, B.SPEC_TYPE_C, C.SPEC_TYPE_C,A.IN_WHOLE,A.IN_PART, --B.*, 
C.WHOLE_PART_CALL_C 
FROM PRD.SE_SPECIAL_CALL_DETAIL A, KBS.TISSUE_SPECIAL_REF B, KBS.TSPECIAL_SCHEDULE C
WHERE A.ISSUER_ID=B.ISSUER_ID_C AND A.ISSUE_ALPHA=B.ISSUE_ALPHA_C
AND A.ISSUER_ID=C.ISSUER_ID_C AND A.ISSUE_ALPHA=C.ISSUE_ALPHA_C
--AND A.ISSUER_ID||ISSUE_ALPHA='003430AF'
AND B.SPEC_FEATURE_ID_C=C.FEATURE_ID_C
--and A.IN_WHOLE IS NULL
--AND A.IN_PART IS NOT NULL
--AND C.SPEC_TYPE_C=A.CALL_TYPE
--AND C.SPEC_TYPE_C=B.SPEC_TYPE_C
AND B.SPEC_TYPE_C = 'SPX'
AND C.WHOLE_PART_CALL_C <> 'W'

DPI-194
SELECT distinct B.ISSUER_ID||B.ISSUE_ALPHA AS CUSIP, B.SEC_REG, C.A144C, C.REG_D_C
FROM KBS.TISSUE_REF A, PRD.SE_MATURITY B, KBS.TISSUING_REF C
Where A.ISSUER_ID_C=B.ISSUER_ID AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA
AND A.ISSUING_ID_C=C.ISSUING_ID_C
AND B.SEC_REG <> ' '

BRIDGE EXAMPLE CUSIPS

SELECT DISTINCT A.ISSUER_ID_C||A.ISSUE_ALPHA_C AS CUSIP, C.*, D.*
FROM KBS.TISSUE_REF A, KBS.TFEATURE_XREF B, KBS.TSPECIAL_ISSUE C, KBS.TSINKING_FUND_REF D, KBS.TINST_REF E 
Where A.ISSUER_ID_C=B.ISSUER_ID_C (+)
AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C  (+)
AND A.ISSUER_ID_C=C.ISSUER_ID_C (+)
AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C  (+)
AND B.FEATURE_ID_C=D.FEATURE_ID_C  (+)
AND A.INST_ID_C=E.INST_ID_C
AND E.INST_TYPE_C = 'MUNI'
AND C.PRICE_CALC_C = 'PCAV'
AND D.SF_PRICE_CALC_I = '2'


SELECT DISTINCT A.ISSUER_ID_C||A.ISSUE_ALPHA_C AS CUSIP, B.FREQ_Q, C.OTL_TEXT_T
FROM KBS.TISSUE_REF A, KBS.TVARIABLE_FEATURE B, KBS.TISSUING_OTL C, KBS.TINST_REF D
Where A.ISSUER_ID_C=B.ISSUER_ID_C (+)
AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C  (+)
AND A.ISSUING_ID_C=C.ISSUING_ID_C (+)
AND A.INST_ID_C=D.INST_ID_C
AND D.INST_TYPE_C = 'MUNI'
AND B.FREQ_Q = 999
AND C.OTL_ID_C = '44'
AND (C.OTL_TEXT_T LIKE '%>F%'
OR C.OTL_TEXT_T LIKE '%>N%'
OR C.OTL_TEXT_T LIKE '%>U%'
OR C.OTL_TEXT_T LIKE '%>V%')
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND NOT EXISTS (SELECT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X, KBS.TCALLED_BOND Y 
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND X.ISSUER_ID_C=A.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND Y.CALL_D < (SYSDATE))


SELECT DISTINCT A.ISSUER_ID_C||A.ISSUE_ALPHA_C AS CUSIP, A.PRICE_CALC_C, C.CALLS_CAV_FLAG, B.CAV_FLAG  
FROM PRD.ISSUE C, PRD.SE_SPECIAL_CALL_DETAIL B, KBS.TISSUE_REF A
Where C.ISSUER_ID=B.ISSUER_ID (+)
AND C.ISSUE_ALPHA=B.ISSUE_ALPHA (+)
AND C.ISSUER_ID=A.ISSUER_ID_C (+)
AND C.ISSUE_ALPHA=A.ISSUE_ALPHA_C (+)
AND (C.CALLS_CAV_FLAG = 'Y'
OR B.CAV_FLAG = 'Y')
AND A.PRICE_CALC_C <> 'CAV'


SELECT DISTINCT A.ISSUER_ID_C||A.ISSUE_ALPHA_C AS CUSIP, A.PRICE_CALC_C, C.CALLS_CAV_FLAG, B.CAV_FLAG  
FROM PRD.ISSUE C, PRD.SE_SPECIAL_CALL_DETAIL B, KBS.TFEATURE_XREF A
Where C.ISSUER_ID=B.ISSUER_ID (+)
AND C.ISSUE_ALPHA=B.ISSUE_ALPHA (+)
AND C.ISSUER_ID=A.ISSUER_ID_C (+)
AND C.ISSUE_ALPHA=A.ISSUE_ALPHA_C (+)
AND B.CAV_FLAG = 'Y'
AND A.PRICE_CALC_C <> 'CAV'


SELECT DISTINCT A.ISSUER_ID_C||A.ISSUE_ALPHA_C AS CUSIP, B.*
FROM KBS.TISSUE_REF A, KBS.TSPECIAL_SCHEDULE B, KBS.TFEATURE_XREF C, KBS.TISSUER_REF D
Where A.ISSUER_ID_C=C.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C
AND B.FEATURE_ID_C=C.FEATURE_ID_C
AND A.ISSUER_ID_C=D.ISSUER_ID_C
AND A.MATURITY_D > SYSDATE
AND D.INST_TYPE_C = 'MUNI'
AND B.FREQ_PERIOD_C = 'IR'


SELECT DISTINCT A.*
FROM KBS.TISSUE_REF A, KBS.TISSUER_REF C, KBS.TISSUING_REF E 
Where A.ISSUER_ID_C=C.ISSUER_ID_C
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND C.INST_TYPE_C = 'MUNI'
AND A.MATURITY_D > SYSDATE


SELECT DISTINCT A.ISSUER_ID_C||A.ISSUE_ALPHA_C AS CUSIP, B.*
FROM KBS.TISSUE_REF A, KBS.TSPECIAL_SCHEDULE B, KBS.TFEATURE_XREF C, KBS.TISSUER_REF D
Where A.ISSUER_ID_C=C.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C
AND B.FEATURE_ID_C=C.FEATURE_ID_C
AND A.ISSUER_ID_C=D.ISSUER_ID_C
AND A.MATURITY_D > SYSDATE
AND D.INST_TYPE_C = 'MUNI'
AND B.EXPIRED_D IS NOT NULL


SELECT DISTINCT A.ISSUER_ID_C||A.ISSUE_ALPHA_C AS CUSIP, B.*
FROM KBS.TISSUE_REF A, KBS.TSPEC_REDEM B, KBS.TFEATURE_XREF C, KBS.TINST_REF D
Where A.ISSUER_ID_C=C.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA_C
AND B.FEATURE_ID_C=C.FEATURE_ID_C
AND A.INST_ID_C=D.INST_ID_C
AND A.MATURITY_D > SYSDATE
AND D.INST_TYPE_C = 'MUNI'
AND A.ISSUER_ID_C NOT LIKE '006%'
AND (B.SOURCE_REASON_1_C IN ()
OR B.SOURCE_REASON_2_C IN ()
OR B.SOURCE_REASON_3_C IN ()
OR B.SOURCE_REASON_4_C IN () )


SELECT DISTINCT CONCAT(A.ISSUER_ID_C,A.ISSUE_ALPHA_C) AS CUSIP, A.ADDED_Z AS DALCOMP_FEED, B.ADDED_Z AS MB, (B.ADDED_Z-A.ADDED_Z) AS DIFFERENCE
FROM KBS.TDALCOMP_FEED A, KBS.TISSUE_REF B
Where A.ISSUER_ID_C=B.ISSUER_ID_C
AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C
AND A.ADDED_BY_C = 'DALCOM'
AND DEAL_ID_C IN (SELECT DISTINCT MIN(DEAL_ID_C) FROM KBS.TDALCOMP_FEED FEED WHERE FEED.ISSUER_ID_C=B.ISSUER_ID_C AND FEED.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C)
AND A.DATED_DT > (SYSDATE-60)


SELECT A.ISSUER_ID_C||A.ISSUE_ALPHA_C AS CUSIP, B.INT_PAY_TYPE_C, C.COUPON_TYPE, C.CONVERSION_DATE, B.CUR_INT_I, B.CUR_INT_D  
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, PRD.ISSUE C
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C (+)
AND A.ISSUER_ID_C=C.ISSUER_ID (+)
AND A.ISSUE_ALPHA_C=C.ISSUE_ALPHA (+)
AND C.COUPON_TYPE IN ('C','D')


SELECT DISTINCT A.ISSUER_ID||A.ISSUE_ALPHA,A.CALL_TYPE, B.SPEC_TYPE_C, C.SPEC_TYPE_C,A.IN_WHOLE,A.IN_PART, --B.*, 
C.WHOLE_PART_CALL_C, A.FILEUPDATEDATE AS A_DATE, B.MODIFIED_Z AS B_DATE, C.MODIFIED_Z AS C_DATE 
FROM PRD.SE_SPECIAL_CALL_DETAIL A, KBS.TISSUE_SPECIAL_REF B, KBS.TSPECIAL_SCHEDULE C
WHERE A.ISSUER_ID=B.ISSUER_ID_C AND A.ISSUE_ALPHA=B.ISSUE_ALPHA_C
AND A.ISSUER_ID=C.ISSUER_ID_C AND A.ISSUE_ALPHA=C.ISSUE_ALPHA_C
AND A.ISSUER_ID||ISSUE_ALPHA='003430AF'
AND B.SPEC_FEATURE_ID_C=C.FEATURE_ID_C
--and A.IN_WHOLE IS NULL
--AND A.IN_PART IS NOT NULL
--AND C.SPEC_TYPE_C=A.CALL_TYPE
--AND C.SPEC_TYPE_C=B.SPEC_TYPE_C
--AND B.SPEC_TYPE_C = 'SPO'


select * from KBS.TINST_REF
where INST_N = 'MEREY SWEENY LP'

SELECT DISTINCT A.ISSUER_ID||A.ISSUE_ALPHA, A.CALL_TYPE
FROM PRD.SE_SPECIAL_CALL_DETAIL A
WHERE A.ISSUER_ID||a.ISSUE_ALPHA='003430AF'

SELECT A.ISSUER_ID_C||A.ISSUE_ALPHA_C AS CUSIP, B.CALLS_DEFEASED_FLAG AS PRD_DEFEASED, B.FILEUPDATEDATE AS B_DATE, A.DEFEASED_C, A.OPT_CALL_DEFEASED_C, A.LEGAL_DEFEASED_C, A.ECON_DEFEASED_C, A.MODIFIED_Z
FROM KBS.TISSUE_REF A, PRD.ISSUE B
Where


DPI-177
SELECT A.ISSUER_ID_C||A.ISSUE_ALPHA_C AS CUSIP, b.payment_first_d, B.FREQ_PERIOD_1_C, B.FREQ_1_Q, b.payment_second_d, B.FREQ_PERIOD_2_C, B.FREQ_2_Q, B.*
FROM KBS.TISSUE_REF A, KBS.TISSUER_REF D, KBS.TISSUING_REF B
Where A.ISSUER_ID_C=D.ISSUER_ID_C
AND D.INST_TYPE_C = 'MUNI'
AND B.FREQ_PERIOD_1_C = 'SA'
and b.payment_second_d is not null
AND A.ISSUING_ID_C=B.ISSUING_ID_C


DPI-94
SELECT A.ISSUER_ID_C||A.ISSUE_ALPHA_C AS CUSIP, B.EVENT_DATE
FROM KBS.TISSUE_REF A, KBS.TISSUER_REF D, PRD.SE_EVENT B
-- KBS.KIS_TDISCLOSURE_EVENTS E, KBS.TOCUMENT_REF F, KBS.TKENNY_ALERT_REF G 
Where A.ISSUER_ID_C=D.ISSUER_ID_C
AND (A.ISSUER_ID_C=B.ISSUER_ID AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA)
AND D.INST_TYPE_C = 'MUNI'


MRC QUERY
SELECT DISTINCT B.ISSUER_ID, B.ISSUE_ALPHA, B.FILEUPDATEDATE, B.IN_WHOLE_CALL_FREQUENCY_CODE, B.INTEREST_PAYMENT_FREQUENCY, R.FREQ_PERIOD_C
FROM PRD.ISSUE B
JOIN KBSPROD.TISSUE_REF D ON D.ISSUER_ID_C = B.ISSUER_ID AND D.ISSUE_ALPHA_C  = B.ISSUE_ALPHA 
AND B.FILEUPDATEDATE = (select max(FILEUPDATEDATE) from PRD.ISSUE where ISSUER_ID=B.ISSUER_ID and ISSUE_ALPHA=B.ISSUE_ALPHA)
JOIN  KBSPROD.TISSUE_REF P ON P.ISSUER_ID_C = B.ISSUER_ID AND P.ISSUE_ALPHA_C  = B.ISSUE_ALPHA 
JOIN  KBSPROD.TCALL_SCHEDULE  R ON P.ISSUING_ID_C = R.ISSUING_ID_C 
--WHERE D.MATURITY_D > SYSDATE
--AND (P.ISSUING_ID_C) NOT IN (SELECT ISSUING_ID_C FROM  KBS.TPREREFUNDED)
ORDER BY B.ISSUER_ID, B.ISSUE_ALPHA


DPI-
select A.ISSUER_ID_C, A.INST_TYPE_C AS KBS_INST, B.INST_TYPE_C AS PROD_INST
from KBS.TISSUER_REF A, KBSPROD.TISSUER_REF B
WHERE A.ISSUER_ID_C=B.ISSUER_ID_C
AND ((A.INST_TYPE_C='CORP'
AND B.INST_TYPE_C='MUNI')
OR (A.INST_TYPE_C='MUNI'
AND B.INST_TYPE_C='CORP'))



SUPPLEMENTAL FILES QUERY
SELECT A.ISSUER_ID_C||A.ISSUE_ALPHA_C AS CUSIP 
FROM KBS.TISSUE_REF A, KBS.TISSUER_REF B, KBS.TISSUING_REF C
Where A.ISSUER_ID_C=B.ISSUER_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C
AND B.INST_TYPE_C = 'MUNI'
AND A.CUSIP_DERVN_I= 'C'
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND B.INST_N NOT LIKE '%ADAMSVILLE%TEST%'
AND C.SALE_NOTICE_D IS NULL
ORDER BY 1 ASC

COUNTS
SELECT DISTINCT A.ISSUER_ID_C||A.ISSUE_ALPHA_C AS CUSIP
FROM KBS.TISSUE_REF A, KBS.TINST_REF B
WHERE A.INST_ID_C=B.INST_ID_C
AND B.INST_TYPE_C = 'MUNI'
AND A.ADDED_BY_C = 'CUSIPN'
AND A.ADDED_Z BETWEEN TO_TIMESTAMP('10/10/2017 12:01:00.000000 AM','fmMMfm/fmDDfm/YYYY fmHH12fm:MI:SS.FF AM') AND TO_TIMESTAMP('10/10/2017 11:59:00.653263 PM','fmMMfm/fmDDfm/YYYY fmHH12fm:MI:SS.FF AM')


DALCOMP FEED COUNT
SELECT DISTINCT ISSUER_ID_C||ISSUE_ALPHA_C AS CUSIP, SENT_DATE
FROM KBS.TDALCOMP_FEED
Where
SENT_DATE=TO_DATE('10/10/2017','MM/DD/YYYY')


NIIDS FEED COUNT
SELECT DISTINCT ISSUER_ID_C||ISSUE_ALPHA_C AS CUSIP, TRUNC(SENT_DATE)
FROM KBS.TNIIDS_FEED
Where  TRUNC(SENT_DATE)=TO_DATE('10/10/2017','MM/DD/YYYY')


CUSIPN FEED COUNT
SELECT DISTINCT B.ISSUER_NUM||B.ISSUE_NUM AS CUSIP, TRUNC(B.ADDED_Z)
FROM KBS.TISSUE_REF A, KBS.TCUSIP_ISSUE B, KBS.TINST_REF C
WHERE A.ISSUER_ID_C=B.ISSUER_NUM
AND A.ISSUE_ALPHA_C=B.ISSUE_NUM
AND A.INST_ID_C=C.INST_ID_C
AND C.INST_TYPE_C = 'MUNI'
AND TRUNC(B.ADDED_Z)=TO_DATE('10/10/2017','MM/DD/YYYY')
AND B.ADDED_BY_C='CUSIPNOW'


CUSIPDB FEED COUNT
SELECT DISTINCT B.ISSUER_NUM||B.ISSUE_NUM AS CUSIP, TRUNC(B.ADDED_Z)
FROM KBS.TISSUE_REF A, KBS.TCUSIP_ISSUE B, KBS.TINST_REF C
WHERE A.ISSUER_ID_C=B.ISSUER_NUM
AND A.ISSUE_ALPHA_C=B.ISSUE_NUM
AND A.INST_ID_C=C.INST_ID_C
AND C.INST_TYPE_C = 'MUNI'
AND TRUNC(B.ADDED_Z)=TO_DATE('10/10/2017','MM/DD/YYYY')
AND B.ADDED_BY_C='CUSIPDB'

SDMQA-ALL ACTIVE MUNI CUSIPS (INT TYPE AND CPN RATE)
SELECT A.ISSUER_ID_C||A.ISSUE_ALPHA_C||A.CHECK_DIGIT_C AS CUSIP, 
FROM KBSPROD.TISSUE_REF A, KBSPROD.TISSUER_REF B, KBSPROD.TISSUING_REF C
Where A.ISSUER_ID_C=B.ISSUER_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C
AND A.MATURITY_D > SYSDATE 
AND A.CUSIP_DERVN_I = 'C'
AND B.INST_N NOT LIKE 'ADAMSVILLE%TEST%'
AND B.INST_TYPE_C = 'MUNI'
AND NOT EXISTS (SELECT DISTINCT X.ISSUING_ID_C
FROM KBSPROD.TPREREFUNDED X
WHERE X.ISSUING_ID_C=A.ISSUING_ID_C 
AND X.PREREF_D < (SYSDATE))



SELECT DISTINCT A.ISSUER_ID_C||A.ISSUE_ALPHA_C AS CUSIP, C.SALE_NOTICE_Z, C.SALE_TIME_C
FROM KBS.TISSUE_REF A, KBS.TINST_REF B, KBS.TOFFERING_REF C
WHERE A.INST_ID_C=B.INST_ID_C
AND A.OFFERING_ID_C=C.OFFERING_ID_C
AND B.INST_TYPE_C = 'MUNI'
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND NOT EXISTS (SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X, KBS.TCALLED_BOND Y 
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND X.ISSUER_ID_C=A.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND Y.CALL_D < (SYSDATE))
AND C.SALE_NOTICE_Z IS NOT NULL

ORDER BY 1 ASC



MB-DOCUMENT REF (EVENT TYPE=OFST)
SELECT A.ISSUER_ID_C||A.ISSUE_ALPHA_C AS CUSIP
FROM KBS.TISSUE_REF A, KBS.TDOCUMENT_REF B, KBS.TDOC_OFRNG_XREF C, KBS.TINST_REF D
Where A.INST_ID_C=D.INST_ID_C
AND A.OFFERING_ID_C=C.OFFERING_ID_C
AND B.DOCUMENT_ID_C=C.DOCUMENT_ID_C
AND D.INST_TYPE_C= 'MUNI'
AND B.EVENT_TYPE_C = 'OFST'
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND NOT EXISTS (SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X, KBS.TCALLED_BOND Y 
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND X.ISSUER_ID_C=A.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND Y.CALL_D < (SYSDATE))
ORDER BY 1 ASC NULLS LAST


SDMQA-SINKING FUND QUERY
select distinct  ISS.ISSUER_ID_C || ISS.ISSUE_ALPHA_C || ISS.CHECK_DIGIT_C "CUSIP9",
SINK1.SINK_TYPE_C "SINK_FUND_TYPE",
SINK1.SINK_D "SINK_BEGIN",
SINK2.SINK_D "SINK_END",
SINK1.FREQ_PERIOD_C "SINK_FREQ",
SINK1.NOTFN_MIN_DAYS_Q "SINK_MIN",
SINK1.NOTFN_MAX_DAYS_Q "SINK_MAX"
from KBSPROD.TISSUER_REF ISR, KBSPROD.TISSUE_REF ISS, KBSPROD.TISSUING_REF ISG, KBS.TSINKING_FUND SINK1, KBS.TSINKING_FUND SINK2
where ISS.ISSUER_ID_C = ISR.ISSUER_ID_C
and ISR.INST_TYPE_C in ('MUNI')
and ISS.MATURITY_TYPE_C <> '*'
and (trim(ISS.MATURITY_D) is not null) and (trunc(ISS.MATURITY_D) >= trunc(SYSDATE))
and ISG.ISSUING_ID_C = ISS.ISSUING_ID_C
and SINK1.ISSUING_ID_C = ISS.ISSUING_ID_C
and SINK2.ISSUING_ID_C = SINK1.ISSUING_ID_C
--and not EXISTS
--(SELECT distinct ISSUING_ID_C from KBSPROD.TSINKING_FUND
--where ISSUING_ID_C = ISS.ISSUING_ID_C
--and SINK1_EXP_D is NULL 
--group by ISSUING_ID_C having count(distinct SINK_EXT_ID_C) > 1)
and SINK1.SINK_EXP_D is NULL
and SINK2.SINK_EXP_D is NULL
AND ISS.CUSIP_DERVN_I = 'C'
AND NOT EXISTS (SELECT DISTINCT X.ISSUING_ID_C
FROM KBSPROD.TPREREFUNDED X
WHERE X.ISSUING_ID_C=ISS.ISSUING_ID_C 
AND X.PREREF_D < (SYSDATE))
--AND SINK.SINK_TYPE_C IN ('AR','ER', 'IP','IS')
AND SINK1.SINK_D IN (SELECT DISTINCT MIN(SINK_D) FROM KBS.TSINKING_FUND SFMIN WHERE SFMIN.ISSUING_ID_C=SINK1.ISSUING_ID_C)
AND SINK2.SINK_D IN (SELECT DISTINCT MAX(SINK_D) FROM KBS.TSINKING_FUND SFMAX WHERE SFMAX.ISSUING_ID_C=SINK1.ISSUING_ID_C)
order by CUSIP9




SDMQA-PUT QUERY
SELECT A.ISSUER_ID_C||A.ISSUE_ALPHA_C||A.CHECK_DIGIT_C AS CUSIP, D.PUT_D AS PUT_DATE, D.FREQ_PERIOD_C AS PUT_FREQ, D.PUT_TYPE_C AS PUT_TYPE, D.PUT_PRICE_P AS PUT_PRICE, D.NOTFN_MIN_DAYS_Q AS PUT_MIN_DAYS, D.NOTFN_MAX_DAYS_Q AS PUT_MAX_DAYS, D.PUT_EXP_D AS PUT_EXPIRATION, D.PUT_COND_RESN_1_C, D.PUT_COND_RESN_2_C, D.PUT_COND_RESN_3_C, D.PUT_COND_RESN_4_C, D.PUT_COND_RESN_5_C, D.PUT_COND_RESN_6_C
FROM KBSPROD.TISSUE_REF A, KBSPROD.TISSUER_REF B, KBSPROD.TPUT_SCHEDULE D
Where A.ISSUER_ID_C=B.ISSUER_ID_C
AND A.ISSUING_ID_C=D.ISSUING_ID_C
AND A.MATURITY_D > SYSDATE 
AND A.CUSIP_DERVN_I = 'C'
AND B.INST_N NOT LIKE 'ADAMSVILLE%TEST%'
AND B.INST_TYPE_C = 'MUNI'
AND NOT EXISTS (SELECT DISTINCT X.ISSUING_ID_C
FROM KBSPROD.TPREREFUNDED X
WHERE X.ISSUING_ID_C=A.ISSUING_ID_C 
AND X.PREREF_D < (SYSDATE))
AND D.PUT_TYPE_C = 'PUTO'
AND (D.PUT_EXP_D IS NULL
OR D.PUT_EXP_D > (SYSDATE))
AND D.PUT_D IN (SELECT MIN(PUT_D) FROM KBS.TPUT_SCHEDULE PUT WHERE PUT.ISSUING_ID_C=D.ISSUING_ID_C)
ORDER BY 1,2,3 ASC

PUTO
PUTM
PUTR
PUTC
PUTL


SDMQA-UW=MERRILL
SELECT A.ISSUER_ID_C||A.ISSUE_ALPHA_C||A.CHECK_DIGIT_C AS CUSIP, 
FROM KBSPROD.TISSUE_REF A, KBSPROD.TISSUER_REF B, KBSPROD.TISSUING_REF C
Where A.ISSUER_ID_C=B.ISSUER_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C
AND A.MATURITY_D > SYSDATE 
AND A.CUSIP_DERVN_I = 'C'
AND B.INST_N NOT LIKE 'ADAMSVILLE%TEST%'
AND B.INST_TYPE_C = 'MUNI'
AND NOT EXISTS (SELECT DISTINCT X.ISSUING_ID_C
FROM KBSPROD.TPREREFUNDED X
WHERE X.ISSUING_ID_C=A.ISSUING_ID_C 
AND X.PREREF_D < (SYSDATE))
AND C.UNDWRTR_SUB_ID_C IN ('0000000000006975', '0000000000006685', '0000000000014349', '0000000000014350', '0000000000008804', '0000000000010005', '0000000000009696', '0000000000014823', '0000000000015730', '0000000000018435', '0000000000019137', '0000000000073994', '0000000000074010', '0000000000074708', '0000000000075146', '0000000000075131', '0000000000074255', '0000000000074337', '0000000000074318', '0000000000075654', '0000000000072779', '0000000000072716', '0000000000073275', '0000000000073338', '0000000000073524', '0000000000073576', '0000000000073461', '0000000000073632', '0000000000073636', '0000000000075150', '0000000000075213', '0000000000074776', '0000000000074477', '0000000000074445', '0000000000073884', '0000000000073767', '0000000000073874', '0000000000075125', '0000000000075570', '0000000000075677', '0000000000075689', 'MERRILL000000000', 'RICHARDS-MERRILL', 'MERRILNY00000000', 'MERRILPF00000000', 'MERRILCO00000000', 'MERRILCS00000000', 'BOFAMERR00000000', 'MERRILWW00000000'
)
AND C.UNDWRTR_INST_CAT_C = 'UNDW'

MB-UW=MERRILL
SELECT A.ISSUER_ID_C||A.ISSUE_ALPHA_C AS CUSIP, A.OFFERING_ID_C, B.DATED_D, A.MATURITY_D, C.OFFERING_TYPE_C, C.SETTLMNT_D, C.SETTLMNT_STATUS_C, E.UNDWRTR_N
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, KBS.TOFFERING_REF C, KBS.TINST_REF D, KBS.TUNDERWRITER_REF E 
Where A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.INST_ID_C=D.INST_ID_C
AND A.OFFERING_ID_C=C.OFFERING_ID_C
AND C.UNDWRTR_ID_C=E.UNDWRTR_ID_C
AND D.INST_TYPE_C= 'MUNI'
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND C.UNDWRTR_ID_C IN (10005, 9696, 14349, 14350, 14823, 6975, 8804, 15730, 18435, 19137, 6685, 73275, 73994, 75570, 74318, 74010, 73338, 73524, 74477, 75677, 74337, 72716, 72779, 73874, 73767, 74255, 74776, 73576, 73632, 74708, 74445, 73884, 73636, 73461, 75213, 75654, 75689, 75125, 75131, 75146, 75150
)
AND C.OFFERING_TYPE_C = 'PD'
AND NOT EXISTS (SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X, KBS.TCALLED_BOND Y 
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND X.ISSUER_ID_C=A.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND Y.CALL_D < (SYSDATE))
ORDER BY 1 ASC NULLS LAST


SDMQA-KBSPROD-ISSUE TAB
SELECT A.ISSUER_ID_C||A.ISSUE_ALPHA_C||A.CHECK_DIGIT_C AS CUSIP, C.OFFERING_TYPE_C, C.SALE_NOTICE_D AS SALE_DATE, C.SUBMISSION_D AS FIRST_EXECUTION_DATE, C.SALE_NOTICE_D AS FORMAL_AWARD_DATE, C.SALE_STATUS_C AS FORMAL_AWARD_TYPE, C.ISSUING_CUSIP_T AS ISSUE_NAME, C.SERIES_GROUP_C AS SERIES_NAME, C.OFFERING_ORGL_L AS ISSUE_AMT, C.PRIN_INIT_I AS OFFER_ORIG_AMOUNT_TYPE_IND   
FROM KBSPROD.TISSUE_REF A, KBSPROD.TISSUER_REF B, KBSPROD.TISSUING_REF C
Where A.ISSUER_ID_C=B.ISSUER_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C


--SDMQA-KBSPROD-MATURITY TAB
SELECT DISTINCT C.BANK_QUALIFIED_I AS BANK_QUALIFIED, C.REGISTRTION_TYPE_C AS BOND_FORM, H.INST_N AS BOND_INSR, E.CALL_TYPE_C AS CALL_ALLOW_OPT, F.SPEC_TYPE_C AS CALL_ALLOW_SPEC, A.COMPOUND_YIELD_P AS COMPOUND_YIELD, A.COUPON_RATE_P AS COUPON_RATE, A.ISSUER_ID_C||A.ISSUE_ALPHA_C||A.CHECK_DIGIT_C AS CUSIP9, A.DATED_D AS DATED_DATE, A.ISSUE_DENOM_2_L AS DENOMINATION, A.DTC_ELGBY_I AS DTC_DEPOSITORY, C.INCOME_TAX_I AS FED_TAX, C.PAYMENT_FIRST_D AS FIRST_COUP_DATE, C.ACCRUAL_COUNT_C AS INT_CALC_METH, C.FREQ_PERIOD_1_C AS INT_FREQ, A.ACCRUAL_FIRST_D AS INT_START_DATE, A.MATURITY_D AS MATURITY_DATE, A.PRIN_INIT_I AS MAT_ORIG_AMT_TYPE_IND, A.ISSUE_DENOM_3_L AS MIN_INCREMENT, A.ISSUE_DENOM_4_L AS ODD_DENOM_PIECE, A.OFFERING_PRICE_P AS ORIG_PRICE, A.OFFERING_YIELD_P AS ORIG_YIELD, A.ISSUE_ORGL_L AS PRIN_AMT, A.PURP_TYPE_C AS PURP_TYPE, C.MUNI_TAX_I AS LT_ULT, A.PURP_CLASS_C AS PURP_CLASS, A.PURP_SUB_CLASS_C AS PURP_SUB_CLASS, C.A144C AS A144, C.REG_D_C AS REG_D, C.SECURITY_CLASS_C AS SECURED, A.SECURITY_TYPE_C AS SECURITY_TYPE, C.ASSET_CLAIM_C AS SENIORITY, C.SERIES_GROUP_C, C.SETTLMNT_D AS SETTLEMENT_DATE, C.SETTLMNT_STATUS_C AS SETTLEMENT_TYPE, C.STATE_TAX_I, A.MATURITY_TYPE_C AS TERM_SERIAL_IND             
FROM KBSPROD.TISSUE_REF A, KBSPROD.TISSUER_REF B, KBSPROD.TISSUING_REF C, KBSPROD.TCRDT_ENHMT_REF D, KBSPROD.TCALL_SCHEDULE E, KBSPROD.TSPECIAL_SCHEDULE F, KBSPROD.TISSUE_SPECIAL_REF G, KBSPROD.TINST_REF H
Where A.ISSUER_ID_C=B.ISSUER_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C
AND (A.ISSUER_ID_C=D.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=D.ISSUE_ALPHA_C (+))
AND A.ISSUING_ID_C=E.ISSUING_ID_C (+)
AND (A.ISSUER_ID_C=G.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=G.ISSUE_ALPHA_C (+))
AND G.SPEC_FEATURE_ID_C=F.FEATURE_ID_C (+)
AND 'INSN' = D.CRDT_ENHMT_TYPE_C (+)
AND 'FULL' = D.COVERAGE_TYPE_C (+)
AND 'P'= PRIMARY_ENHMT_I (+)
AND D.INST_SUB_ID_1_C= H.INST_SUB_ID_C (+)
ORDER BY 1 ASC


--SDMQA-KBSPROD-PUT/VAR TAB
Put data
SELECT A.ISSUER_ID_C||A.ISSUE_ALPHA_C||A.CHECK_DIGIT_C AS CUSIP, D.PUT_D AS PUT_DATE, E.PUT_NEXT_D AS NEXT_PUT_DATE, D.FREQ_PERIOD_C AS PUT_FREQ, D.PUT_TYPE_C AS PUT_TYPE, D.PUT_PRICE_P AS PUT_PRICE, D.NOTFN_MIN_DAYS_Q AS PUT_MIN_DAYS, D.NOTFN_MAX_DAYS_Q AS PUT_MAX_DAYS, D.PUT_EXP_D AS PUT_EXPIRATION, D.PUT_COND_RESN_1_C, D.PUT_COND_RESN_2_C, D.PUT_COND_RESN_3_C, D.PUT_COND_RESN_4_C, D.PUT_COND_RESN_5_C, D.PUT_COND_RESN_6_C
FROM KBSPROD.TISSUE_REF A, KBSPROD.TISSUER_REF B, KBSPROD.TPUT_SCHEDULE D, KBSPROD.TISSUE_PUT_REF E
Where A.ISSUER_ID_C=B.ISSUER_ID_C
AND A.ISSUING_ID_C=D.ISSUING_ID_C
AND (A.ISSUER_ID_C=E.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=E.ISSUE_ALPHA_C (+))
AND D.PUT_D IN (SELECT MIN(PUT_D) FROM KBS.TPUT_SCHEDULE PUT WHERE PUT.ISSUING_ID_C=D.ISSUING_ID_C)
ORDER BY 1,2,3 ASC


--Var data (USING MB DATA)
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.MATURITY_D, SUBSTR(C.OTL_TEXT_T,1,3) AS VAR_TYPE, SUBSTR(C.OTL_TEXT_T,5,6) AS VAR_RATE_DATE, SUBSTR(C.OTL_TEXT_T,12,2) AS RESET_FREQ, SUBSTR(C.OTL_TEXT_T,15,2) AS RESET_DAY, D.INT_RATE_CAP AS RATE_CEILING, D.INT_RATE_FLOOR AS AS RATE_FLOOR,  
FROM KBS.TINST_REF B, KBS.TISSUE_REF A, KBS.TISSUING_OTL C, KBS.TINDEX_GROUPING D
WHERE A.INST_ID_C=B.INST_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C
AND (A.ISSUER_ID_C=D.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=D.ISSUE_ALPHA_C (+)) 
AND B.INST_TYPE_C = 'MUNI'
AND C.OTL_ID_C ='44'
AND SUBSTR(C.OTL_TEXT_T,4,1) = '-' 
ORDER BY 1,2,3 ASC


--SDMQA-KBSPROD-SINK TAB
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.SINK_D AS SINK_DATE, B.SINK_AMT_1_L AS SINK_AMT, B.SINK_PRICE_P AS SINK_PRICE, B.PRICE_TYPE_C AS ACC_VALUE_FLAG, B.SINK_AMT_2_L AS SINK_AMT_2, B.SINK_TYPE_C AS SINK_FUND_TYPE 
FROM KBSPROD.TISSUE_REF A, KBSPROD.TSINKING_FUND B
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
ORDER BY 1,2 ASC

--SDMQA-KBSPROD-SPECIALS TAB
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, B.SPEC_TYPE_C AS SPL_TYPE, C.SOURCE_REASON_1_C AS SPL_CODE1, C.SOURCE_REASON_2_C AS SPL_CODE2, C.SOURCE_REASON_3_C AS SPL_CODE3, C.SOURCE_REASON_4_C AS SPL_CODE4, C.BEGIN_D AS SPEC_DATE, C.PRICE_P AS SPL_PRICE, C.NOTFN_MIN_DAYS_Q AS SPL_MIN_DAYS, C.NOTFN_MAX_DAYS_Q AS SPL_MAX_DAYS  
FROM KBSPROD.TISSUE_REF A, KBSPROD.TISSUE_SPECIAL_REF B, KBSPROD.TSPECIAL_SCHEDULE C
WHERE (A.ISSUER_ID_C=B.ISSUER_ID_C AND A.ISSUE_ALPHA_C=B.ISSUE_ALPHA_C)
AND B.SPEC_FEATURE_ID_C=C.FEATURE_ID_C
ORDER BY 1,2,7 ASC

--SDMQA-KBSPROD-FRN TAB (USING MB DATA)
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, E.FORMULA_TEXT AS FRN_FORMULA, F.VARIABLE_TYPE_C AS FRN_TYPE, F.STEP_UP_DOWN_I AS STEP_UP_DOWN, F.HIGH_LOW_I AS HIGH_LOW_IND, F.MULT_INDEX_I AS MULT_INDEX_IND, F.FIRST_ADJ_DT, F.LAST_ADJ_DT, F.FREQ_PER_OCC_Q AS ADJ_FREQ_1, F.FREQ_PERIOD_C AS ADJ_FREQ_2, F.FREQ_Q AS ADJ_FREQ_3, 
F.FREQ_DAY_C AS ADJ_FREQ_4, F.FIXED_TO_FLOAT_CD, D.INDEX_TYPE AS INDX, D.INDEX_SUB_TYPE AS INDX_SUB_TYPE, D.AVG_INDX_I AS AVG_INDX, D.SPREAD_PLUSMINUS_I AS SPREAD_PLUS_MINUS, D.SPREAD_INT_RATE AS SPREAD_PCT, D.SPREAD_BASIS_PTS AS SPREAD_BASIS_PTS, D.MULT_LEVRG_FACTOR AS INDX_MULTIPLIER, D.PERCENT_OF_INDEX AS PCT_OF_INDEX, 
D.INT_RATE_FLOOR AS INT_RATE_FLOOR, D.INT_RATE_CAP AS INT_RATE_CAP, INT_RATE_CAP_I AS INT_RATE_CAP_IND, D.CUTOFF_DAY_CD AS INDX_RATE_CUT_OFF, D.CUTOFF_TIMEZONE_CD, D.CUTOFF_FREQ_CD, D.EFF_BEGIN_DT AS EFF_BEGIN_DATE, D.EFF_END_DT AS EFF_END_DATE, G.ADJ_DT AS ADJUST_DATE, G.ADJ_RATE AS ADJUST_RATE, G.CALC_COUPON_I AS CALC_IND, G.BEGIN_DT AS BEGIN_DATE, G.END_DT AS END_DATE

FROM KBS.TINST_REF B, KBS.TISSUE_REF A, KBS.TINDEX_GROUPING D, KBS.TINDEX_FORMULA E, KBS.TVARIABLE_FEATURE F, KBS.TVARIABLE_SCHEDULE G
WHERE A.INST_ID_C=B.INST_ID_C
AND (A.ISSUER_ID_C=D.ISSUER_ID_C AND A.ISSUE_ALPHA_C=D.ISSUE_ALPHA_C) 
AND F.FORMULA_ID_C=E.FORMULA_ID_C (+)
AND (A.ISSUER_ID_C=F.ISSUER_ID_C AND A.ISSUE_ALPHA_C=F.ISSUE_ALPHA_C)
AND (A.ISSUER_ID_C=G.ISSUER_ID_C AND A.ISSUE_ALPHA_C=G.ISSUE_ALPHA_C)
AND B.INST_TYPE_C = 'MUNI'
ORDER BY 1,33 ASC




--MB-BHAVESH-PREV/NEXT INT PAY INDICATOR
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, C.BUS_DAY_ADJUST_C
FROM KBS.TISSUE_REF A, KBS.TINST_REF B, KBS.TINT_PAY_CYCLE C
WHERE A.INST_ID_C=B.INST_ID_C 
AND A.ISSUING_ID_C=C.ISSUING_ID_C
AND B.INST_TYPE_C = 'MUNI'
AND C.BUS_DAY_ADJUST_C IS NOT NULL
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'
AND NOT EXISTS (SELECT DISTINCT X.ISSUER_ID_C, X.ISSUE_ALPHA_C 
FROM KBS.TCALLED_ISSUE X, KBS.TCALLED_BOND Y 
WHERE X.FEATURE_ID_C=Y.FEATURE_ID_C
AND X.ISSUER_ID_C=A.ISSUER_ID_C
AND X.ISSUE_ALPHA_C=A.ISSUE_ALPHA_C 
AND X.FULL_PART_CALL_C = 'FULL'
AND Y.CALL_D < (SYSDATE))


--SDMQA-ALINA-PREV/NEXT INT PAY INDICATOR
SELECT A.ISSUER_ID_C||A.ISSUE_ALPHA_C||A.CHECK_DIGIT_C AS CUSIP, C.BUS_DAY_ADJUST_1_C 
FROM KBSPROD.TISSUE_REF A, KBSPROD.TISSUER_REF B, KBSPROD.TISSUING_REF C
Where A.ISSUER_ID_C=B.ISSUER_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C
AND A.MATURITY_D > SYSDATE 
AND A.CUSIP_DERVN_I = 'C'
AND B.INST_N NOT LIKE 'ADAMSVILLE%TEST%'
AND B.INST_TYPE_C = 'MUNI'
AND C.BUS_DAY_ADJUST_1_C <> ' ' 
AND NOT EXISTS (SELECT DISTINCT X.ISSUING_ID_C
FROM KBSPROD.TPREREFUNDED X
WHERE X.ISSUING_ID_C=A.ISSUING_ID_C 
AND X.PREREF_D < (SYSDATE))



--SDMPROD-COUPON, INT TYPE, ADJ DATE/FREQ, PREF DATE
SELECT A.ISSUER_ID_C||A.ISSUE_ALPHA_C||A.CHECK_DIGIT_C AS CUSIP, A.COUPON_RATE_P, A.INTEREST_TYPE_C, D.INTEREST_BEGIN_D AS FIRST_ADJ_DATE, D.FREQ_PERIOD_C AS ADJ_FREQ, C.PREREF_TYPE_C, C.PREREF_D AS PREF_DATE
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B, KBS.TPREREFUNDED C, KBS.TVARIABLE_RATE D
Where A.ISSUING_ID_C=B.ISSUING_ID_C (+)
AND A.ISSUING_ID_C=C.ISSUING_ID_C (+)
AND A.ISSUING_ID_C=D.ISSUING_ID_C (+)



--MB-ALINA-SF QUERY
SELECT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, D.SF_TYPE_C, SF_BEGIN_D, SF_NOTICE_1_C AS MIN_NOTICE, SF_NOTICE_2_C AS MAX_NOTICE
FROM KBS.TFEATURE_XREF A, KBS.TSINKING_FUND_REF D
WHERE A.FEATURE_ID_C=D.FEATURE_ID_C
AND D.SF_EXPIRATION_D IS NULL


ORDER BY 1 ASC


SDMPROD (OLD)-ALINA-SF QUERY


MB-CLASS/SUBCLASS
SELECT A.ISSUER_ID_C||A.ISSUE_ALPHA_C AS CUSIP, B.PURP_CLASS_C, B.PURP_SUB_CLASS_C
FROM KBS.TISSUE_REF A, KBS.TISSUING_REF B
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C


MB-PRE-REFUNDED BONDS
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP8, B.PREF_TYPE_C, B.PREF_D, B.PRICE_PCT_P, B.RFDG_ISSUER_ID_C, E.OTL_TEXT_T AS OTL 
FROM KBS.TISSUE_REF A, KBS.TPREREFUNDED_REF B, KBS.TISSUING_REF C, KBS.TINST_REF D, KBS.TISSUING_OTL E
WHERE A.ISSUING_ID_C=B.ISSUING_ID_C
AND A.ISSUING_ID_C= C.ISSUING_ID_C
AND A.INST_ID_C=D.INST_ID_C
AND A.ISSUING_ID_C=E.ISSUING_ID_C
AND D.INST_TYPE_C = 'MUNI'
AND E.OTL_ID_C = '93'
AND A.MATURITY_D > (SYSDATE)
AND A.MATURITY_TYPE_C <> '*'

--VAR DATA (USING MB DATA)
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.MATURITY_D, SUBSTR(C.OTL_TEXT_T,1,3) AS VAR_TYPE, SUBSTR(C.OTL_TEXT_T,5,6) AS VAR_RATE_DATE, SUBSTR(C.OTL_TEXT_T,12,2) AS RESET_FREQ, SUBSTR(C.OTL_TEXT_T,15,2) AS RESET_DAY, D.INT_RATE_CAP AS RATE_CEILING, D.INT_RATE_FLOOR AS RATE_FLOOR  
FROM KBS.TINST_REF B, KBS.TISSUE_REF A, KBS.TISSUING_OTL C, KBS.TINDEX_GROUPING D
WHERE A.INST_ID_C=B.INST_ID_C
AND A.ISSUING_ID_C=C.ISSUING_ID_C
AND (A.ISSUER_ID_C=D.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=D.ISSUE_ALPHA_C (+)) 
AND B.INST_TYPE_C = 'MUNI'
AND C.OTL_ID_C ='44'
AND SUBSTR(C.OTL_TEXT_T,4,1) = '-' 
ORDER BY 1,2,3 ASC

--WITH MSRB
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, A.COUPON_ORGL_P, A.MODIFIED_Z, A.MATURITY_D, SUBSTR(C.OTL_TEXT_T,1,3) AS VAR_TYPE, SUBSTR(C.OTL_TEXT_T,5,6) AS VAR_RATE_DATE, SUBSTR(C.OTL_TEXT_T,12,2) AS RESET_FREQ, SUBSTR(C.OTL_TEXT_T,15,2) AS RESET_DAY, E.INTEREST_RATE AS MSRB_RATE, E.RATE_EFFECTIVE_DATE AS RATE_DATE  
FROM KBS.TISSUE_REF A, KBS.TISSUING_OTL C, KBS.TINDEX_GROUPING D, KBS.MSRBSH_TRANSACTION_DATA E
WHERE A.ISSUING_ID_C=C.ISSUING_ID_C
AND E.RATE_EFFECTIVE_DATE IN (SELECT MAX(RATE_EFFECTIVE_DATE) FROM KBS.MSRBSH_TRANSACTION_DATA X WHERE A.ISSUER_ID_C=X.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=X.ISSUE_ALPHA_C (+))
AND (A.ISSUER_ID_C=D.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=D.ISSUE_ALPHA_C (+)) 
AND (A.ISSUER_ID_C=E.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=E.ISSUE_ALPHA_C (+)) 
AND '44'=C.OTL_ID_C (+)
AND '-' = SUBSTR(C.OTL_TEXT_T,4,1)


--MB-PUTS- MIN/MAX
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, SUBSTR(C.OTL_TEXT_T,25,3) AS MIN_NOTIF, SUBSTR(C.OTL_TEXT_T,29,3) AS MAX_NOTIF
FROM KBS.TISSUE_REF A, KBS.TISSUING_OTL C
WHERE A.ISSUING_ID_C=C.ISSUING_ID_C
AND C.OTL_ID_C ='43'
AND SUBSTR(C.OTL_TEXT_T,5,1) = '-' 
ORDER BY 1,2,3 ASC


--MSRB LAST COUPON DATA
SELECT DISTINCT CONCAT(A.ISSUER_ID_C, A.ISSUE_ALPHA_C) AS CUSIP, E.INTEREST_RATE AS MSRB_RATE, E.RATE_EFFECTIVE_DATE AS RATE_DATE  
FROM KBS.TISSUE_REF A, KBS.MSRBSH_TRANSACTION_DATA E
WHERE (A.ISSUER_ID_C=E.ISSUER_ID_C AND A.ISSUE_ALPHA_C=E.ISSUE_ALPHA_C)
AND E.RATE_EFFECTIVE_DATE IN (SELECT MAX(RATE_EFFECTIVE_DATE) FROM KBS.MSRBSH_TRANSACTION_DATA X WHERE A.ISSUER_ID_C=X.ISSUER_ID_C (+) AND A.ISSUE_ALPHA_C=X.ISSUE_ALPHA_C (+))

